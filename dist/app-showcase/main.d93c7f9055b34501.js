"use strict";(self.webpackChunkapp_showcase=self.webpackChunkapp_showcase||[]).push([[179],{562:(fi,yn,Se)=>{Se.d(yn,{$:()=>Yf,A:()=>re,G:()=>ut,K:()=>W_,L:()=>vo,N:()=>br,P:()=>qu,R:()=>Ep,U:()=>Ae,V:()=>Kl,W:()=>Cu,X:()=>ii,Y:()=>wi,Z:()=>Rr,_:()=>To,a:()=>Ci,a0:()=>Jl,a1:()=>Nu,a2:()=>id,a3:()=>tp,a4:()=>J_,a5:()=>Mn,a6:()=>ya,a7:()=>np,a8:()=>va,a9:()=>X_,aA:()=>$e,aB:()=>yt,aC:()=>te,aD:()=>bi,aE:()=>H,aF:()=>Pe,aG:()=>Pa,aH:()=>Cp,aI:()=>Mo,aJ:()=>zt,aN:()=>on,aQ:()=>Vi,aa:()=>ce,ab:()=>kt,ac:()=>si,ad:()=>Wn,ae:()=>Ao,af:()=>ke,ag:()=>rp,ah:()=>sn,ak:()=>Ia,al:()=>as,am:()=>Bi,ap:()=>Jf,aq:()=>wa,as:()=>n0,at:()=>u0,au:()=>Nt,av:()=>_e,aw:()=>$,ax:()=>Ge,ay:()=>ko,az:()=>Pp,b:()=>ty,c:()=>cs,d:()=>Ap,e:()=>py,f:()=>my,g:()=>Fn,h:()=>ot,i:()=>ju,j:()=>Si,k:()=>Bp,l:()=>dy,m:()=>Ry,p:()=>St,r:()=>hy,s:()=>wp,u:()=>bt});var T=Se(861),z=Se(58),x=Se(534),ve=Se(879),gt=Se(582),Bt=Se(537);const St={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},re={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const ut=function Ie(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},vn=function Le(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ye=new z.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Me=new ve.Yd("@firebase/auth");function jt(f,...c){Me.logLevel<=ve.in.ERROR&&Me.error(`Auth (${x.SDK_VERSION}): ${f}`,...c)}function Ge(f,...c){throw je(f,...c)}function yt(f,...c){return je(f,...c)}function wr(f,c,d){const p=Object.assign(Object.assign({},vn()),{[c]:d});return new z.LL("auth","Firebase",p).create(c,{appName:f.name})}function dn(f,c,d){if(!(c instanceof d))throw d.name!==c.constructor.name&&Ge(f,"argument-error"),wr(f,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function je(f,...c){if("string"!=typeof f){const d=c[0],p=[...c.slice(1)];return p[0]&&(p[0].appName=f.name),f._errorFactory.create(d,...p)}return Ye.create(f,...c)}function te(f,c,...d){if(!f)throw je(c,...d)}function et(f){const c="INTERNAL ASSERTION FAILED: "+f;throw jt(c),new Error(c)}function Nt(f,c){f||et(c)}function Yt(){var f;return typeof self<"u"&&(null===(f=self.location)||void 0===f?void 0:f.href)||""}function Sn(){return"http:"===pi()||"https:"===pi()}function pi(){var f;return typeof self<"u"&&(null===(f=self.location)||void 0===f?void 0:f.protocol)||null}class Tr{constructor(c,d){this.shortDelay=c,this.longDelay=d,Nt(d>c,"Short delay should be less than long delay!"),this.isMobile=(0,z.uI)()||(0,z.b$)()}get(){return function ei(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Sn()||(0,z.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function gi(f,c){Nt(f.emulator,"Emulator should always be set here");const{url:d}=f.emulator;return c?`${d}${c.startsWith("/")?c.slice(1):c}`:d}class U{static initialize(c,d,p){this.fetchImpl=c,d&&(this.headersImpl=d),p&&(this.responseImpl=p)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const j={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},q=new Tr(3e4,6e4);function k(f,c){return f.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:f.tenantId}):c}function K(f,c,d,p){return Y.apply(this,arguments)}function Y(){return(Y=(0,T.Z)(function*(f,c,d,p,_={}){return de(f,_,(0,T.Z)(function*(){let I={},R={};p&&("GET"===c?R=p:I={body:JSON.stringify(p)});const L=(0,z.xO)(Object.assign({key:f.config.apiKey},R)).slice(1),X=yield f._getAdditionalHeaders();return X["Content-Type"]="application/json",f.languageCode&&(X["X-Firebase-Locale"]=f.languageCode),U.fetch()(it(f,f.config.apiHost,d,L),Object.assign({method:c,headers:X,referrerPolicy:"no-referrer"},I))}))})).apply(this,arguments)}function de(f,c,d){return qe.apply(this,arguments)}function qe(){return(qe=(0,T.Z)(function*(f,c,d){f._canInitEmulator=!1;const p=Object.assign(Object.assign({},j),c);try{const _=new Tt(f),I=yield Promise.race([d(),_.promise]);_.clearNetworkTimeout();const R=yield I.json();if("needConfirmation"in R)throw $t(f,"account-exists-with-different-credential",R);if(I.ok&&!("errorMessage"in R))return R;{const L=I.ok?R.errorMessage:R.error.message,[X,he]=L.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===X)throw $t(f,"credential-already-in-use",R);if("EMAIL_EXISTS"===X)throw $t(f,"email-already-in-use",R);if("USER_DISABLED"===X)throw $t(f,"user-disabled",R);const Ce=p[X]||X.toLowerCase().replace(/[_\s]+/g,"-");if(he)throw wr(f,Ce,he);Ge(f,Ce)}}catch(_){if(_ instanceof z.ZR)throw _;Ge(f,"network-request-failed",{message:String(_)})}})).apply(this,arguments)}function Ve(f,c,d,p){return De.apply(this,arguments)}function De(){return(De=(0,T.Z)(function*(f,c,d,p,_={}){const I=yield K(f,c,d,p,_);return"mfaPendingCredential"in I&&Ge(f,"multi-factor-auth-required",{_serverResponse:I}),I})).apply(this,arguments)}function it(f,c,d,p){const _=`${c}${d}?${p}`;return f.config.emulator?gi(f.config,_):`${f.config.apiScheme}://${_}`}function Mt(f){switch(f){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Tt{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((d,p)=>{this.timer=setTimeout(()=>p(yt(this.auth,"network-request-failed")),q.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $t(f,c,d){const p={appName:f.name};d.email&&(p.email=d.email),d.phoneNumber&&(p.phoneNumber=d.phoneNumber);const _=yt(f,c,p);return _.customData._tokenResponse=d,_}function In(f){return void 0!==f&&void 0!==f.getResponse}function En(f){return void 0!==f&&void 0!==f.enterprise}class Nn{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const d of this.recaptchaEnforcementState)if(d.provider&&d.provider===c)return Mt(d.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function ti(){return(ti=(0,T.Z)(function*(f){return(yield K(f,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function mi(f,c){return mt.apply(this,arguments)}function mt(){return(mt=(0,T.Z)(function*(f,c){return K(f,"GET","/v2/recaptchaConfig",k(f,c))})).apply(this,arguments)}function yi(){return(yi=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function ri(){return(ri=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Dr(){return(Dr=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function Ar(f){if(f)try{const c=new Date(Number(f));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function hr(){return(hr=(0,T.Z)(function*(f,c=!1){const d=(0,z.m9)(f),p=yield d.getIdToken(c),_=fr(p);te(_&&_.exp&&_.auth_time&&_.iat,d.auth,"internal-error");const I="object"==typeof _.firebase?_.firebase:void 0,R=I?.sign_in_provider;return{claims:_,token:p,authTime:Ar(Fi(_.auth_time)),issuedAtTime:Ar(Fi(_.iat)),expirationTime:Ar(Fi(_.exp)),signInProvider:R||null,signInSecondFactor:I?.sign_in_second_factor||null}})).apply(this,arguments)}function Fi(f){return 1e3*Number(f)}function fr(f){const[c,d,p]=f.split(".");if(void 0===c||void 0===d||void 0===p)return jt("JWT malformed, contained fewer than 3 sections"),null;try{const _=(0,z.tV)(d);return _?JSON.parse(_):(jt("Failed to decode base64 JWT payload"),null)}catch(_){return jt("Caught error parsing JWT payload as JSON",_?.toString()),null}}function Ht(f,c){return nn.apply(this,arguments)}function nn(){return(nn=(0,T.Z)(function*(f,c,d=!1){if(d)return c;try{return yield c}catch(p){throw p instanceof z.ZR&&function vi({code:f}){return"auth/user-disabled"===f||"auth/user-token-expired"===f}(p)&&f.auth.currentUser===f&&(yield f.auth.signOut()),p}})).apply(this,arguments)}class Xi{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var d;if(c){const p=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),p}{this.errorBackoff=3e4;const _=(null!==(d=this.user.stsTokenManager.expirationTime)&&void 0!==d?d:0)-Date.now()-3e5;return Math.max(0,_)}}schedule(c=!1){var d=this;if(!this.isRunning)return;const p=this.getInterval(c);this.timerId=setTimeout((0,T.Z)(function*(){yield d.iteration()}),p)}iteration(){var c=this;return(0,T.Z)(function*(){try{yield c.user.getIdToken(!0)}catch(d){return void("auth/network-request-failed"===d?.code&&c.schedule(!0))}c.schedule()})()}}class Ii{constructor(c,d){this.createdAt=c,this.lastLoginAt=d,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ar(this.lastLoginAt),this.creationTime=Ar(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function wn(f){return hn.apply(this,arguments)}function hn(){return hn=(0,T.Z)(function*(f){var c;const d=f.auth,p=yield f.getIdToken(),_=yield Ht(f,function $n(f,c){return Dr.apply(this,arguments)}(d,{idToken:p}));te(_?.users.length,d,"internal-error");const I=_.users[0];f._notifyReloadListener(I);const R=null!==(c=I.providerUserInfo)&&void 0!==c&&c.length?function es(f){return f.map(c=>{var{providerId:d}=c,p=(0,gt._T)(c,["providerId"]);return{providerId:d,uid:p.rawId||"",displayName:p.displayName||null,email:p.email||null,phoneNumber:p.phoneNumber||null,photoURL:p.photoUrl||null}})}(I.providerUserInfo):[],L=function yo(f,c){return[...f.filter(p=>!c.some(_=>_.providerId===p.providerId)),...c]}(f.providerData,R),Ce=!!f.isAnonymous&&!(f.email&&I.passwordHash||L?.length),Xe={uid:I.localId,displayName:I.displayName||null,photoURL:I.photoUrl||null,email:I.email||null,emailVerified:I.emailVerified||!1,phoneNumber:I.phoneNumber||null,tenantId:I.tenantId||null,providerData:L,metadata:new Ii(I.createdAt,I.lastLoginAt),isAnonymous:Ce};Object.assign(f,Xe)}),hn.apply(this,arguments)}function Cr(){return(Cr=(0,T.Z)(function*(f){const c=(0,z.m9)(f);yield wn(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function Ei(){return(Ei=(0,T.Z)(function*(f,c){const d=yield de(f,{},(0,T.Z)(function*(){const p=(0,z.xO)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:_,apiKey:I}=f.config,R=it(f,_,"/v1/token",`key=${I}`),L=yield f._getAdditionalHeaders();return L["Content-Type"]="application/x-www-form-urlencoded",U.fetch()(R,{method:"POST",headers:L,body:p})}));return{accessToken:d.access_token,expiresIn:d.expires_in,refreshToken:d.refresh_token}})).apply(this,arguments)}function A(){return(A=(0,T.Z)(function*(f,c){return K(f,"POST","/v2/accounts:revokeToken",k(f,c))})).apply(this,arguments)}class E{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){te(c.idToken,"internal-error"),te(typeof c.idToken<"u","internal-error"),te(typeof c.refreshToken<"u","internal-error");const d="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):function fa(f){const c=fr(f);return te(c,"internal-error"),te(typeof c.exp<"u","internal-error"),te(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,d)}getToken(c,d=!1){var p=this;return(0,T.Z)(function*(){return te(!p.accessToken||p.refreshToken,c,"user-token-expired"),d||!p.accessToken||p.isExpired?p.refreshToken?(yield p.refresh(c,p.refreshToken),p.accessToken):null:p.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,d){var p=this;return(0,T.Z)(function*(){const{accessToken:_,refreshToken:I,expiresIn:R}=yield function Ps(f,c){return Ei.apply(this,arguments)}(c,d);p.updateTokensAndExpiration(_,I,Number(R))})()}updateTokensAndExpiration(c,d,p){this.refreshToken=d||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*p}static fromJSON(c,d){const{refreshToken:p,accessToken:_,expirationTime:I}=d,R=new E;return p&&(te("string"==typeof p,"internal-error",{appName:c}),R.refreshToken=p),_&&(te("string"==typeof _,"internal-error",{appName:c}),R.accessToken=_),I&&(te("number"==typeof I,"internal-error",{appName:c}),R.expirationTime=I),R}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new E,this.toJSON())}_performRefresh(){return et("not implemented")}}function w(f,c){te("string"==typeof f||typeof f>"u","internal-error",{appName:c})}class v{constructor(c){var{uid:d,auth:p,stsTokenManager:_}=c,I=(0,gt._T)(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xi(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=d,this.auth=p,this.stsTokenManager=_,this.accessToken=_.accessToken,this.displayName=I.displayName||null,this.email=I.email||null,this.emailVerified=I.emailVerified||!1,this.phoneNumber=I.phoneNumber||null,this.photoURL=I.photoURL||null,this.isAnonymous=I.isAnonymous||!1,this.tenantId=I.tenantId||null,this.providerData=I.providerData?[...I.providerData]:[],this.metadata=new Ii(I.createdAt||void 0,I.lastLoginAt||void 0)}getIdToken(c){var d=this;return(0,T.Z)(function*(){const p=yield Ht(d,d.stsTokenManager.getToken(d.auth,c));return te(p,d.auth,"internal-error"),d.accessToken!==p&&(d.accessToken=p,yield d.auth._persistUserIfCurrent(d),d.auth._notifyListenersIfCurrent(d)),p})()}getIdTokenResult(c){return function xn(f){return hr.apply(this,arguments)}(this,c)}reload(){return function Hn(f){return Cr.apply(this,arguments)}(this)}_assign(c){this!==c&&(te(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(d=>Object.assign({},d)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const d=new v(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return d.metadata._copy(this.metadata),d}_onReload(c){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,d=!1){var p=this;return(0,T.Z)(function*(){let _=!1;c.idToken&&c.idToken!==p.stsTokenManager.accessToken&&(p.stsTokenManager.updateFromServerResponse(c),_=!0),d&&(yield wn(p)),yield p.auth._persistUserIfCurrent(p),_&&p.auth._notifyListenersIfCurrent(p)})()}delete(){var c=this;return(0,T.Z)(function*(){const d=yield c.getIdToken();return yield Ht(c,function _i(f,c){return yi.apply(this,arguments)}(c.auth,{idToken:d})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,d){var p,_,I,R,L,X,he,Ce;const Xe=null!==(p=d.displayName)&&void 0!==p?p:void 0,ir=null!==(_=d.email)&&void 0!==_?_:void 0,Hi=null!==(I=d.phoneNumber)&&void 0!==I?I:void 0,ka=null!==(R=d.photoURL)&&void 0!==R?R:void 0,$p=null!==(L=d.tenantId)&&void 0!==L?L:void 0,Vo=null!==(X=d._redirectEventId)&&void 0!==X?X:void 0,ds=null!==(he=d.createdAt)&&void 0!==he?he:void 0,Hp=null!==(Ce=d.lastLoginAt)&&void 0!==Ce?Ce:void 0,{uid:ic,emailVerified:Ld,isAnonymous:Uo,providerData:Vd,stsTokenManager:Zn}=d;te(ic&&Zn,c,"internal-error");const My=E.fromJSON(this.name,Zn);te("string"==typeof ic,c,"internal-error"),w(Xe,c.name),w(ir,c.name),te("boolean"==typeof Ld,c,"internal-error"),te("boolean"==typeof Uo,c,"internal-error"),w(Hi,c.name),w(ka,c.name),w($p,c.name),w(Vo,c.name),w(ds,c.name),w(Hp,c.name);const Ud=new v({uid:ic,auth:c,email:ir,emailVerified:Ld,displayName:Xe,isAnonymous:Uo,photoURL:ka,phoneNumber:Hi,tenantId:$p,stsTokenManager:My,createdAt:ds,lastLoginAt:Hp});return Vd&&Array.isArray(Vd)&&(Ud.providerData=Vd.map(Bd=>Object.assign({},Bd))),Vo&&(Ud._redirectEventId=Vo),Ud}static _fromIdTokenResponse(c,d,p=!1){return(0,T.Z)(function*(){const _=new E;_.updateFromServerResponse(d);const I=new v({uid:d.localId,auth:c,stsTokenManager:_,isAnonymous:p});return yield wn(I),I})()}}const M=new Map;function H(f){Nt(f instanceof Function,"Expected a class definition");let c=M.get(f);return c?(Nt(c instanceof f,"Instance stored in cache mismatched with class"),c):(c=new f,M.set(f,c),c)}const Ae=(()=>{class f{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,T.Z)(function*(){return!0})()}_set(d,p){var _=this;return(0,T.Z)(function*(){_.storage[d]=p})()}_get(d){var p=this;return(0,T.Z)(function*(){const _=p.storage[d];return void 0===_?null:_})()}_remove(d){var p=this;return(0,T.Z)(function*(){delete p.storage[d]})()}_addListener(d,p){}_removeListener(d,p){}}return f.type="NONE",f})();function Pe(f,c,d){return`firebase:${f}:${c}:${d}`}class st{constructor(c,d,p){this.persistence=c,this.auth=d,this.userKey=p;const{config:_,name:I}=this.auth;this.fullUserKey=Pe(this.userKey,_.apiKey,I),this.fullPersistenceKey=Pe("persistence",_.apiKey,I),this.boundEventHandler=d._onStorageEvent.bind(d),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,T.Z)(function*(){const d=yield c.persistence._get(c.fullUserKey);return d?v._fromJSON(c.auth,d):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var d=this;return(0,T.Z)(function*(){if(d.persistence===c)return;const p=yield d.getCurrentUser();return yield d.removeCurrentUser(),d.persistence=c,p?d.setCurrentUser(p):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,d,p="authUser"){return(0,T.Z)(function*(){if(!d.length)return new st(H(Ae),c,p);const _=(yield Promise.all(d.map(function(){var he=(0,T.Z)(function*(Ce){if(yield Ce._isAvailable())return Ce});return function(Ce){return he.apply(this,arguments)}}()))).filter(he=>he);let I=_[0]||H(Ae);const R=Pe(p,c.config.apiKey,c.name);let L=null;for(const he of d)try{const Ce=yield he._get(R);if(Ce){const Xe=v._fromJSON(c,Ce);he!==I&&(L=Xe),I=he;break}}catch{}const X=_.filter(he=>he._shouldAllowMigration);return I._shouldAllowMigration&&X.length?(I=X[0],L&&(yield I._set(R,L.toJSON())),yield Promise.all(d.map(function(){var he=(0,T.Z)(function*(Ce){if(Ce!==I)try{yield Ce._remove(R)}catch{}});return function(Ce){return he.apply(this,arguments)}}())),new st(I,c,p)):new st(I,c,p)})()}}function ue(f){const c=f.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(Ns(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(Et(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(P(c))return"Blackberry";if(ee(c))return"Webos";if(Ee(c))return"Safari";if((c.includes("chrome/")||bn(c))&&!c.includes("edge/"))return"Chrome";if($(c))return"Android";{const p=f.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===p?.length)return p[1]}return"Other"}function Et(f=(0,z.z$)()){return/firefox\//i.test(f)}function Ee(f=(0,z.z$)()){const c=f.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function bn(f=(0,z.z$)()){return/crios\//i.test(f)}function Ns(f=(0,z.z$)()){return/iemobile/i.test(f)}function $(f=(0,z.z$)()){return/android/i.test(f)}function P(f=(0,z.z$)()){return/blackberry/i.test(f)}function ee(f=(0,z.z$)()){return/webos/i.test(f)}function _e(f=(0,z.z$)()){return/iphone|ipad|ipod/i.test(f)||/macintosh/i.test(f)&&/mobile/i.test(f)}function $e(f=(0,z.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(f)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(f)}function rn(f=(0,z.z$)()){return _e(f)||$(f)||ee(f)||P(f)||/windows phone/i.test(f)||Ns(f)}function We(f,c=[]){let d;switch(f){case"Browser":d=ue((0,z.z$)());break;case"Worker":d=`${ue((0,z.z$)())}-${f}`;break;default:d=f}const p=c.length?c.join(","):"FirebaseCore-web";return`${d}/JsCore/${x.SDK_VERSION}/${p}`}class pa{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,d){const p=I=>new Promise((R,L)=>{try{R(c(I))}catch(X){L(X)}});p.onAbort=d,this.queue.push(p);const _=this.queue.length-1;return()=>{this.queue[_]=()=>Promise.resolve()}}runMiddleware(c){var d=this;return(0,T.Z)(function*(){if(d.auth.currentUser===c)return;const p=[];try{for(const _ of d.queue)yield _(c),_.onAbort&&p.push(_.onAbort)}catch(_){p.reverse();for(const I of p)try{I()}catch{}throw d.auth._errorFactory.create("login-blocked",{originalMessage:_?.message})}})()}}function Ll(){return(Ll=(0,T.Z)(function*(f,c={}){return K(f,"GET","/v2/passwordPolicy",k(f,c))})).apply(this,arguments)}class Sr{constructor(c){var d,p,_,I;const R=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(d=R.minPasswordLength)&&void 0!==d?d:6,R.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=R.maxPasswordLength),void 0!==R.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=R.containsLowercaseCharacter),void 0!==R.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=R.containsUppercaseCharacter),void 0!==R.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=R.containsNumericCharacter),void 0!==R.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=R.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(_=null===(p=c.allowedNonAlphanumericCharacters)||void 0===p?void 0:p.join(""))&&void 0!==_?_:"",this.forceUpgradeOnSignin=null!==(I=c.forceUpgradeOnSignin)&&void 0!==I&&I,this.schemaVersion=c.schemaVersion}validatePassword(c){var d,p,_,I,R,L;const X={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,X),this.validatePasswordCharacterOptions(c,X),X.isValid&&(X.isValid=null===(d=X.meetsMinPasswordLength)||void 0===d||d),X.isValid&&(X.isValid=null===(p=X.meetsMaxPasswordLength)||void 0===p||p),X.isValid&&(X.isValid=null===(_=X.containsLowercaseLetter)||void 0===_||_),X.isValid&&(X.isValid=null===(I=X.containsUppercaseLetter)||void 0===I||I),X.isValid&&(X.isValid=null===(R=X.containsNumericCharacter)||void 0===R||R),X.isValid&&(X.isValid=null===(L=X.containsNonAlphanumericCharacter)||void 0===L||L),X}validatePasswordLengthOptions(c,d){const p=this.customStrengthOptions.minPasswordLength,_=this.customStrengthOptions.maxPasswordLength;p&&(d.meetsMinPasswordLength=c.length>=p),_&&(d.meetsMaxPasswordLength=c.length<=_)}validatePasswordCharacterOptions(c,d){let p;this.updatePasswordCharacterOptionsStatuses(d,!1,!1,!1,!1);for(let _=0;_<c.length;_++)p=c.charAt(_),this.updatePasswordCharacterOptionsStatuses(d,p>="a"&&p<="z",p>="A"&&p<="Z",p>="0"&&p<="9",this.allowedNonAlphanumericCharacters.includes(p))}updatePasswordCharacterOptionsStatuses(c,d,p,_,I){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=d)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=p)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=_)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=I))}}class GD{constructor(c,d,p,_){this.app=c,this.heartbeatServiceProvider=d,this.appCheckServiceProvider=p,this.config=_,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $_(this),this.idTokenSubscription=new $_(this),this.beforeStateQueue=new pa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ye,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=_.sdkClientVersion}_initializeWithPersistence(c,d){var p=this;return d&&(this._popupRedirectResolver=H(d)),this._initializationPromise=this.queue((0,T.Z)(function*(){var _,I;if(!p._deleted&&(p.persistenceManager=yield st.create(p,c),!p._deleted)){if(null!==(_=p._popupRedirectResolver)&&void 0!==_&&_._shouldInitProactively)try{yield p._popupRedirectResolver._initialize(p)}catch{}yield p.initializeCurrentUser(d),p.lastNotifiedUid=(null===(I=p.currentUser)||void 0===I?void 0:I.uid)||null,!p._deleted&&(p._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,T.Z)(function*(){if(c._deleted)return;const d=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||d){if(c.currentUser&&d&&c.currentUser.uid===d.uid)return c._currentUser._assign(d),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(d,!0)}})()}initializeCurrentUser(c){var d=this;return(0,T.Z)(function*(){var p;const _=yield d.assertedPersistence.getCurrentUser();let I=_,R=!1;if(c&&d.config.authDomain){yield d.getOrInitRedirectPersistenceManager();const L=null===(p=d.redirectUser)||void 0===p?void 0:p._redirectEventId,X=I?._redirectEventId,he=yield d.tryRedirectSignIn(c);(!L||L===X)&&he?.user&&(I=he.user,R=!0)}if(!I)return d.directlySetCurrentUser(null);if(!I._redirectEventId){if(R)try{yield d.beforeStateQueue.runMiddleware(I)}catch(L){I=_,d._popupRedirectResolver._overrideRedirectResult(d,()=>Promise.reject(L))}return I?d.reloadAndSetCurrentUserOrClear(I):d.directlySetCurrentUser(null)}return te(d._popupRedirectResolver,d,"argument-error"),yield d.getOrInitRedirectPersistenceManager(),d.redirectUser&&d.redirectUser._redirectEventId===I._redirectEventId?d.directlySetCurrentUser(I):d.reloadAndSetCurrentUserOrClear(I)})()}tryRedirectSignIn(c){var d=this;return(0,T.Z)(function*(){let p=null;try{p=yield d._popupRedirectResolver._completeRedirectFn(d,c,!0)}catch{yield d._setRedirectUser(null)}return p})()}reloadAndSetCurrentUserOrClear(c){var d=this;return(0,T.Z)(function*(){try{yield wn(c)}catch(p){if("auth/network-request-failed"!==p?.code)return d.directlySetCurrentUser(null)}return d.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function tt(){if(typeof navigator>"u")return null;const f=navigator;return f.languages&&f.languages[0]||f.language||null}()}_delete(){var c=this;return(0,T.Z)(function*(){c._deleted=!0})()}updateCurrentUser(c){var d=this;return(0,T.Z)(function*(){const p=c?(0,z.m9)(c):null;return p&&te(p.auth.config.apiKey===d.config.apiKey,d,"invalid-user-token"),d._updateCurrentUser(p&&p._clone(d))})()}_updateCurrentUser(c,d=!1){var p=this;return(0,T.Z)(function*(){if(!p._deleted)return c&&te(p.tenantId===c.tenantId,p,"tenant-id-mismatch"),d||(yield p.beforeStateQueue.runMiddleware(c)),p.queue((0,T.Z)(function*(){yield p.directlySetCurrentUser(c),p.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,T.Z)(function*(){return yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0)})()}setPersistence(c){var d=this;return this.queue((0,T.Z)(function*(){yield d.assertedPersistence.setPersistence(H(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var d=this;return(0,T.Z)(function*(){d._getPasswordPolicyInternal()||(yield d._updatePasswordPolicy());const p=d._getPasswordPolicyInternal();return p.schemaVersion!==d.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(d._errorFactory.create("unsupported-password-policy-schema-version",{})):p.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,T.Z)(function*(){const d=yield function WD(f){return Ll.apply(this,arguments)}(c),p=new Sr(d);null===c.tenantId?c._projectPasswordPolicy=p:c._tenantPasswordPolicies[c.tenantId]=p})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new z.LL("auth","Firebase",c())}onAuthStateChanged(c,d,p){return this.registerStateListener(this.authStateSubscription,c,d,p)}beforeAuthStateChanged(c,d){return this.beforeStateQueue.pushCallback(c,d)}onIdTokenChanged(c,d,p){return this.registerStateListener(this.idTokenSubscription,c,d,p)}authStateReady(){return new Promise((c,d)=>{if(this.currentUser)c();else{const p=this.onAuthStateChanged(()=>{p(),c()},d)}})}revokeAccessToken(c){var d=this;return(0,T.Z)(function*(){if(d.currentUser){const p=yield d.currentUser.getIdToken(),_={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:p};null!=d.tenantId&&(_.tenantId=d.tenantId),yield function S(f,c){return A.apply(this,arguments)}(d,_)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,d){var p=this;return(0,T.Z)(function*(){const _=yield p.getOrInitRedirectPersistenceManager(d);return null===c?_.removeCurrentUser():_.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var d=this;return(0,T.Z)(function*(){if(!d.redirectPersistenceManager){const p=c&&H(c)||d._popupRedirectResolver;te(p,d,"argument-error"),d.redirectPersistenceManager=yield st.create(d,[H(p._redirectPersistence)],"redirectUser"),d.redirectUser=yield d.redirectPersistenceManager.getCurrentUser()}return d.redirectPersistenceManager})()}_redirectUserForId(c){var d=this;return(0,T.Z)(function*(){var p,_;return d._isInitialized&&(yield d.queue((0,T.Z)(function*(){}))),(null===(p=d._currentUser)||void 0===p?void 0:p._redirectEventId)===c?d._currentUser:(null===(_=d.redirectUser)||void 0===_?void 0:_._redirectEventId)===c?d.redirectUser:null})()}_persistUserIfCurrent(c){var d=this;return(0,T.Z)(function*(){if(c===d.currentUser)return d.queue((0,T.Z)(function*(){return d.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,d;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const p=null!==(d=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==d?d:null;this.lastNotifiedUid!==p&&(this.lastNotifiedUid=p,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,d,p,_){if(this._deleted)return()=>{};const I="function"==typeof d?d:d.next.bind(d);let R=!1;const L=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(L,this,"internal-error"),L.then(()=>{R||I(this.currentUser)}),"function"==typeof d){const X=c.addObserver(d,p,_);return()=>{R=!0,X()}}{const X=c.addObserver(d);return()=>{R=!0,X()}}}directlySetCurrentUser(c){var d=this;return(0,T.Z)(function*(){d.currentUser&&d.currentUser!==c&&d._currentUser._stopProactiveRefresh(),c&&d.isProactiveRefreshEnabled&&c._startProactiveRefresh(),d.currentUser=c,c?yield d.assertedPersistence.setCurrentUser(c):yield d.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=We(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,T.Z)(function*(){var d;const p={"X-Client-Version":c.clientVersion};c.app.options.appId&&(p["X-Firebase-gmpid"]=c.app.options.appId);const _=yield null===(d=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getHeartbeatsHeader();_&&(p["X-Firebase-Client"]=_);const I=yield c._getAppCheckToken();return I&&(p["X-Firebase-AppCheck"]=I),p})()}_getAppCheckToken(){var c=this;return(0,T.Z)(function*(){var d;const p=yield null===(d=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===d?void 0:d.getToken();return p?.error&&function Cn(f,...c){Me.logLevel<=ve.in.WARN&&Me.warn(`Auth (${x.SDK_VERSION}): ${f}`,...c)}(`Error while retrieving App Check token: ${p.error}`),p?.token})()}}function zt(f){return(0,z.m9)(f)}class $_{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,z.ne)(d=>this.observer=d)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Hf(f){return new Promise((c,d)=>{const p=document.createElement("script");p.setAttribute("src",f),p.onload=c,p.onerror=_=>{const I=yt("internal-error");I.customData=_,d(I)},p.type="text/javascript",p.charset="UTF-8",function xs(){var f,c;return null!==(c=null===(f=document.getElementsByTagName("head"))||void 0===f?void 0:f[0])&&void 0!==c?c:document}().appendChild(p)})}function H_(f){return`__${f}${Math.floor(1e6*Math.random())}`}class q_{constructor(c){this.type="recaptcha-enterprise",this.auth=zt(c)}verify(c="verify",d=!1){var p=this;return(0,T.Z)(function*(){function I(){return I=(0,T.Z)(function*(L){if(!d){if(null==L.tenantId&&null!=L._agentRecaptchaConfig)return L._agentRecaptchaConfig.siteKey;if(null!=L.tenantId&&void 0!==L._tenantRecaptchaConfigs[L.tenantId])return L._tenantRecaptchaConfigs[L.tenantId].siteKey}return new Promise(function(){var X=(0,T.Z)(function*(he,Ce){mi(L,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(Xe=>{if(void 0!==Xe.recaptchaKey){const ir=new Nn(Xe);return null==L.tenantId?L._agentRecaptchaConfig=ir:L._tenantRecaptchaConfigs[L.tenantId]=ir,he(ir.siteKey)}Ce(new Error("recaptcha Enterprise site key undefined"))}).catch(Xe=>{Ce(Xe)})});return function(he,Ce){return X.apply(this,arguments)}}())}),I.apply(this,arguments)}function R(L,X,he){const Ce=window.grecaptcha;En(Ce)?Ce.enterprise.ready(()=>{Ce.enterprise.execute(L,{action:c}).then(Xe=>{X(Xe)}).catch(()=>{X("NO_RECAPTCHA")})}):he(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((L,X)=>{(function _(L){return I.apply(this,arguments)})(p.auth).then(he=>{if(!d&&En(window.grecaptcha))R(he,L,X);else{if(typeof window>"u")return void X(new Error("RecaptchaVerifier is only supported in browser"));Hf("https://www.google.com/recaptcha/enterprise.js?render="+he).then(()=>{R(he,L,X)}).catch(Ce=>{X(Ce)})}}).catch(he=>{X(he)})})})()}}function zf(f,c,d){return qf.apply(this,arguments)}function qf(){return(qf=(0,T.Z)(function*(f,c,d,p=!1){const _=new q_(f);let I;try{I=yield _.verify(d)}catch{I=yield _.verify(d,!0)}const R=Object.assign({},c);return Object.assign(R,p?{captchaResp:I}:{captchaResponse:I}),Object.assign(R,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(R,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),R})).apply(this,arguments)}function zn(f,c,d,p){return Re.apply(this,arguments)}function Re(){return Re=(0,T.Z)(function*(f,c,d,p){var _;if(null!==(_=f._getRecaptchaConfig())&&void 0!==_&&_.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const I=yield zf(f,c,d,"getOobCode"===d);return p(f,I)}return p(f,c).catch(function(){var I=(0,T.Z)(function*(R){if("auth/missing-recaptcha-token"===R.code){console.log(`${d} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const L=yield zf(f,c,d,"getOobCode"===d);return p(f,L)}return Promise.reject(R)});return function(R){return I.apply(this,arguments)}}())}),Re.apply(this,arguments)}function W_(f,c,d){const p=zt(f);te(p._canInitEmulator,p,"emulator-config-failed"),te(/^https?:\/\//.test(c),p,"invalid-emulator-scheme");const _=!!d?.disableWarnings,I=Ms(c),{host:R,port:L}=function _u(f){const c=Ms(f),d=/(\/\/)?([^?#/]+)/.exec(f.substr(c.length));if(!d)return{host:"",port:null};const p=d[2].split("@").pop()||"",_=/^(\[[^\]]+\])(:|$)/.exec(p);if(_){const I=_[1];return{host:I,port:G_(p.substr(I.length+1))}}{const[I,R]=p.split(":");return{host:I,port:G_(R)}}}(c);p.config.emulator={url:`${I}//${R}${null===L?"":`:${L}`}/`},p.settings.appVerificationDisabledForTesting=!0,p.emulatorConfig=Object.freeze({host:R,port:L,protocol:I.replace(":",""),options:Object.freeze({disableWarnings:_})}),_||function Gf(){function f(){const c=document.createElement("p"),d=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",d.position="fixed",d.width="100%",d.backgroundColor="#ffffff",d.border=".1em solid #000000",d.color="#b50000",d.bottom="0px",d.left="0px",d.margin="0px",d.zIndex="10000",d.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",f):f())}()}function Ms(f){const c=f.indexOf(":");return c<0?"":f.substr(0,c+1)}function G_(f){if(!f)return null;const c=Number(f);return isNaN(c)?null:c}class vo{constructor(c,d){this.providerId=c,this.signInMethod=d}toJSON(){return et("not implemented")}_getIdTokenResponse(c){return et("not implemented")}_linkToIdToken(c,d){return et("not implemented")}_getReauthenticationResolver(c){return et("not implemented")}}function ga(f,c){return Io.apply(this,arguments)}function Io(){return(Io=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:resetPassword",k(f,c))})).apply(this,arguments)}function yu(){return(yu=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Z_(f,c){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function vu(){return(vu=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:update",k(f,c))})).apply(this,arguments)}function pr(f,c){return Iu.apply(this,arguments)}function Iu(){return(Iu=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithPassword",k(f,c))})).apply(this,arguments)}function jl(f,c){return wt.apply(this,arguments)}function wt(){return(wt=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:sendOobCode",k(f,c))})).apply(this,arguments)}function Zf(){return(Zf=(0,T.Z)(function*(f,c){return jl(f,c)})).apply(this,arguments)}function ye(f,c){return ma.apply(this,arguments)}function ma(){return(ma=(0,T.Z)(function*(f,c){return jl(f,c)})).apply(this,arguments)}function $l(f,c){return Eu.apply(this,arguments)}function Eu(){return(Eu=(0,T.Z)(function*(f,c){return jl(f,c)})).apply(this,arguments)}function zl(){return(zl=(0,T.Z)(function*(f,c){return jl(f,c)})).apply(this,arguments)}function Kf(){return(Kf=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithEmailLink",k(f,c))})).apply(this,arguments)}function Qf(){return(Qf=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithEmailLink",k(f,c))})).apply(this,arguments)}class wu extends vo{constructor(c,d,p,_=null){super("password",p),this._email=c,this._password=d,this._tenantId=_}static _fromEmailAndPassword(c,d){return new wu(c,d,"password")}static _fromEmailAndCode(c,d,p=null){return new wu(c,d,"emailLink",p)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c;if(d?.email&&d?.password){if("password"===d.signInMethod)return this._fromEmailAndPassword(d.email,d.password);if("emailLink"===d.signInMethod)return this._fromEmailAndCode(d.email,d.password,d.tenantId)}return null}_getIdTokenResponse(c){var d=this;return(0,T.Z)(function*(){switch(d.signInMethod){case"password":return zn(c,{returnSecureToken:!0,email:d._email,password:d._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",pr);case"emailLink":return function ql(f,c){return Kf.apply(this,arguments)}(c,{email:d._email,oobCode:d._password});default:Ge(c,"internal-error")}})()}_linkToIdToken(c,d){var p=this;return(0,T.Z)(function*(){switch(p.signInMethod){case"password":return zn(c,{idToken:d,returnSecureToken:!0,email:p._email,password:p._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Z_);case"emailLink":return function XD(f,c){return Qf.apply(this,arguments)}(c,{idToken:d,email:p._email,oobCode:p._password});default:Ge(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function ts(f,c){return Os.apply(this,arguments)}function Os(){return(Os=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithIdp",k(f,c))})).apply(this,arguments)}class br extends vo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const d=new br(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(d.idToken=c.idToken),c.accessToken&&(d.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(d.nonce=c.nonce),c.pendingToken&&(d.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(d.accessToken=c.oauthToken,d.secret=c.oauthTokenSecret):Ge("argument-error"),d}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c,{providerId:p,signInMethod:_}=d,I=(0,gt._T)(d,["providerId","signInMethod"]);if(!p||!_)return null;const R=new br(p,_);return R.idToken=I.idToken||void 0,R.accessToken=I.accessToken||void 0,R.secret=I.secret,R.nonce=I.nonce,R.pendingToken=I.pendingToken||null,R}_getIdTokenResponse(c){return ts(c,this.buildRequest())}_linkToIdToken(c,d){const p=this.buildRequest();return p.idToken=d,ts(c,p)}_getReauthenticationResolver(c){const d=this.buildRequest();return d.autoCreate=!1,ts(c,d)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const d={};this.idToken&&(d.id_token=this.idToken),this.accessToken&&(d.access_token=this.accessToken),this.secret&&(d.oauth_token_secret=this.secret),d.providerId=this.providerId,this.nonce&&!this.pendingToken&&(d.nonce=this.nonce),c.postBody=(0,z.xO)(d)}return c}}function Gl(){return(Gl=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:sendVerificationCode",k(f,c))})).apply(this,arguments)}function Tu(){return(Tu=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithPhoneNumber",k(f,c))})).apply(this,arguments)}function Zl(){return(Zl=(0,T.Z)(function*(f,c){const d=yield Ve(f,"POST","/v1/accounts:signInWithPhoneNumber",k(f,c));if(d.temporaryProof)throw $t(f,"account-exists-with-different-credential",d);return d})).apply(this,arguments)}const ns={USER_NOT_FOUND:"user-not-found"};function pe(){return(pe=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithPhoneNumber",k(f,Object.assign(Object.assign({},c),{operation:"REAUTH"})),ns)})).apply(this,arguments)}class rs extends vo{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,d){return new rs({verificationId:c,verificationCode:d})}static _fromTokenResponse(c,d){return new rs({phoneNumber:c,temporaryProof:d})}_getIdTokenResponse(c){return function Q_(f,c){return Tu.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,d){return function Eo(f,c){return Zl.apply(this,arguments)}(c,Object.assign({idToken:d},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function Y_(f,c){return pe.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:d,verificationId:p,verificationCode:_}=this.params;return c&&d?{temporaryProof:c,phoneNumber:d}:{sessionInfo:p,code:_}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:d,verificationCode:p,phoneNumber:_,temporaryProof:I}=c;return p||d||_||I?new rs({verificationId:d,verificationCode:p,phoneNumber:_,temporaryProof:I}):null}}class ks{constructor(c){var d,p,_,I,R,L;const X=(0,z.zd)((0,z.pd)(c)),he=null!==(d=X.apiKey)&&void 0!==d?d:null,Ce=null!==(p=X.oobCode)&&void 0!==p?p:null,Xe=function _t(f){switch(f){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(_=X.mode)&&void 0!==_?_:null);te(he&&Ce&&Xe,"argument-error"),this.apiKey=he,this.operation=Xe,this.code=Ce,this.continueUrl=null!==(I=X.continueUrl)&&void 0!==I?I:null,this.languageCode=null!==(R=X.languageCode)&&void 0!==R?R:null,this.tenantId=null!==(L=X.tenantId)&&void 0!==L?L:null}static parseLink(c){const d=function Du(f){const c=(0,z.zd)((0,z.pd)(f)).link,d=c?(0,z.zd)((0,z.pd)(c)).deep_link_id:null,p=(0,z.zd)((0,z.pd)(f)).deep_link_id;return(p?(0,z.zd)((0,z.pd)(p)).link:null)||p||d||c||f}(c);try{return new ks(d)}catch{return null}}}let Kl=(()=>{class f{constructor(){this.providerId=f.PROVIDER_ID}static credential(d,p){return wu._fromEmailAndPassword(d,p)}static credentialWithLink(d,p){const _=ks.parseLink(p);return te(_,"argument-error"),wu._fromEmailAndCode(d,_.code,_.tenantId)}}return f.PROVIDER_ID="password",f.EMAIL_PASSWORD_SIGN_IN_METHOD="password",f.EMAIL_LINK_SIGN_IN_METHOD="emailLink",f})();class Li{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class wo extends Li{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class Rr extends wo{static credentialFromJSON(c){const d="string"==typeof c?JSON.parse(c):c;return te("providerId"in d&&"signInMethod"in d,"argument-error"),br._fromParams(d)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return te(c.idToken||c.accessToken,"argument-error"),br._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return Rr.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return Rr.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:d,oauthAccessToken:p,oauthTokenSecret:_,pendingToken:I,nonce:R,providerId:L}=c;if(!p&&!_&&!d&&!I||!L)return null;try{return new Rr(L)._credential({idToken:d,accessToken:p,nonce:R,pendingToken:I})}catch{return null}}}let Cu=(()=>{class f extends wo{constructor(){super("facebook.com")}static credential(d){return br._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.FACEBOOK_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return f.credential(d.oauthAccessToken)}catch{return null}}}return f.FACEBOOK_SIGN_IN_METHOD="facebook.com",f.PROVIDER_ID="facebook.com",f})(),ii=(()=>{class f extends wo{constructor(){super("google.com"),this.addScope("profile")}static credential(d,p){return br._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.GOOGLE_SIGN_IN_METHOD,idToken:d,accessToken:p})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthIdToken:p,oauthAccessToken:_}=d;if(!p&&!_)return null;try{return f.credential(p,_)}catch{return null}}}return f.GOOGLE_SIGN_IN_METHOD="google.com",f.PROVIDER_ID="google.com",f})(),wi=(()=>{class f extends wo{constructor(){super("github.com")}static credential(d){return br._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.GITHUB_SIGN_IN_METHOD,accessToken:d})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d||!("oauthAccessToken"in d)||!d.oauthAccessToken)return null;try{return f.credential(d.oauthAccessToken)}catch{return null}}}return f.GITHUB_SIGN_IN_METHOD="github.com",f.PROVIDER_ID="github.com",f})();class Vi extends vo{constructor(c,d){super(c,c),this.pendingToken=d}_getIdTokenResponse(c){return ts(c,this.buildRequest())}_linkToIdToken(c,d){const p=this.buildRequest();return p.idToken=d,ts(c,p)}_getReauthenticationResolver(c){const d=this.buildRequest();return d.autoCreate=!1,ts(c,d)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const d="string"==typeof c?JSON.parse(c):c,{providerId:p,signInMethod:_,pendingToken:I}=d;return p&&_&&I&&p===_?new Vi(p,I):null}static _create(c,d){return new Vi(c,d)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class To extends Li{constructor(c){te(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return To.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return To.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const d=Vi.fromJSON(c);return te(d,"argument-error"),d}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:d,providerId:p}=c;if(!d||!p)return null;try{return Vi._create(p,d)}catch{return null}}}let Yf=(()=>{class f extends wo{constructor(){super("twitter.com")}static credential(d,p){return br._fromParams({providerId:f.PROVIDER_ID,signInMethod:f.TWITTER_SIGN_IN_METHOD,oauthToken:d,oauthTokenSecret:p})}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{oauthAccessToken:p,oauthTokenSecret:_}=d;if(!p||!_)return null;try{return f.credential(p,_)}catch{return null}}}return f.TWITTER_SIGN_IN_METHOD="twitter.com",f.PROVIDER_ID="twitter.com",f})();function Ti(f,c){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signUp",k(f,c))})).apply(this,arguments)}class Pr{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,d,p,_=!1){return(0,T.Z)(function*(){const I=yield v._fromIdTokenResponse(c,p,_),R=Yl(p);return new Pr({user:I,providerId:R,_tokenResponse:p,operationType:d})})()}static _forOperation(c,d,p){return(0,T.Z)(function*(){yield c._updateTokensIfNecessary(p,!0);const _=Yl(p);return new Pr({user:c,providerId:_,_tokenResponse:p,operationType:d})})()}}function Yl(f){return f.providerId?f.providerId:"phoneNumber"in f?"phone":null}function Jl(f){return Su.apply(this,arguments)}function Su(){return(Su=(0,T.Z)(function*(f){var c;const d=zt(f);if(yield d._initializationPromise,null!==(c=d.currentUser)&&void 0!==c&&c.isAnonymous)return new Pr({user:d.currentUser,providerId:null,operationType:"signIn"});const p=yield Ti(d,{returnSecureToken:!0}),_=yield Pr._fromIdTokenResponse(d,"signIn",p,!0);return yield d._updateCurrentUser(_.user),_})).apply(this,arguments)}class _a extends z.ZR{constructor(c,d,p,_){var I;super(d.code,d.message),this.operationType=p,this.user=_,Object.setPrototypeOf(this,_a.prototype),this.customData={appName:c.name,tenantId:null!==(I=c.tenantId)&&void 0!==I?I:void 0,_serverResponse:d.customData._serverResponse,operationType:p}}static _fromErrorAndOperation(c,d,p,_){return new _a(c,d,p,_)}}function Do(f,c,d,p){return("reauthenticate"===c?d._getReauthenticationResolver(f):d._getIdTokenResponse(f)).catch(I=>{throw"auth/multi-factor-auth-required"===I.code?_a._fromErrorAndOperation(f,I,c,p):I})}function Xl(f){return new Set(f.map(({providerId:c})=>c).filter(c=>!!c))}function Jf(f,c){return ed.apply(this,arguments)}function ed(){return ed=(0,T.Z)(function*(f,c){const d=(0,z.m9)(f);yield Ru(!0,d,c);const{providerUserInfo:p}=yield function ni(f,c){return ri.apply(this,arguments)}(d.auth,{idToken:yield d.getIdToken(),deleteProvider:[c]}),_=Xl(p||[]);return d.providerData=d.providerData.filter(I=>_.has(I.providerId)),_.has("phone")||(d.phoneNumber=null),yield d.auth._persistUserIfCurrent(d),d}),ed.apply(this,arguments)}function bu(f,c){return td.apply(this,arguments)}function td(){return(td=(0,T.Z)(function*(f,c,d=!1){const p=yield Ht(f,c._linkToIdToken(f.auth,yield f.getIdToken()),d);return Pr._forOperation(f,"link",p)})).apply(this,arguments)}function Ru(f,c,d){return Nr.apply(this,arguments)}function Nr(){return(Nr=(0,T.Z)(function*(f,c,d){yield wn(c);const _=!1===f?"provider-already-linked":"no-such-provider";te(Xl(c.providerData).has(d)===f,c.auth,_)})).apply(this,arguments)}function Xf(f,c){return Pu.apply(this,arguments)}function Pu(){return(Pu=(0,T.Z)(function*(f,c,d=!1){const{auth:p}=f,_="reauthenticate";try{const I=yield Ht(f,Do(p,_,c,f),d);te(I.idToken,p,"internal-error");const R=fr(I.idToken);te(R,p,"internal-error");const{sub:L}=R;return te(f.uid===L,p,"user-mismatch"),Pr._forOperation(f,_,I)}catch(I){throw"auth/user-not-found"===I?.code&&Ge(p,"user-mismatch"),I}})).apply(this,arguments)}function ep(f,c){return nd.apply(this,arguments)}function nd(){return(nd=(0,T.Z)(function*(f,c,d=!1){const p="signIn",_=yield Do(f,p,c),I=yield Pr._fromIdTokenResponse(f,p,_);return d||(yield f._updateCurrentUser(I.user)),I})).apply(this,arguments)}function Nu(f,c){return rd.apply(this,arguments)}function rd(){return(rd=(0,T.Z)(function*(f,c){return ep(zt(f),c)})).apply(this,arguments)}function id(f,c){return sd.apply(this,arguments)}function sd(){return(sd=(0,T.Z)(function*(f,c){const d=(0,z.m9)(f);return yield Ru(!1,d,c.providerId),bu(d,c)})).apply(this,arguments)}function tp(f,c){return od.apply(this,arguments)}function od(){return(od=(0,T.Z)(function*(f,c){return Xf((0,z.m9)(f),c)})).apply(this,arguments)}function ud(){return(ud=(0,T.Z)(function*(f,c){return Ve(f,"POST","/v1/accounts:signInWithCustomToken",k(f,c))})).apply(this,arguments)}function J_(f,c){return cd.apply(this,arguments)}function cd(){return cd=(0,T.Z)(function*(f,c){const d=zt(f),p=yield function ad(f,c){return ud.apply(this,arguments)}(d,{token:c,returnSecureToken:!0}),_=yield Pr._fromIdTokenResponse(d,"signIn",p);return yield d._updateCurrentUser(_.user),_}),cd.apply(this,arguments)}class Ui{constructor(c,d){this.factorId=c,this.uid=d.mfaEnrollmentId,this.enrollmentTime=new Date(d.enrolledAt).toUTCString(),this.displayName=d.displayName}static _fromServerResponse(c,d){return"phoneInfo"in d?ld._fromServerResponse(c,d):"totpInfo"in d?xu._fromServerResponse(c,d):Ge(c,"internal-error")}}class ld extends Ui{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,d){return new ld(d)}}class xu extends Ui{constructor(c){super("totp",c)}static _fromServerResponse(c,d){return new xu(d)}}function er(f,c,d){var p;te((null===(p=d.url)||void 0===p?void 0:p.length)>0,f,"invalid-continue-uri"),te(typeof d.dynamicLinkDomain>"u"||d.dynamicLinkDomain.length>0,f,"invalid-dynamic-link-domain"),c.continueUrl=d.url,c.dynamicLinkDomain=d.dynamicLinkDomain,c.canHandleCodeInApp=d.handleCodeInApp,d.iOS&&(te(d.iOS.bundleId.length>0,f,"missing-ios-bundle-id"),c.iOSBundleId=d.iOS.bundleId),d.android&&(te(d.android.packageName.length>0,f,"missing-android-pkg-name"),c.androidInstallApp=d.android.installApp,c.androidMinimumVersionCode=d.android.minimumVersion,c.androidPackageName=d.android.packageName)}function qn(f){return Je.apply(this,arguments)}function Je(){return(Je=(0,T.Z)(function*(f){const c=zt(f);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function Mn(f,c,d){return On.apply(this,arguments)}function On(){return(On=(0,T.Z)(function*(f,c,d){const p=zt(f),_={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};d&&er(p,_,d),yield zn(p,_,"getOobCode",ye)})).apply(this,arguments)}function ya(f,c,d){return tr.apply(this,arguments)}function tr(){return tr=(0,T.Z)(function*(f,c,d){yield ga((0,z.m9)(f),{oobCode:c,newPassword:d}).catch(function(){var p=(0,T.Z)(function*(_){throw"auth/password-does-not-meet-requirements"===_.code&&qn(f),_});return function(_){return p.apply(this,arguments)}}())}),tr.apply(this,arguments)}function np(f,c){return Mu.apply(this,arguments)}function Mu(){return Mu=(0,T.Z)(function*(f,c){yield function Bl(f,c){return vu.apply(this,arguments)}((0,z.m9)(f),{oobCode:c})}),Mu.apply(this,arguments)}function va(f,c){return dd.apply(this,arguments)}function dd(){return(dd=(0,T.Z)(function*(f,c){const d=(0,z.m9)(f),p=yield ga(d,{oobCode:c}),_=p.requestType;switch(te(_,d,"internal-error"),_){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":te(p.newEmail,d,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":te(p.mfaInfo,d,"internal-error");default:te(p.email,d,"internal-error")}let I=null;return p.mfaInfo&&(I=Ui._fromServerResponse(zt(d),p.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===p.requestType?p.newEmail:p.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===p.requestType?p.email:p.newEmail)||null,multiFactorInfo:I},operation:_}})).apply(this,arguments)}function X_(f,c){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,T.Z)(function*(f,c){const{data:d}=yield va((0,z.m9)(f),c);return d.email})).apply(this,arguments)}function ce(f,c,d){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,T.Z)(function*(f,c,d){const p=zt(f),R=yield zn(p,{returnSecureToken:!0,email:c,password:d,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ti).catch(X=>{throw"auth/password-does-not-meet-requirements"===X.code&&qn(f),X}),L=yield Pr._fromIdTokenResponse(p,"signIn",R);return yield p._updateCurrentUser(L.user),L})).apply(this,arguments)}function kt(f,c,d){return Nu((0,z.m9)(f),Kl.credential(c,d)).catch(function(){var p=(0,T.Z)(function*(_){throw"auth/password-does-not-meet-requirements"===_.code&&qn(f),_});return function(_){return p.apply(this,arguments)}}())}function si(f,c,d){return Ls.apply(this,arguments)}function Ls(){return(Ls=(0,T.Z)(function*(f,c,d){const p=zt(f),_={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function I(R,L){te(L.handleCodeInApp,p,"argument-error"),L&&er(p,R,L)})(_,d),yield zn(p,_,"getOobCode",$l)})).apply(this,arguments)}function Wn(f,c){const d=ks.parseLink(c);return"EMAIL_SIGNIN"===d?.operation}function Ao(f,c,d){return qt.apply(this,arguments)}function qt(){return(qt=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f),_=Kl.credentialWithLink(c,d||Yt());return te(_._tenantId===(p.tenantId||null),p,"tenant-id-mismatch"),Nu(p,_)})).apply(this,arguments)}function ss(){return(ss=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:createAuthUri",k(f,c))})).apply(this,arguments)}function ke(f,c){return Vs.apply(this,arguments)}function Vs(){return Vs=(0,T.Z)(function*(f,c){const p={identifier:c,continueUri:Sn()?Yt():"http://localhost"},{signinMethods:_}=yield function is(f,c){return ss.apply(this,arguments)}((0,z.m9)(f),p);return _||[]}),Vs.apply(this,arguments)}function rp(f,c){return os.apply(this,arguments)}function os(){return os=(0,T.Z)(function*(f,c){const d=(0,z.m9)(f),_={requestType:"VERIFY_EMAIL",idToken:yield f.getIdToken()};c&&er(d.auth,_,c);const{email:I}=yield function JD(f,c){return Zf.apply(this,arguments)}(d.auth,_);I!==f.email&&(yield f.reload())}),os.apply(this,arguments)}function sn(f,c,d){return Us.apply(this,arguments)}function Us(){return Us=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f),I={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield f.getIdToken(),newEmail:c};d&&er(p.auth,I,d);const{email:R}=yield function Hl(f,c){return zl.apply(this,arguments)}(p.auth,I);R!==f.email&&(yield f.reload())}),Us.apply(this,arguments)}function zr(){return(zr=(0,T.Z)(function*(f,c){return K(f,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Ia(f,c){return Ou.apply(this,arguments)}function Ou(){return Ou=(0,T.Z)(function*(f,{displayName:c,photoURL:d}){if(void 0===c&&void 0===d)return;const p=(0,z.m9)(f),I={idToken:yield p.getIdToken(),displayName:c,photoUrl:d,returnSecureToken:!0},R=yield Ht(p,function Co(f,c){return zr.apply(this,arguments)}(p.auth,I));p.displayName=R.displayName||null,p.photoURL=R.photoUrl||null;const L=p.providerData.find(({providerId:X})=>"password"===X);L&&(L.displayName=p.displayName,L.photoURL=p.photoURL),yield p._updateTokensIfNecessary(R)}),Ou.apply(this,arguments)}function as(f,c){return So((0,z.m9)(f),c,null)}function Bi(f,c){return So((0,z.m9)(f),null,c)}function So(f,c,d){return Bs.apply(this,arguments)}function Bs(){return Bs=(0,T.Z)(function*(f,c,d){const{auth:p}=f,I={idToken:yield f.getIdToken(),returnSecureToken:!0};c&&(I.email=c),d&&(I.password=d);const R=yield Ht(f,function Ul(f,c){return yu.apply(this,arguments)}(p,I));yield f._updateTokensIfNecessary(R,!0)}),Bs.apply(this,arguments)}class Ea{constructor(c,d,p={}){this.isNewUser=c,this.providerId=d,this.profile=p}}class ku extends Ea{constructor(c,d,p,_){super(c,d,p),this.username=_}}class ip extends Ea{constructor(c,d){super(c,"facebook.com",d)}}class Di extends ku{constructor(c,d){super(c,"github.com",d,"string"==typeof d?.login?d?.login:null)}}class Fu extends Ea{constructor(c,d){super(c,"google.com",d)}}class bo extends ku{constructor(c,d,p){super(c,"twitter.com",d,p)}}function wa(f){const{user:c,_tokenResponse:d}=f;return c.isAnonymous&&!d?{providerId:null,isNewUser:!1,profile:null}:function Ke(f){var c,d;if(!f)return null;const{providerId:p}=f,_=f.rawUserInfo?JSON.parse(f.rawUserInfo):{},I=f.isNewUser||"identitytoolkit#SignupNewUserResponse"===f.kind;if(!p&&f?.idToken){const R=null===(d=null===(c=fr(f.idToken))||void 0===c?void 0:c.firebase)||void 0===d?void 0:d.sign_in_provider;if(R)return new Ea(I,"anonymous"!==R&&"custom"!==R?R:null)}if(!p)return null;switch(p){case"facebook.com":return new ip(I,_);case"github.com":return new Di(I,_);case"google.com":return new Fu(I,_);case"twitter.com":return new bo(I,_,f.screenName||null);case"custom":case"anonymous":return new Ea(I,null);default:return new Ea(I,p,_)}}(d)}class $s{constructor(c,d,p){this.type=c,this.credential=d,this.user=p}static _fromIdtoken(c,d){return new $s("enroll",c,d)}static _fromMfaPendingCredential(c){return new $s("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var d,p;if(c?.multiFactorSession){if(null!==(d=c.multiFactorSession)&&void 0!==d&&d.pendingCredential)return $s._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(p=c.multiFactorSession)&&void 0!==p&&p.idToken)return $s._fromIdtoken(c.multiFactorSession.idToken)}return null}}class op{constructor(c,d,p){this.session=c,this.hints=d,this.signInResolver=p}static _fromError(c,d){const p=zt(c),_=d.customData._serverResponse,I=(_.mfaInfo||[]).map(L=>Ui._fromServerResponse(p,L));te(_.mfaPendingCredential,p,"internal-error");const R=$s._fromMfaPendingCredential(_.mfaPendingCredential);return new op(R,I,function(){var L=(0,T.Z)(function*(X){const he=yield X._process(p,R);delete _.mfaInfo,delete _.mfaPendingCredential;const Ce=Object.assign(Object.assign({},_),{idToken:he.idToken,refreshToken:he.refreshToken});switch(d.operationType){case"signIn":const Xe=yield Pr._fromIdTokenResponse(p,d.operationType,Ce);return yield p._updateCurrentUser(Xe.user),Xe;case"reauthenticate":return te(d.user,p,"internal-error"),Pr._forOperation(d.user,d.operationType,Ce);default:Ge(p,"internal-error")}});return function(X){return L.apply(this,arguments)}}())}resolveSignIn(c){var d=this;return(0,T.Z)(function*(){return d.signInResolver(c)})()}}function n0(f,c){var d;const p=(0,z.m9)(f),_=c;return te(c.customData.operationType,p,"argument-error"),te(null===(d=_.customData._serverResponse)||void 0===d?void 0:d.mfaPendingCredential,p,"argument-error"),op._fromError(p,_)}class ap{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(d=>{d.mfaInfo&&(this.enrolledFactors=d.mfaInfo.map(p=>Ui._fromServerResponse(c.auth,p)))})}static _fromUser(c){return new ap(c)}getSession(){var c=this;return(0,T.Z)(function*(){return $s._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,d){var p=this;return(0,T.Z)(function*(){const _=c,I=yield p.getSession(),R=yield Ht(p.user,_._process(p.user.auth,I,d));return yield p.user._updateTokensIfNecessary(R),p.user.reload()})()}unenroll(c){var d=this;return(0,T.Z)(function*(){const p="string"==typeof c?c:c.uid,_=yield d.user.getIdToken();try{const I=yield Ht(d.user,function a0(f,c){return K(f,"POST","/v2/accounts/mfaEnrollment:withdraw",k(f,c))}(d.user.auth,{idToken:_,mfaEnrollmentId:p}));d.enrolledFactors=d.enrolledFactors.filter(({uid:R})=>R!==p),yield d.user._updateTokensIfNecessary(I),yield d.user.reload()}catch(I){throw I}})()}}const up=new WeakMap;function u0(f){const c=(0,z.m9)(f);return up.has(c)||up.set(c,ap._fromUser(c)),up.get(c)}const gd="__sak";class ey{constructor(c,d){this.storageRetriever=c,this.type=d}_isAvailable(){try{return this.storage?(this.storage.setItem(gd,"1"),this.storage.removeItem(gd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,d){return this.storage.setItem(c,JSON.stringify(d)),Promise.resolve()}_get(c){const d=this.storage.getItem(c);return Promise.resolve(d?JSON.parse(d):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const ty=(()=>{class f extends ey{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(d,p)=>this.onStorageEvent(d,p),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function cp(){const f=(0,z.z$)();return Ee(f)||_e(f)}()&&function me(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=rn(),this._shouldAllowMigration=!0}forAllChangedKeys(d){for(const p of Object.keys(this.listeners)){const _=this.storage.getItem(p),I=this.localCache[p];_!==I&&d(p,I,_)}}onStorageEvent(d,p=!1){if(!d.key)return void this.forAllChangedKeys((L,X,he)=>{this.notifyListeners(L,he)});const _=d.key;if(p?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const L=this.storage.getItem(_);if(d.newValue!==L)null!==d.newValue?this.storage.setItem(_,d.newValue):this.storage.removeItem(_);else if(this.localCache[_]===d.newValue&&!p)return}const I=()=>{const L=this.storage.getItem(_);!p&&this.localCache[_]===L||this.notifyListeners(_,L)},R=this.storage.getItem(_);!function ie(){return(0,z.w1)()&&10===document.documentMode}()||R===d.newValue||d.newValue===d.oldValue?I():setTimeout(I,10)}notifyListeners(d,p){this.localCache[d]=p;const _=this.listeners[d];if(_)for(const I of Array.from(_))I(p&&JSON.parse(p))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((d,p,_)=>{this.onStorageEvent(new StorageEvent("storage",{key:d,oldValue:p,newValue:_}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(d,p){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[d]||(this.listeners[d]=new Set,this.localCache[d]=this.storage.getItem(d)),this.listeners[d].add(p)}_removeListener(d,p){this.listeners[d]&&(this.listeners[d].delete(p),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(d,p){var _=()=>super._set,I=this;return(0,T.Z)(function*(){yield _().call(I,d,p),I.localCache[d]=JSON.stringify(p)})()}_get(d){var p=()=>super._get,_=this;return(0,T.Z)(function*(){const I=yield p().call(_,d);return _.localCache[d]=JSON.stringify(I),I})()}_remove(d){var p=()=>super._remove,_=this;return(0,T.Z)(function*(){yield p().call(_,d),delete _.localCache[d]})()}}return f.type="LOCAL",f})(),Ci=(()=>{class f extends ey{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(d,p){}_removeListener(d,p){}}return f.type="SESSION",f})();let d0=(()=>{class f{constructor(d){this.eventTarget=d,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(d){const p=this.receivers.find(I=>I.isListeningto(d));if(p)return p;const _=new f(d);return this.receivers.push(_),_}isListeningto(d){return this.eventTarget===d}handleEvent(d){var p=this;return(0,T.Z)(function*(){const _=d,{eventId:I,eventType:R,data:L}=_.data,X=p.handlersMap[R];if(!X?.size)return;_.ports[0].postMessage({status:"ack",eventId:I,eventType:R});const he=Array.from(X).map(function(){var Xe=(0,T.Z)(function*(ir){return ir(_.origin,L)});return function(ir){return Xe.apply(this,arguments)}}()),Ce=yield function l0(f){return Promise.all(f.map(function(){var c=(0,T.Z)(function*(d){try{return{fulfilled:!0,value:yield d}}catch(p){return{fulfilled:!1,reason:p}}});return function(d){return c.apply(this,arguments)}}()))}(he);_.ports[0].postMessage({status:"done",eventId:I,eventType:R,response:Ce})})()}_subscribe(d,p){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[d]||(this.handlersMap[d]=new Set),this.handlersMap[d].add(p)}_unsubscribe(d,p){this.handlersMap[d]&&p&&this.handlersMap[d].delete(p),(!p||0===this.handlersMap[d].size)&&delete this.handlersMap[d],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return f.receivers=[],f})();function on(f="",c=10){let d="";for(let p=0;p<c;p++)d+=Math.floor(10*Math.random());return f+d}class Lu{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,d,p=50){var _=this;return(0,T.Z)(function*(){const I=typeof MessageChannel<"u"?new MessageChannel:null;if(!I)throw new Error("connection_unavailable");let R,L;return new Promise((X,he)=>{const Ce=on("",20);I.port1.start();const Xe=setTimeout(()=>{he(new Error("unsupported_event"))},p);L={messageChannel:I,onMessage(ir){const Hi=ir;if(Hi.data.eventId===Ce)switch(Hi.data.status){case"ack":clearTimeout(Xe),R=setTimeout(()=>{he(new Error("timeout"))},3e3);break;case"done":clearTimeout(R),X(Hi.data.response);break;default:clearTimeout(Xe),clearTimeout(R),he(new Error("invalid_response"))}}},_.handlers.add(L),I.port1.addEventListener("message",L.onMessage),_.target.postMessage({eventType:c,eventId:Ce,data:d},[I.port2])}).finally(()=>{L&&_.removeMessageHandler(L)})})()}}function pt(){return window}function Vu(){return typeof pt().WorkerGlobalScope<"u"&&"function"==typeof pt().importScripts}function Uu(){return(Uu=(0,T.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Bu="firebaseLocalStorageDb",Ta="firebaseLocalStorage",yd="fbase_key";class Po{constructor(c){this.request=c}toPromise(){return new Promise((c,d)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{d(this.request.error)})})}}function Hs(f,c){return f.transaction([Ta],c?"readwrite":"readonly").objectStore(Ta)}function us(){const f=indexedDB.open(Bu,1);return new Promise((c,d)=>{f.addEventListener("error",()=>{d(f.error)}),f.addEventListener("upgradeneeded",()=>{const p=f.result;try{p.createObjectStore(Ta,{keyPath:yd})}catch(_){d(_)}}),f.addEventListener("success",(0,T.Z)(function*(){const p=f.result;p.objectStoreNames.contains(Ta)?c(p):(p.close(),yield function Da(){const f=indexedDB.deleteDatabase(Bu);return new Po(f).toPromise()}(),c(yield us()))}))})}function vd(f,c,d){return pp.apply(this,arguments)}function pp(){return(pp=(0,T.Z)(function*(f,c,d){const p=Hs(f,!0).put({[yd]:c,value:d});return new Po(p).toPromise()})).apply(this,arguments)}function gp(){return(gp=(0,T.Z)(function*(f,c){const d=Hs(f,!1).get(c),p=yield new Po(d).toPromise();return void 0===p?null:p.value})).apply(this,arguments)}function mp(f,c){const d=Hs(f,!0).delete(c);return new Po(d).toPromise()}const ju=(()=>{class f{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var d=this;return(0,T.Z)(function*(){return d.db||(d.db=yield us()),d.db})()}_withRetries(d){var p=this;return(0,T.Z)(function*(){let _=0;for(;;)try{const I=yield p._openDb();return yield d(I)}catch(I){if(_++>3)throw I;p.db&&(p.db.close(),p.db=void 0)}})()}initializeServiceWorkerMessaging(){var d=this;return(0,T.Z)(function*(){return Vu()?d.initializeReceiver():d.initializeSender()})()}initializeReceiver(){var d=this;return(0,T.Z)(function*(){d.receiver=d0._getInstance(function fp(){return Vu()?self:null}()),d.receiver._subscribe("keyChanged",function(){var p=(0,T.Z)(function*(_,I){return{keyProcessed:(yield d._poll()).includes(I.key)}});return function(_,I){return p.apply(this,arguments)}}()),d.receiver._subscribe("ping",function(){var p=(0,T.Z)(function*(_,I){return["keyChanged"]});return function(_,I){return p.apply(this,arguments)}}())})()}initializeSender(){var d=this;return(0,T.Z)(function*(){var p,_;if(d.activeServiceWorker=yield function hp(){return Uu.apply(this,arguments)}(),!d.activeServiceWorker)return;d.sender=new Lu(d.activeServiceWorker);const I=yield d.sender._send("ping",{},800);I&&null!==(p=I[0])&&void 0!==p&&p.fulfilled&&null!==(_=I[0])&&void 0!==_&&_.value.includes("keyChanged")&&(d.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(d){var p=this;return(0,T.Z)(function*(){if(p.sender&&p.activeServiceWorker&&function md(){var f;return(null===(f=navigator?.serviceWorker)||void 0===f?void 0:f.controller)||null}()===p.activeServiceWorker)try{yield p.sender._send("keyChanged",{key:d},p.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,T.Z)(function*(){try{if(!indexedDB)return!1;const d=yield us();return yield vd(d,gd,"1"),yield mp(d,gd),!0}catch{}return!1})()}_withPendingWrite(d){var p=this;return(0,T.Z)(function*(){p.pendingWrites++;try{yield d()}finally{p.pendingWrites--}})()}_set(d,p){var _=this;return(0,T.Z)(function*(){return _._withPendingWrite((0,T.Z)(function*(){return yield _._withRetries(I=>vd(I,d,p)),_.localCache[d]=p,_.notifyServiceWorker(d)}))})()}_get(d){var p=this;return(0,T.Z)(function*(){const _=yield p._withRetries(I=>function h0(f,c){return gp.apply(this,arguments)}(I,d));return p.localCache[d]=_,_})()}_remove(d){var p=this;return(0,T.Z)(function*(){return p._withPendingWrite((0,T.Z)(function*(){return yield p._withRetries(_=>mp(_,d)),delete p.localCache[d],p.notifyServiceWorker(d)}))})()}_poll(){var d=this;return(0,T.Z)(function*(){const p=yield d._withRetries(R=>{const L=Hs(R,!1).getAll();return new Po(L).toPromise()});if(!p)return[];if(0!==d.pendingWrites)return[];const _=[],I=new Set;for(const{fbase_key:R,value:L}of p)I.add(R),JSON.stringify(d.localCache[R])!==JSON.stringify(L)&&(d.notifyListeners(R,L),_.push(R));for(const R of Object.keys(d.localCache))d.localCache[R]&&!I.has(R)&&(d.notifyListeners(R,null),_.push(R));return _})()}notifyListeners(d,p){this.localCache[d]=p;const _=this.listeners[d];if(_)for(const I of Array.from(_))I(p)}startPolling(){var d=this;this.stopPolling(),this.pollTimer=setInterval((0,T.Z)(function*(){return d._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(d,p){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[d]||(this.listeners[d]=new Set,this._get(d)),this.listeners[d].add(p)}_removeListener(d,p){this.listeners[d]&&(this.listeners[d].delete(p),0===this.listeners[d].size&&delete this.listeners[d]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return f.type="LOCAL",f})(),Aa=1e12;class _p{constructor(c){this.auth=c,this.counter=Aa,this._widgets=new Map}render(c,d){const p=this.counter;return this._widgets.set(p,new oy(c,this.auth.name,d||{})),this.counter++,p}reset(c){var d;const p=c||Aa;null===(d=this._widgets.get(p))||void 0===d||d.delete(),this._widgets.delete(p)}getResponse(c){var d;return(null===(d=this._widgets.get(c||Aa))||void 0===d?void 0:d.getResponse())||""}execute(c){var d=this;return(0,T.Z)(function*(){var p;return null===(p=d._widgets.get(c||Aa))||void 0===p||p.execute(),""})()}}class oy{constructor(c,d,p){this.params=p,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const _="string"==typeof c?document.getElementById(c):c;te(_,"argument-error",{appName:d}),this.container=_,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function ay(f){const c=[],d="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let p=0;p<f;p++)c.push(d.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":d}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,d)try{d()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ed=H_("rcb"),yp=new Tr(3e4,6e4);class vp{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=pt().grecaptcha)||void 0===c||!c.render)}load(c,d=""){return te(function cy(f){return f.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(f)}(d),c,"argument-error"),this.shouldResolveImmediately(d)&&In(pt().grecaptcha)?Promise.resolve(pt().grecaptcha):new Promise((p,_)=>{const I=pt().setTimeout(()=>{_(yt(c,"network-request-failed"))},yp.get());pt()[Ed]=()=>{pt().clearTimeout(I),delete pt()[Ed];const L=pt().grecaptcha;if(!L||!In(L))return void _(yt(c,"internal-error"));const X=L.render;L.render=(he,Ce)=>{const Xe=X(he,Ce);return this.counter++,Xe},this.hostLanguage=d,p(L)},Hf(`https://www.google.com/recaptcha/api.js??${(0,z.xO)({onload:Ed,render:"explicit",hl:d})}`).catch(()=>{clearTimeout(I),_(yt(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var d;return!(null===(d=pt().grecaptcha)||void 0===d||!d.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class m0{load(c){return(0,T.Z)(function*(){return new _p(c)})()}clearedOneInstance(){}}const Ip="recaptcha",$u={theme:"light",type:"image"};class Ep{constructor(c,d,p=Object.assign({},$u)){this.parameters=p,this.type=Ip,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=zt(c),this.isInvisible="invisible"===this.parameters.size,te(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const _="string"==typeof d?document.getElementById(d):d;te(_,this.auth,"argument-error"),this.container=_,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new m0:new vp,this.validateStartingState()}verify(){var c=this;return(0,T.Z)(function*(){c.assertNotDestroyed();const d=yield c.render(),p=c.getAssertedRecaptcha();return p.getResponse(d)||new Promise(I=>{const R=L=>{L&&(c.tokenChangeListeners.delete(R),I(L))};c.tokenChangeListeners.add(R),c.isInvisible&&p.execute(d)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){te(!this.parameters.sitekey,this.auth,"argument-error"),te(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),te(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return d=>{if(this.tokenChangeListeners.forEach(p=>p(d)),"function"==typeof c)c(d);else if("string"==typeof c){const p=pt()[c];"function"==typeof p&&p(d)}}}assertNotDestroyed(){te(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,T.Z)(function*(){if(yield c.init(),!c.widgetId){let d=c.container;if(!c.isInvisible){const p=document.createElement("div");d.appendChild(p),d=p}c.widgetId=c.getAssertedRecaptcha().render(d,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,T.Z)(function*(){te(Sn()&&!Vu(),c.auth,"internal-error"),yield function ly(){let f=null;return new Promise(c=>{"complete"!==document.readyState?(f=()=>c(),window.addEventListener("load",f)):c()}).catch(c=>{throw f&&window.removeEventListener("load",f),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const d=yield function dr(f){return ti.apply(this,arguments)}(c.auth);te(d,c.auth,"internal-error"),c.parameters.sitekey=d})()}getAssertedRecaptcha(){return te(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class wd{constructor(c,d){this.verificationId=c,this.onConfirmation=d}confirm(c){const d=rs._fromVerification(this.verificationId,c);return this.onConfirmation(d)}}function wp(f,c,d){return Hu.apply(this,arguments)}function Hu(){return(Hu=(0,T.Z)(function*(f,c,d){const p=zt(f),_=yield Sa(p,c,(0,z.m9)(d));return new wd(_,I=>Nu(p,I))})).apply(this,arguments)}function dy(f,c,d){return Ca.apply(this,arguments)}function Ca(){return(Ca=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f);yield Ru(!1,p,"phone");const _=yield Sa(p.auth,c,(0,z.m9)(d));return new wd(_,I=>id(p,I))})).apply(this,arguments)}function hy(f,c,d){return qr.apply(this,arguments)}function qr(){return(qr=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f),_=yield Sa(p.auth,c,(0,z.m9)(d));return new wd(_,I=>tp(p,I))})).apply(this,arguments)}function Sa(f,c,d){return zu.apply(this,arguments)}function zu(){return zu=(0,T.Z)(function*(f,c,d){var p;const _=yield d.verify();try{let I;if(te("string"==typeof _,f,"argument-error"),te(d.type===Ip,f,"argument-error"),I="string"==typeof c?{phoneNumber:c}:c,"session"in I){const R=I.session;if("phoneNumber"in I)return te("enroll"===R.type,f,"internal-error"),(yield function r0(f,c){return K(f,"POST","/v2/accounts/mfaEnrollment:start",k(f,c))}(f,{idToken:R.credential,phoneEnrollmentInfo:{phoneNumber:I.phoneNumber,recaptchaToken:_}})).phoneSessionInfo.sessionInfo;{te("signin"===R.type,f,"internal-error");const L=(null===(p=I.multiFactorHint)||void 0===p?void 0:p.uid)||I.multiFactorUid;return te(L,f,"missing-multi-factor-info"),(yield function iy(f,c){return K(f,"POST","/v2/accounts/mfaSignIn:start",k(f,c))}(f,{mfaPendingCredential:R.credential,mfaEnrollmentId:L,phoneSignInInfo:{recaptchaToken:_}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:R}=yield function K_(f,c){return Gl.apply(this,arguments)}(f,{phoneNumber:I.phoneNumber,recaptchaToken:_});return R}}finally{d._reset()}}),zu.apply(this,arguments)}function bt(f,c){return ba.apply(this,arguments)}function ba(){return(ba=(0,T.Z)(function*(f,c){yield bu((0,z.m9)(f),c)})).apply(this,arguments)}let qu=(()=>{class f{constructor(d){this.providerId=f.PROVIDER_ID,this.auth=zt(d)}verifyPhoneNumber(d,p){return Sa(this.auth,d,(0,z.m9)(p))}static credential(d,p){return rs._fromVerification(d,p)}static credentialFromResult(d){return f.credentialFromTaggedObject(d)}static credentialFromError(d){return f.credentialFromTaggedObject(d.customData||{})}static credentialFromTaggedObject({_tokenResponse:d}){if(!d)return null;const{phoneNumber:p,temporaryProof:_}=d;return p&&_?rs._fromTokenResponse(p,_):null}}return f.PROVIDER_ID="phone",f.PHONE_SIGN_IN_METHOD="phone",f})();function fn(f,c){return c?H(c):(te(f._popupRedirectResolver,f,"argument-error"),f._popupRedirectResolver)}class Td extends vo{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return ts(c,this._buildIdpRequest())}_linkToIdToken(c,d){return ts(c,this._buildIdpRequest(d))}_getReauthenticationResolver(c){return ts(c,this._buildIdpRequest())}_buildIdpRequest(c){const d={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(d.idToken=c),d}}function Tp(f){return ep(f.auth,new Td(f),f.bypassAuthState)}function No(f){const{auth:c,user:d}=f;return te(d,c,"internal-error"),Xf(d,new Td(f),f.bypassAuthState)}function Mr(f){return Dd.apply(this,arguments)}function Dd(){return(Dd=(0,T.Z)(function*(f){const{auth:c,user:d}=f;return te(d,c,"internal-error"),bu(d,new Td(f),f.bypassAuthState)})).apply(this,arguments)}class Dp{constructor(c,d,p,_,I=!1){this.auth=c,this.resolver=p,this.user=_,this.bypassAuthState=I,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(d)?d:[d]}execute(){var c=this;return new Promise(function(){var d=(0,T.Z)(function*(p,_){c.pendingPromise={resolve:p,reject:_};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(I){c.reject(I)}});return function(p,_){return d.apply(this,arguments)}}())}onAuthEvent(c){var d=this;return(0,T.Z)(function*(){const{urlResponse:p,sessionId:_,postBody:I,tenantId:R,error:L,type:X}=c;if(L)return void d.reject(L);const he={auth:d.auth,requestUri:p,sessionId:_,tenantId:R||void 0,postBody:I||void 0,user:d.user,bypassAuthState:d.bypassAuthState};try{d.resolve(yield d.getIdpTask(X)(he))}catch(Ce){d.reject(Ce)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return Tp;case"linkViaPopup":case"linkViaRedirect":return Mr;case"reauthViaPopup":case"reauthViaRedirect":return No;default:Ge(this.auth,"internal-error")}}resolve(c){Nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){Nt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const fy=new Tr(2e3,1e4);function cs(f,c,d){return Wu.apply(this,arguments)}function Wu(){return(Wu=(0,T.Z)(function*(f,c,d){const p=zt(f);dn(f,c,Li);const _=fn(p,d);return new Ad(p,"signInViaPopup",c,_).executeNotNull()})).apply(this,arguments)}function py(f,c,d){return Gu.apply(this,arguments)}function Gu(){return(Gu=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f);dn(p.auth,c,Li);const _=fn(p.auth,d);return new Ad(p.auth,"reauthViaPopup",c,_,p).executeNotNull()})).apply(this,arguments)}function Ap(f,c,d){return Zu.apply(this,arguments)}function Zu(){return(Zu=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f);dn(p.auth,c,Li);const _=fn(p.auth,d);return new Ad(p.auth,"linkViaPopup",c,_,p).executeNotNull()})).apply(this,arguments)}let Ad=(()=>{class f extends Dp{constructor(d,p,_,I,R){super(d,p,I,R),this.provider=_,this.authWindow=null,this.pollId=null,f.currentPopupAction&&f.currentPopupAction.cancel(),f.currentPopupAction=this}executeNotNull(){var d=this;return(0,T.Z)(function*(){const p=yield d.execute();return te(p,d.auth,"internal-error"),p})()}onExecution(){var d=this;return(0,T.Z)(function*(){Nt(1===d.filter.length,"Popup operations only handle one event");const p=on();d.authWindow=yield d.resolver._openPopup(d.auth,d.provider,d.filter[0],p),d.authWindow.associatedEvent=p,d.resolver._originValidation(d.auth).catch(_=>{d.reject(_)}),d.resolver._isIframeWebStorageSupported(d.auth,_=>{_||d.reject(yt(d.auth,"web-storage-unsupported"))}),d.pollUserCancellation()})()}get eventId(){var d;return(null===(d=this.authWindow)||void 0===d?void 0:d.associatedEvent)||null}cancel(){this.reject(yt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,f.currentPopupAction=null}pollUserCancellation(){const d=()=>{var p,_;this.pollId=null!==(_=null===(p=this.authWindow)||void 0===p?void 0:p.window)&&void 0!==_&&_.closed?window.setTimeout(()=>{this.pollId=null,this.reject(yt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(d,fy.get())};d()}}return f.currentPopupAction=null,f})();const Ne="pendingRedirect",xo=new Map;class _0 extends Dp{constructor(c,d,p=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],d,void 0,p),this.eventId=null}execute(){var c=()=>super.execute,d=this;return(0,T.Z)(function*(){let p=xo.get(d.auth._key());if(!p){try{const I=(yield function gy(f,c){return Cd.apply(this,arguments)}(d.resolver,d.auth))?yield c().call(d):null;p=()=>Promise.resolve(I)}catch(_){p=()=>Promise.reject(_)}xo.set(d.auth._key(),p)}return d.bypassAuthState||xo.set(d.auth._key(),()=>Promise.resolve(null)),p()})()}onAuthEvent(c){var d=()=>super.onAuthEvent,p=this;return(0,T.Z)(function*(){if("signInViaRedirect"===c.type)return d().call(p,c);if("unknown"!==c.type){if(c.eventId){const _=yield p.auth._redirectUserForId(c.eventId);if(_)return p.user=_,d().call(p,c);p.resolve(null)}}else p.resolve(null)})()}onExecution(){return(0,T.Z)(function*(){})()}cleanUp(){}}function Cd(){return(Cd=(0,T.Z)(function*(f,c){const d=bp(c),p=Sp(f);if(!(yield p._isAvailable()))return!1;const _="true"===(yield p._get(d));return yield p._remove(d),_})).apply(this,arguments)}function Sd(f,c){return Ku.apply(this,arguments)}function Ku(){return(Ku=(0,T.Z)(function*(f,c){return Sp(f)._set(bp(c),"true")})).apply(this,arguments)}function Mo(){xo.clear()}function Cp(f,c){xo.set(f._key(),c)}function Sp(f){return H(f._redirectPersistence)}function bp(f){return Pe(Ne,f.config.apiKey,f.name)}function my(f,c,d){return function _y(f,c,d){return Q.apply(this,arguments)}(f,c,d)}function Q(){return(Q=(0,T.Z)(function*(f,c,d){const p=zt(f);dn(f,c,Li),yield p._initializationPromise;const _=fn(p,d);return yield Sd(_,p),_._openRedirect(p,c,"signInViaRedirect")})).apply(this,arguments)}function ot(f,c,d){return function yy(f,c,d){return bd.apply(this,arguments)}(f,c,d)}function bd(){return(bd=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f);dn(p.auth,c,Li),yield p.auth._initializationPromise;const _=fn(p.auth,d);yield Sd(_,p.auth);const I=yield vy(p);return _._openRedirect(p.auth,c,"reauthViaRedirect",I)})).apply(this,arguments)}function Fn(f,c,d){return function Rp(f,c,d){return zs.apply(this,arguments)}(f,c,d)}function zs(){return(zs=(0,T.Z)(function*(f,c,d){const p=(0,z.m9)(f);dn(p.auth,c,Li),yield p.auth._initializationPromise;const _=fn(p.auth,d);yield Ru(!1,p,c.providerId),yield Sd(_,p.auth);const I=yield vy(p);return _._openRedirect(p.auth,c,"linkViaRedirect",I)})).apply(this,arguments)}function Si(f,c){return Ra.apply(this,arguments)}function Ra(){return(Ra=(0,T.Z)(function*(f,c){return yield zt(f)._initializationPromise,Pa(f,c,!1)})).apply(this,arguments)}function Pa(f,c){return Rd.apply(this,arguments)}function Rd(){return(Rd=(0,T.Z)(function*(f,c,d=!1){const p=zt(f),_=fn(p,c),R=yield new _0(p,_,d).execute();return R&&!d&&(delete R.user._redirectEventId,yield p._persistUserIfCurrent(R.user),yield p._setRedirectUser(null,c)),R})).apply(this,arguments)}function vy(f){return Qu.apply(this,arguments)}function Qu(){return(Qu=(0,T.Z)(function*(f){const c=on(`${f.uid}:::`);return f._redirectEventId=c,yield f.auth._setRedirectUser(f),yield f.auth._persistUserIfCurrent(f),c})).apply(this,arguments)}class bi{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let d=!1;return this.consumers.forEach(p=>{this.isEventForConsumer(c,p)&&(d=!0,this.sendToConsumer(c,p),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function ji(f){switch(f.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qs(f);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,d||(this.queuedRedirectEvent=c,d=!0)),d}sendToConsumer(c,d){var p;if(c.error&&!qs(c)){const _=(null===(p=c.error.code)||void 0===p?void 0:p.split("auth/")[1])||"internal-error";d.onError(yt(this.auth,_))}else d.onAuthEvent(c)}isEventForConsumer(c,d){const p=null===d.eventId||!!c.eventId&&c.eventId===d.eventId;return d.filter.includes(c.type)&&p}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pd(c))}saveEventToCache(c){this.cachedEventUids.add(Pd(c)),this.lastProcessedEventTime=Date.now()}}function Pd(f){return[f.type,f.eventId,f.sessionId,f.tenantId].filter(c=>c).join("-")}function qs({type:f,error:c}){return"unknown"===f&&"auth/no-auth-event"===c?.code}function Pp(f){return Yu.apply(this,arguments)}function Yu(){return(Yu=(0,T.Z)(function*(f,c={}){return K(f,"GET","/v1/projects",c)})).apply(this,arguments)}const Iy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ey=/^https?/;function Na(){return(Na=(0,T.Z)(function*(f){if(f.config.emulator)return;const{authorizedDomains:c}=yield Pp(f);for(const d of c)try{if(Np(d))return}catch{}Ge(f,"unauthorized-domain")})).apply(this,arguments)}function Np(f){const c=Yt(),{protocol:d,hostname:p}=new URL(c);if(f.startsWith("chrome-extension://")){const R=new URL(f);return""===R.hostname&&""===p?"chrome-extension:"===d&&f.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===d&&R.hostname===p}if(!Ey.test(d))return!1;if(Iy.test(f))return p===f;const _=f.replace(/\./g,"\\.");return new RegExp("^(.+\\."+_+"|"+_+")$","i").test(p)}const xd=new Tr(3e4,6e4);function xp(){const f=pt().___jsl;if(f?.H)for(const c of Object.keys(f.H))if(f.H[c].r=f.H[c].r||[],f.H[c].L=f.H[c].L||[],f.H[c].r=[...f.H[c].L],f.CP)for(let d=0;d<f.CP.length;d++)f.CP[d]=null}let Oo=null;const kp=new Tr(5e3,15e3),Fp="__/auth/iframe",Lp="emulator/auth/iframe",Md={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},wy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ty(f){const c=f.config;te(c.authDomain,f,"auth-domain-config-required");const d=c.emulator?gi(c,Lp):`https://${f.config.authDomain}/${Fp}`,p={apiKey:c.apiKey,appName:f.name,v:x.SDK_VERSION},_=wy.get(f.config.apiHost);_&&(p.eid=_);const I=f._getFrameworks();return I.length&&(p.fw=I.join(",")),`${d}?${(0,z.xO)(p).slice(1)}`}function $i(){return $i=(0,T.Z)(function*(f){const c=yield function Op(f){return Oo=Oo||function Mp(f){return new Promise((c,d)=>{var p,_,I;function R(){xp(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{xp(),d(yt(f,"network-request-failed"))},timeout:xd.get()})}if(null!==(_=null===(p=pt().gapi)||void 0===p?void 0:p.iframes)&&void 0!==_&&_.Iframe)c(gapi.iframes.getContext());else{if(null===(I=pt().gapi)||void 0===I||!I.load){const L=H_("iframefcb");return pt()[L]=()=>{gapi.load?R():d(yt(f,"network-request-failed"))},Hf(`https://apis.google.com/js/api.js?onload=${L}`).catch(X=>d(X))}R()}}).catch(c=>{throw Oo=null,c})}(f),Oo}(f),d=pt().gapi;return te(d,f,"internal-error"),c.open({where:document.body,url:Ty(f),messageHandlersFilter:d.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Md,dontclear:!0},p=>new Promise(function(){var _=(0,T.Z)(function*(I,R){yield p.restyle({setHideOnLeave:!1});const L=yt(f,"network-request-failed"),X=pt().setTimeout(()=>{R(L)},kp.get());function he(){pt().clearTimeout(X),I(p)}p.ping(he).then(he,()=>{R(L)})});return function(I,R){return _.apply(this,arguments)}}()))}),$i.apply(this,arguments)}const Wt={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Od{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const ls="__/auth/handler",by="emulator/auth/handler",Xu=encodeURIComponent("fac");function ko(f,c,d,p,_,I){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,T.Z)(function*(f,c,d,p,_,I){te(f.config.authDomain,f,"auth-domain-config-required"),te(f.config.apiKey,f,"invalid-api-key");const R={apiKey:f.config.apiKey,appName:f.name,authType:d,redirectUrl:p,v:x.SDK_VERSION,eventId:_};if(c instanceof Li){c.setDefaultLanguage(f.languageCode),R.providerId=c.providerId||"",(0,z.xb)(c.getCustomParameters())||(R.customParameters=JSON.stringify(c.getCustomParameters()));for(const[Ce,Xe]of Object.entries(I||{}))R[Ce]=Xe}if(c instanceof wo){const Ce=c.getScopes().filter(Xe=>""!==Xe);Ce.length>0&&(R.scopes=Ce.join(","))}f.tenantId&&(R.tid=f.tenantId);const L=R;for(const Ce of Object.keys(L))void 0===L[Ce]&&delete L[Ce];const X=yield f._getAppCheckToken(),he=X?`#${Xu}=${encodeURIComponent(X)}`:"";return`${function kd({config:f}){return f.emulator?gi(f,by):`https://${f.authDomain}/${ls}`}(f)}?${(0,z.xO)(L).slice(1)}${he}`})).apply(this,arguments)}const ec="webStorageSupport",Bp=class Up{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ci,this._completeRedirectFn=Pa,this._overrideRedirectResult=Cp}_openPopup(c,d,p,_){var I=this;return(0,T.Z)(function*(){var R;Nt(null===(R=I.eventManagers[c._key()])||void 0===R?void 0:R.manager,"_initialize() not called before _openPopup()");const L=yield ko(c,d,p,Yt(),_);return function Vp(f,c,d,p=500,_=600){const I=Math.max((window.screen.availHeight-_)/2,0).toString(),R=Math.max((window.screen.availWidth-p)/2,0).toString();let L="";const X=Object.assign(Object.assign({},Wt),{width:p.toString(),height:_.toString(),top:I,left:R}),he=(0,z.z$)().toLowerCase();d&&(L=bn(he)?"_blank":d),Et(he)&&(c=c||"http://localhost",X.scrollbars="yes");const Ce=Object.entries(X).reduce((ir,[Hi,ka])=>`${ir}${Hi}=${ka},`,"");if(function ze(f=(0,z.z$)()){var c;return _e(f)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(he)&&"_self"!==L)return function Ju(f,c){const d=document.createElement("a");d.href=f,d.target=c;const p=document.createEvent("MouseEvent");p.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),d.dispatchEvent(p)}(c||"",L),new Od(null);const Xe=window.open(c||"",L,Ce);te(Xe,f,"popup-blocked");try{Xe.focus()}catch{}return new Od(Xe)}(c,L,on())})()}_openRedirect(c,d,p,_){var I=this;return(0,T.Z)(function*(){return yield I._originValidation(c),function dp(f){pt().location.href=f}(yield ko(c,d,p,Yt(),_)),new Promise(()=>{})})()}_initialize(c){const d=c._key();if(this.eventManagers[d]){const{manager:_,promise:I}=this.eventManagers[d];return _?Promise.resolve(_):(Nt(I,"If manager is not set, promise should be"),I)}const p=this.initAndGetManager(c);return this.eventManagers[d]={promise:p},p.catch(()=>{delete this.eventManagers[d]}),p}initAndGetManager(c){var d=this;return(0,T.Z)(function*(){const p=yield function rr(f){return $i.apply(this,arguments)}(c),_=new bi(c);return p.register("authEvent",I=>(te(I?.authEvent,c,"invalid-auth-event"),{status:_.onEvent(I.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),d.eventManagers[c._key()]={manager:_},d.iframes[c._key()]=p,_})()}_isIframeWebStorageSupported(c,d){this.iframes[c._key()].send(ec,{type:ec},_=>{var I;const R=null===(I=_?.[0])||void 0===I?void 0:I[ec];void 0!==R&&d(!!R),Ge(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const d=c._key();return this.originValidationPromises[d]||(this.originValidationPromises[d]=function Nd(f){return Na.apply(this,arguments)}(c)),this.originValidationPromises[d]}get _shouldInitProactively(){return rn()||Ee()||_e()}};class Lo{constructor(c){this.factorId=c}_process(c,d,p){switch(d.type){case"enroll":return this._finalizeEnroll(c,d.credential,p);case"signin":return this._finalizeSignIn(c,d.credential);default:return et("unexpected MultiFactorSessionType")}}}class Ws extends Lo{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new Ws(c)}_finalizeEnroll(c,d,p){return function s0(f,c){return K(f,"POST","/v2/accounts/mfaEnrollment:finalize",k(f,c))}(c,{idToken:d,displayName:p,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,d){return function Id(f,c){return K(f,"POST","/v2/accounts/mfaSignIn:finalize",k(f,c))}(c,{mfaPendingCredential:d,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Ry=(()=>{class f{constructor(){}static assertion(d){return Ws._fromCredential(d)}}return f.FACTOR_ID="phone",f})();var jp="@firebase/auth";class y0{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var d=this;return(0,T.Z)(function*(){return d.assertAuthConfigured(),yield d.auth._initializationPromise,d.auth.currentUser?{accessToken:yield d.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const d=this.auth.onIdTokenChanged(p=>{c(p?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,d),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const d=this.internalListeners.get(c);d&&(this.internalListeners.delete(c),d(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,z.Pz)("authIdTokenMaxAge"),function Ma(f){(0,x._registerComponent)(new Bt.wA("auth",(c,{options:d})=>{const p=c.getProvider("app").getImmediate(),_=c.getProvider("heartbeat"),I=c.getProvider("app-check-internal"),{apiKey:R,authDomain:L}=p.options;te(R&&!R.includes(":"),"invalid-api-key",{appName:p.name});const X={apiKey:R,authDomain:L,clientPlatform:f,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:We(f)},he=new GD(p,_,I,X);return function ft(f,c){const d=c?.persistence||[],p=(Array.isArray(d)?d:[d]).map(H);c?.errorMap&&f._updateErrorMap(c.errorMap),f._initializeWithPersistence(p,c?.popupRedirectResolver)}(he,d),he},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,d,p)=>{c.getProvider("auth-internal").initialize()})),(0,x._registerComponent)(new Bt.wA("auth-internal",c=>{const d=zt(c.getProvider("auth").getImmediate());return new y0(d)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,x.registerVersion)(jp,"1.4.0",function Fd(f){switch(f){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(f)),(0,x.registerVersion)(jp,"1.4.0","esm2017")}("Browser")},58:(fi,yn,Se)=>{Se.d(yn,{BH:()=>wr,G6:()=>gi,L:()=>rt,LL:()=>Y,P0:()=>jt,Pz:()=>yt,Sg:()=>dn,UG:()=>et,ZB:()=>Ie,ZR:()=>K,aH:()=>Ge,b$:()=>Sn,eu:()=>j,hl:()=>U,jU:()=>Nt,m9:()=>Ei,ne:()=>Dr,pd:()=>ri,r3:()=>En,ru:()=>Yt,tV:()=>G,uI:()=>te,vZ:()=>mi,w1:()=>ei,xO:()=>yi,xb:()=>dr,z$:()=>je,zd:()=>ni});const ve=function(S){const A=[];let E=0;for(let w=0;w<S.length;w++){let v=S.charCodeAt(w);v<128?A[E++]=v:v<2048?(A[E++]=v>>6|192,A[E++]=63&v|128):55296==(64512&v)&&w+1<S.length&&56320==(64512&S.charCodeAt(w+1))?(v=65536+((1023&v)<<10)+(1023&S.charCodeAt(++w)),A[E++]=v>>18|240,A[E++]=v>>12&63|128,A[E++]=v>>6&63|128,A[E++]=63&v|128):(A[E++]=v>>12|224,A[E++]=v>>6&63|128,A[E++]=63&v|128)}return A},Bt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(S,A){if(!Array.isArray(S))throw Error("encodeByteArray takes an array as a parameter");this.init_();const E=A?this.byteToCharMapWebSafe_:this.byteToCharMap_,w=[];for(let v=0;v<S.length;v+=3){const M=S[v],H=v+1<S.length,fe=H?S[v+1]:0,Ae=v+2<S.length,Pe=Ae?S[v+2]:0;let Et=(15&fe)<<2|Pe>>6,Ee=63&Pe;Ae||(Ee=64,H||(Et=64)),w.push(E[M>>2],E[(3&M)<<4|fe>>4],E[Et],E[Ee])}return w.join("")},encodeString(S,A){return this.HAS_NATIVE_SUPPORT&&!A?btoa(S):this.encodeByteArray(ve(S),A)},decodeString(S,A){return this.HAS_NATIVE_SUPPORT&&!A?atob(S):function(S){const A=[];let E=0,w=0;for(;E<S.length;){const v=S[E++];if(v<128)A[w++]=String.fromCharCode(v);else if(v>191&&v<224){const M=S[E++];A[w++]=String.fromCharCode((31&v)<<6|63&M)}else if(v>239&&v<365){const Ae=((7&v)<<18|(63&S[E++])<<12|(63&S[E++])<<6|63&S[E++])-65536;A[w++]=String.fromCharCode(55296+(Ae>>10)),A[w++]=String.fromCharCode(56320+(1023&Ae))}else{const M=S[E++],H=S[E++];A[w++]=String.fromCharCode((15&v)<<12|(63&M)<<6|63&H)}}return A.join("")}(this.decodeStringToByteArray(S,A))},decodeStringToByteArray(S,A){this.init_();const E=A?this.charToByteMapWebSafe_:this.charToByteMap_,w=[];for(let v=0;v<S.length;){const M=E[S.charAt(v++)],fe=v<S.length?E[S.charAt(v)]:0;++v;const Pe=v<S.length?E[S.charAt(v)]:64;++v;const ue=v<S.length?E[S.charAt(v)]:64;if(++v,null==M||null==fe||null==Pe||null==ue)throw new tn;w.push(M<<2|fe>>4),64!==Pe&&(w.push(fe<<4&240|Pe>>2),64!==ue&&w.push(Pe<<6&192|ue))}return w},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let S=0;S<this.ENCODED_VALS.length;S++)this.byteToCharMap_[S]=this.ENCODED_VALS.charAt(S),this.charToByteMap_[this.byteToCharMap_[S]]=S,this.byteToCharMapWebSafe_[S]=this.ENCODED_VALS_WEBSAFE.charAt(S),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[S]]=S,S>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(S)]=S,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(S)]=S)}}};class tn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rt=function(S){return function(S){const A=ve(S);return Bt.encodeByteArray(A,!0)}(S).replace(/\./g,"")},G=function(S){try{return Bt.decodeString(S,!0)}catch(A){console.error("base64Decode failed: ",A)}return null};function Ie(S,A){if(!(A instanceof Object))return A;switch(A.constructor){case Date:return new Date(A.getTime());case Object:void 0===S&&(S={});break;case Array:S=[];break;default:return A}for(const E in A)!A.hasOwnProperty(E)||!Le(E)||(S[E]=Ie(S[E],A[E]));return S}function Le(S){return"__proto__"!==S}const Me=()=>{try{return function ut(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const S=process.env.__FIREBASE_DEFAULTS__;return S?JSON.parse(S):void 0})()||(()=>{if(typeof document>"u")return;let S;try{S=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const A=S&&G(S[1]);return A&&JSON.parse(A)})()}catch(S){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${S}`)}},jt=S=>{const A=(S=>{var A,E;return null===(E=null===(A=Me())||void 0===A?void 0:A.emulatorHosts)||void 0===E?void 0:E[S]})(S);if(!A)return;const E=A.lastIndexOf(":");if(E<=0||E+1===A.length)throw new Error(`Invalid host ${A} with no separate hostname and port!`);const w=parseInt(A.substring(E+1),10);return"["===A[0]?[A.substring(1,E-1),w]:[A.substring(0,E),w]},Ge=()=>{var S;return null===(S=Me())||void 0===S?void 0:S.config},yt=S=>{var A;return null===(A=Me())||void 0===A?void 0:A[`_${S}`]};class wr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((A,E)=>{this.resolve=A,this.reject=E})}wrapCallback(A){return(E,w)=>{E?this.reject(E):this.resolve(w),"function"==typeof A&&(this.promise.catch(()=>{}),1===A.length?A(E):A(E,w))}}}function dn(S,A){if(S.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const w=A||"demo-project",v=S.iat||0,M=S.sub||S.user_id;if(!M)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const H=Object.assign({iss:`https://securetoken.google.com/${w}`,aud:w,iat:v,exp:v+3600,auth_time:v,sub:M,user_id:M,firebase:{sign_in_provider:"custom",identities:{}}},S);return[rt(JSON.stringify({alg:"none",type:"JWT"})),rt(JSON.stringify(H)),""].join(".")}function je(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function te(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(je())}function et(){var S;const A=null===(S=Me())||void 0===S?void 0:S.forceEnvironment;if("node"===A)return!0;if("browser"===A)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Nt(){return"object"==typeof self&&self.self===self}function Yt(){const S="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof S&&void 0!==S.id}function Sn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ei(){const S=je();return S.indexOf("MSIE ")>=0||S.indexOf("Trident/")>=0}function gi(){return!et()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U(){try{return"object"==typeof indexedDB}catch{return!1}}function j(){return new Promise((S,A)=>{try{let E=!0;const w="validate-browser-context-for-indexeddb-analytics-module",v=self.indexedDB.open(w);v.onsuccess=()=>{v.result.close(),E||self.indexedDB.deleteDatabase(w),S(!0)},v.onupgradeneeded=()=>{E=!1},v.onerror=()=>{var M;A((null===(M=v.error)||void 0===M?void 0:M.message)||"")}}catch(E){A(E)}})}class K extends Error{constructor(A,E,w){super(E),this.code=A,this.customData=w,this.name="FirebaseError",Object.setPrototypeOf(this,K.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Y.prototype.create)}}class Y{constructor(A,E,w){this.service=A,this.serviceName=E,this.errors=w}create(A,...E){const w=E[0]||{},v=`${this.service}/${A}`,M=this.errors[A],H=M?function de(S,A){return S.replace(qe,(E,w)=>{const v=A[w];return null!=v?String(v):`<${w}?>`})}(M,w):"Error";return new K(v,`${this.serviceName}: ${H} (${v}).`,w)}}const qe=/\{\$([^}]+)}/g;function En(S,A){return Object.prototype.hasOwnProperty.call(S,A)}function dr(S){for(const A in S)if(Object.prototype.hasOwnProperty.call(S,A))return!1;return!0}function mi(S,A){if(S===A)return!0;const E=Object.keys(S),w=Object.keys(A);for(const v of E){if(!w.includes(v))return!1;const M=S[v],H=A[v];if(mt(M)&&mt(H)){if(!mi(M,H))return!1}else if(M!==H)return!1}for(const v of w)if(!E.includes(v))return!1;return!0}function mt(S){return null!==S&&"object"==typeof S}function yi(S){const A=[];for(const[E,w]of Object.entries(S))Array.isArray(w)?w.forEach(v=>{A.push(encodeURIComponent(E)+"="+encodeURIComponent(v))}):A.push(encodeURIComponent(E)+"="+encodeURIComponent(w));return A.length?"&"+A.join("&"):""}function ni(S){const A={};return S.replace(/^\?/,"").split("&").forEach(w=>{if(w){const[v,M]=w.split("=");A[decodeURIComponent(v)]=decodeURIComponent(M)}}),A}function ri(S){const A=S.indexOf("?");if(!A)return"";const E=S.indexOf("#",A);return S.substring(A,E>0?E:void 0)}function Dr(S,A){const E=new Ar(S,A);return E.subscribe.bind(E)}class Ar{constructor(A,E){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=E,this.task.then(()=>{A(this)}).catch(w=>{this.error(w)})}next(A){this.forEachObserver(E=>{E.next(A)})}error(A){this.forEachObserver(E=>{E.error(A)}),this.close(A)}complete(){this.forEachObserver(A=>{A.complete()}),this.close()}subscribe(A,E,w){let v;if(void 0===A&&void 0===E&&void 0===w)throw new Error("Missing Observer.");v=function xn(S,A){if("object"!=typeof S||null===S)return!1;for(const E of A)if(E in S&&"function"==typeof S[E])return!0;return!1}(A,["next","error","complete"])?A:{next:A,error:E,complete:w},void 0===v.next&&(v.next=hr),void 0===v.error&&(v.error=hr),void 0===v.complete&&(v.complete=hr);const M=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?v.error(this.finalError):v.complete()}catch{}}),this.observers.push(v),M}unsubscribeOne(A){void 0===this.observers||void 0===this.observers[A]||(delete this.observers[A],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(A){if(!this.finalized)for(let E=0;E<this.observers.length;E++)this.sendOne(E,A)}sendOne(A,E){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[A])try{E(this.observers[A])}catch(w){typeof console<"u"&&console.error&&console.error(w)}})}close(A){this.finalized||(this.finalized=!0,void 0!==A&&(this.finalError=A),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hr(){}function Ei(S){return S&&S._delegate?S._delegate:S}},673:(fi,yn,Se)=>{function T(t){return"function"==typeof t}function z(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const x=z(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function ve(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class gt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(T(r))try{r()}catch(s){e=s instanceof x?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{St(s)}catch(o){e=e??[],o instanceof x?e=[...e,...o.errors]:e.push(o)}}if(e)throw new x(e)}}add(e){var n;if(e&&e!==this)if(this.closed)St(e);else{if(e instanceof gt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&ve(n,e)}remove(e){const{_finalizers:n}=this;n&&ve(n,e),e instanceof gt&&e._removeParent(this)}}gt.EMPTY=(()=>{const t=new gt;return t.closed=!0,t})();const Bt=gt.EMPTY;function tn(t){return t instanceof gt||t&&"closed"in t&&T(t.remove)&&T(t.add)&&T(t.unsubscribe)}function St(t){T(t)?t():t.unsubscribe()}const rt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},G={setTimeout(t,e,...n){const{delegate:r}=G;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=G;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function re(t){G.setTimeout(()=>{const{onUnhandledError:e}=rt;if(!e)throw t;e(t)})}function Ie(){}const Le=Ye("C",void 0,void 0);function Ye(t,e,n){return{kind:t,value:e,error:n}}let xe=null;function Me(t){if(rt.useDeprecatedSynchronousErrorHandling){const e=!xe;if(e&&(xe={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=xe;if(xe=null,n)throw r}}else t()}class jt extends gt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,tn(e)&&e.add(this)):this.destination=Nt}static create(e,n,r){return new dn(e,n,r)}next(e){this.isStopped?et(function vn(t){return Ye("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?et(function ut(t){return Ye("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?et(Le,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ge=Function.prototype.bind;function yt(t,e){return Ge.call(t,e)}class wr{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){je(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){je(r)}else je(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){je(n)}}}class dn extends jt{constructor(e,n,r){let i;if(super(),T(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&rt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&yt(e.next,s),error:e.error&&yt(e.error,s),complete:e.complete&&yt(e.complete,s)}):i=e}this.destination=new wr(i)}}function je(t){rt.useDeprecatedSynchronousErrorHandling?function Cn(t){rt.useDeprecatedSynchronousErrorHandling&&xe&&(xe.errorThrown=!0,xe.error=t)}(t):re(t)}function et(t,e){const{onStoppedNotification:n}=rt;n&&G.setTimeout(()=>n(t,e))}const Nt={closed:!0,next:Ie,error:function te(t){throw t},complete:Ie},Yt="function"==typeof Symbol&&Symbol.observable||"@@observable";function Sn(t){return t}let tt=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){const s=function U(t){return t&&t instanceof jt||function gi(t){return t&&T(t.next)&&T(t.error)&&T(t.complete)}(t)&&tn(t)}(n)?n:new dn(n,r,i);return Me(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=Tr(r))((i,s)=>{const o=new dn({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[Yt](){return this}pipe(...n){return function ei(t){return 0===t.length?Sn:1===t.length?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}(n)(this)}toPromise(n){return new(n=Tr(n))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Tr(t){var e;return null!==(e=t??rt.Promise)&&void 0!==e?e:Promise}const j=z(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let q=(()=>{class t extends tt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new k(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new j}next(n){Me(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Me(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Me(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:i,observers:s}=this;return r||i?Bt:(this.currentObservers=null,s.push(n),new gt(()=>{this.currentObservers=null,ve(s,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){const n=new tt;return n.source=this,n}}return t.create=(e,n)=>new k(e,n),t})();class k extends q{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:Bt}}function Y(t){return e=>{if(function K(t){return T(t?.lift)}(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function de(t,e,n,r,i){return new qe(t,e,n,r,i)}class qe extends jt{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Ve(t,e){return Y((n,r)=>{let i=0;n.subscribe(de(r,s=>{r.next(t.call(e,s,i++))}))})}var De=Se(582);const it=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Mt(t){return T(t?.then)}function Tt(t){return T(t[Yt])}function $t(t){return Symbol.asyncIterator&&T(t?.[Symbol.asyncIterator])}function In(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Nn=function En(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function dr(t){return T(t?.[Nn])}function ti(t){return(0,De.FC)(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:i}=yield(0,De.qq)(n.read());if(i)return yield(0,De.qq)(void 0);yield yield(0,De.qq)(r)}}finally{n.releaseLock()}})}function mi(t){return T(t?.getReader)}function mt(t){if(t instanceof tt)return t;if(null!=t){if(Tt(t))return function _i(t){return new tt(e=>{const n=t[Yt]();if(T(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(it(t))return function yi(t){return new tt(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(Mt(t))return function ni(t){return new tt(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,re)})}(t);if($t(t))return $n(t);if(dr(t))return function ri(t){return new tt(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(mi(t))return function Dr(t){return $n(ti(t))}(t)}throw In(t)}function $n(t){return new tt(e=>{(function Ar(t,e){var n,r,i,s;return(0,De.mG)(this,void 0,void 0,function*(){try{for(n=(0,De.KL)(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function Hr(t,e,n,r=0,i=!1){const s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function hr(t,e,n=1/0){return T(e)?hr((r,i)=>Ve((s,o)=>e(r,s,i,o))(mt(t(r,i))),n):("number"==typeof e&&(n=e),Y((r,i)=>function xn(t,e,n,r,i,s,o,a){const u=[];let l=0,h=0,g=!1;const m=()=>{g&&!u.length&&!l&&e.complete()},y=C=>l<r?D(C):u.push(C),D=C=>{s&&e.next(C),l++;let b=!1;mt(n(C,h++)).subscribe(de(e,F=>{i?.(F),s?y(F):e.next(F)},()=>{b=!0},void 0,()=>{if(b)try{for(l--;u.length&&l<r;){const F=u.shift();o?Hr(e,o,()=>D(F)):D(F)}m()}catch(F){e.error(F)}}))};return t.subscribe(de(e,y,()=>{g=!0,m()})),()=>{a?.()}}(r,i,t,n)))}function Fi(t=1/0){return hr(Sn,t)}const fr=new tt(t=>t.complete());function vi(t){return t[t.length-1]}function Ii(t){return function nn(t){return t&&T(t.schedule)}(vi(t))?t.pop():void 0}function hn(t,e=0){return Y((n,r)=>{n.subscribe(de(r,i=>Hr(r,t,()=>r.next(i),e),()=>Hr(r,t,()=>r.complete(),e),i=>Hr(r,t,()=>r.error(i),e)))})}function Hn(t,e=0){return Y((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function Ei(t,e){if(!t)throw new Error("Iterable cannot be null");return new tt(n=>{Hr(n,e,()=>{const r=t[Symbol.asyncIterator]();Hr(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function E(t,e){return e?function A(t,e){if(null!=t){if(Tt(t))return function Cr(t,e){return mt(t).pipe(Hn(e),hn(e))}(t,e);if(it(t))return function es(t,e){return new tt(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(Mt(t))return function yo(t,e){return mt(t).pipe(Hn(e),hn(e))}(t,e);if($t(t))return Ei(t,e);if(dr(t))return function Ps(t,e){return new tt(n=>{let r;return Hr(n,e,()=>{r=t[Nn](),Hr(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void n.error(o)}s?n.complete():n.next(i)},0,!0)}),()=>T(r?.return)&&r.return()})}(t,e);if(mi(t))return function S(t,e){return Ei(ti(t),e)}(t,e)}throw In(t)}(t,e):mt(t)}function w(...t){const e=Ii(t),n=function wn(t,e){return"number"==typeof vi(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?mt(r[0]):Fi(n)(E(r,e)):fr}class v extends q{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function M(...t){return E(t,Ii(t))}function H(t={}){const{connector:e=(()=>new q),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,l=0,h=!1,g=!1;const m=()=>{a?.unsubscribe(),a=void 0},y=()=>{m(),o=u=void 0,h=g=!1},D=()=>{const C=o;y(),C?.unsubscribe()};return Y((C,b)=>{l++,!g&&!h&&m();const F=u=u??e();b.add(()=>{l--,0===l&&!g&&!h&&(a=fe(D,i))}),F.subscribe(b),!o&&l>0&&(o=new dn({next:N=>F.next(N),error:N=>{g=!0,m(),a=fe(y,n,N),F.error(N)},complete:()=>{h=!0,m(),a=fe(y,r),F.complete()}}),mt(C).subscribe(o))})(s)}}function fe(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new dn({next:()=>{r.unsubscribe(),t()}});return mt(e(...n)).subscribe(r)}function Ae(t,e){return Y((n,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();n.subscribe(de(r,u=>{i?.unsubscribe();let l=0;const h=s++;mt(t(u,h)).subscribe(i=de(r,g=>r.next(e?e(u,g,h,l++):g),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Pe(t,e=Sn){return t=t??st,Y((n,r)=>{let i,s=!0;n.subscribe(de(r,o=>{const a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function st(t,e){return t===e}function ue(t){for(let e in t)if(t[e]===ue)return e;throw Error("Could not find renamed property on target object.")}function Ee(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ee).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function bn(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Ns=ue({__forward_ref__:ue});function $(t){return t.__forward_ref__=$,t.toString=function(){return Ee(this())},t}function P(t){return function ee(t){return"function"==typeof t&&t.hasOwnProperty(Ns)&&t.__forward_ref__===$}(t)?t():t}function _e(t){return t&&!!t.\u0275providers}class ie extends Error{constructor(e,n){super(function rn(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function We(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():function me(t){return"string"==typeof t?t:null==t?"":String(t)}(t)}function Vl(t,e){throw new ie(-201,!1)}function zn(t,e){null==t&&function Re(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function ft(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Ms(t){return{providers:t.providers||[],imports:t.imports||[]}}function _u(t){return Gf(t,Io)||Gf(t,yu)}function Gf(t,e){return t.hasOwnProperty(e)?t[e]:null}function ga(t){return t&&(t.hasOwnProperty(Ul)||t.hasOwnProperty(Z_))?t[Ul]:null}const Io=ue({\u0275prov:ue}),Ul=ue({\u0275inj:ue}),yu=ue({ngInjectableDef:ue}),Z_=ue({ngInjectorDef:ue});var Ze=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(Ze||{});let Bl;function pr(t){const e=Bl;return Bl=t,e}function Iu(t,e,n){const r=_u(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Ze.Optional?null:void 0!==e?e:void Vl(Ee(t))}const wt=globalThis;class ye{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ft({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Os={},Wl="__NG_DI_FLAG__",br="ngTempTokenPath",Gl=/\n/gm,Tu="__source";let Eo;function ns(t){const e=Eo;return Eo=t,e}function Y_(t,e=Ze.Default){if(void 0===Eo)throw new ie(-203,!1);return null===Eo?Iu(t,void 0,e):Eo.get(t,e&Ze.Optional?null:void 0,e)}function pe(t,e=Ze.Default){return(function vu(){return Bl}()||Y_)(P(t),e)}function _t(t,e=Ze.Default){return pe(t,Du(e))}function Du(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function ks(t){const e=[];for(let n=0;n<t.length;n++){const r=P(t[n]);if(Array.isArray(r)){if(0===r.length)throw new ie(900,!1);let i,s=Ze.Default;for(let o=0;o<r.length;o++){const a=r[o],u=Kl(a);"number"==typeof u?-1===u?i=a.token:s|=u:i=a}e.push(pe(i,s))}else e.push(pe(r))}return e}function Au(t,e){return t[Wl]=e,t.prototype[Wl]=e,t}function Kl(t){return t[Wl]}function Rr(t){return{toString:t}.toString()}var Cu=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Cu||{}),ii=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(ii||{});const wi={},ct=[],Vi=ue({\u0275cmp:ue}),Ql=ue({\u0275dir:ue}),To=ue({\u0275pipe:ue}),Ti=ue({\u0275fac:ue}),Fs=ue({__NG_ELEMENT_ID__:ue}),Pr=ue({__NG_ENV_ID__:ue});function Yl(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Jl(t,e,n){let r=0;for(;r<n.length;){const i=n[r];if("number"==typeof i){if(0!==i)break;r++;const s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{const s=i,o=n[++r];_a(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function Su(t){return 3===t||4===t||6===t}function _a(t){return 64===t.charCodeAt(0)}function Do(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||Xl(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function Xl(t,e,n,r,i){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==i&&(t[s+1]=i));if(r===t[s+1])return void(t[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==r&&t.splice(s++,0,r),null!==i&&t.splice(s++,0,i)}const Jf="ng-template";function ed(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if("string"==typeof s&&i){const o=t[r++];if(n&&"class"===s&&-1!==Yl(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<t.length&&"string"==typeof(s=t[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function bu(t){return 4===t.type&&t.value!==Jf}function td(t,e,n){return e===(4!==t.type||n?t.value:Jf)}function Ru(t,e,n){let r=4;const i=t.attrs||[],s=function nd(t){for(let e=0;e<t.length;e++)if(Su(t[e]))return e;return t.length}(i);let o=!1;for(let a=0;a<e.length;a++){const u=e[a];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!td(t,u,n)||""===u&&1===e.length){if(Nr(r))return!1;o=!0}}else{const l=8&r?u:e[++a];if(8&r&&null!==t.attrs){if(!ed(t.attrs,l,n)){if(Nr(r))return!1;o=!0}continue}const g=Xf(8&r?"class":u,i,bu(t),n);if(-1===g){if(Nr(r))return!1;o=!0;continue}if(""!==l){let m;m=g>s?"":i[g+1].toLowerCase();const y=8&r?m:null;if(y&&-1!==Yl(y,l,0)||2&r&&l!==m){if(Nr(r))return!1;o=!0}}}}else{if(!o&&!Nr(r)&&!Nr(u))return!1;if(o&&Nr(u))continue;o=!1,r=u|1&r}}return Nr(r)||o}function Nr(t){return 0==(1&t)}function Xf(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){const o=e[i];if(o===t)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function Nu(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function Pu(t,e,n=!1){for(let r=0;r<e.length;r++)if(Ru(t,e[r],n))return!0;return!1}function id(t,e){return t?":not("+e.trim()+")":e}function sd(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&r){const a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!Nr(o)&&(e+=id(s,i),i=""),r=o,s=s||!Nr(r);n++}return""!==i&&(e+=id(s,i)),e}function ad(t){return Rr(()=>{const e=function np(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||wi,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||ct,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:xu(t.inputs,e),outputs:xu(t.outputs)}}(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Cu.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||ii.Emulated,styles:t.styles||ct,_:null,schemas:t.schemas||null,tView:null,id:""};!function Mu(t){t.features?.forEach(e=>e(t))}(n);const r=t.dependencies;return n.directiveDefs=va(r,!1),n.pipeDefs=va(r,!0),n.id=function X_(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(n),n})}function J_(t){return Je(t)||Mn(t)}function cd(t){return null!==t}function Ui(t){return Rr(()=>({type:t.type,bootstrap:t.bootstrap||ct,declarations:t.declarations||ct,imports:t.imports||ct,exports:t.exports||ct,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function xu(t,e){if(null==t)return wi;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),n[i]=r,e&&(e[i]=s)}return n}function Je(t){return t[Vi]||null}function Mn(t){return t[Ql]||null}function On(t){return t[To]||null}function va(t,e){if(!t)return null;const n=e?On:J_;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(cd)}const Ot=0,ce=1,Oe=2,kt=3,si=4,Ls=5,Wn=6,Ao=7,qt=8,is=9,ss=10,ke=11,Vs=12,rp=13,os=14,sn=15,Us=16,Co=17,zr=18,Ia=19,Ou=20,as=21,Bi=22,So=23,Bs=24,Ke=25,ku=1,ip=2,Di=7,bo=9,Gn=11;function xr(t){return Array.isArray(t)&&"object"==typeof t[ku]}function kn(t){return Array.isArray(t)&&!0===t[ku]}function hd(t){return 0!=(4&t.flags)}function js(t){return t.componentOffset>-1}function Ai(t){return!!t.template}function sp(t){return 0!=(512&t[Oe])}function Ro(t,e){return t.hasOwnProperty(Ti)?t[Ti]:null}let on=null,Lu=!1;function pt(t){const e=on;return on=t,e}const dp={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function hp(t){if(!Da(t)||t.dirty){if(!t.producerMustRecompute(t)&&!Ta(t))return void(t.dirty=!1);t.producerRecomputeValue(t),t.dirty=!1}}function fp(t){t.dirty=!0,function Uu(t){if(void 0===t.liveConsumerNode)return;const e=Lu;Lu=!0;try{for(const n of t.liveConsumerNode)n.dirty||fp(n)}finally{Lu=e}}(t),t.consumerMarkedDirty?.(t)}function Bu(t){return t&&(t.nextProducerIndex=0),pt(t)}function _d(t,e){if(pt(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(Da(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Hs(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Ta(t){us(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(hp(n),r!==n.version))return!0}return!1}function yd(t){if(us(t),Da(t))for(let e=0;e<t.producerNode.length;e++)Hs(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Hs(t,e){if(function vd(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),us(t),1===t.liveConsumerNode.length)for(let r=0;r<t.producerNode.length;r++)Hs(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];us(i),i.producerIndexOfThis[r]=e}}function Da(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function us(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let ry=null;const vp=()=>{},cy=(()=>({...dp,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule(t.ref)},hasRun:!1,cleanupFn:vp}))();class Ip{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Ep(t){return t.type.prototype.ngOnChanges&&(t.setInput=wd),ly}function ly(){const t=Hu(this),e=t?.current;if(e){const n=t.previous;if(n===wi)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function wd(t,e,n,r){const i=this.declaredInputs[n],s=Hu(t)||function dy(t,e){return t[wp]=e}(t,{previous:wi,current:null}),o=s.current||(s.current={}),a=s.previous,u=a[i];o[i]=new Ip(u&&u.currentValue,e,a===wi),t[r]=e}const wp="__ngSimpleChanges__";function Hu(t){return t[wp]||null}const qr=function(t,e,n){};function bt(t){for(;Array.isArray(t);)t=t[Ot];return t}function fn(t,e){return bt(e[t.index])}function Mr(t,e){const n=e[t];return xr(n)?n:n[Ot]}function cs(t,e){return null==e?null:t[e]}function Wu(t){t[Co]=0}function py(t){1024&t[Oe]||(t[Oe]|=1024,Ap(t,1))}function Gu(t){1024&t[Oe]&&(t[Oe]&=-1025,Ap(t,-1))}function Ap(t,e){let n=t[kt];if(null===n)return;n[Ls]+=e;let r=n;for(n=n[kt];null!==n&&(1===e&&1===r[Ls]||-1===e&&0===r[Ls]);)n[Ls]+=e,r=n,n=n[kt]}const Ne={lFrame:kp(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Ku(){return Ne.bindingsEnabled}function Q(){return Ne.lFrame.lView}function ot(){return Ne.lFrame.tView}function Fn(){let t=Rp();for(;null!==t&&64===t.type;)t=t.parent;return t}function Rp(){return Ne.lFrame.currentTNode}function Si(t,e){const n=Ne.lFrame;n.currentTNode=t,n.isParent=e}function Ra(){return Ne.lFrame.isParent}function Iy(t,e){const n=Ne.lFrame;n.bindingIndex=n.bindingRootIndex=t,Nd(e)}function Nd(t){Ne.lFrame.currentDirectiveIndex=t}function Np(){return Ne.lFrame.currentQueryIndex}function xd(t){Ne.lFrame.currentQueryIndex=t}function xp(t){const e=t[ce];return 2===e.type?e.declTNode:1===e.type?t[Wn]:null}function Mp(t,e,n){if(n&Ze.SkipSelf){let i=e,s=t;for(;!(i=i.parent,null!==i||n&Ze.Host||(i=xp(s),null===i||(s=s[os],10&i.type))););if(null===i)return!1;e=i,t=s}const r=Ne.lFrame=Op();return r.currentTNode=e,r.lView=t,!0}function Oo(t){const e=Op(),n=t[ce];Ne.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Op(){const t=Ne.lFrame,e=null===t?null:t.child;return null===e?kp(t):e}function kp(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Fp(){const t=Ne.lFrame;return Ne.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Lp=Fp;function Md(){const t=Fp();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function $i(t){Ne.lFrame.selectedIndex=t}let Vp=!0;function Ju(){return Vp}function ls(t){Vp=t}function Xu(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),null!=h&&(t.destroyHooks??=[]).push(n,h)}}function ko(t,e,n){ec(t,e,3,n)}function Fo(t,e,n,r){(3&t[Oe])===n&&ec(t,e,n,r)}function kd(t,e){let n=t[Oe];(3&n)===e&&(n&=8191,n+=1,t[Oe]=n)}function ec(t,e,n,r){const s=r??-1,o=e.length-1;let a=0;for(let u=void 0!==r?65535&t[Co]:0;u<o;u++)if("number"==typeof e[u+1]){if(a=e[u],null!=r&&a>=r)break}else e[u]<0&&(t[Co]+=65536),(a<s||-1==s)&&(Bp(t,n,e,u),t[Co]=(4294901760&t[Co])+u+2),u++}function Up(t,e){qr(4,t,e);const n=pt(null);try{e.call(t)}finally{pt(n),qr(5,t,e)}}function Bp(t,e,n,r){const i=n[r]<0,s=n[r+1],a=t[i?-n[r]:n[r]];i?t[Oe]>>13<t[Co]>>16&&(3&t[Oe])===e&&(t[Oe]+=8192,Up(a,s)):Up(a,s)}const Lo=-1;class Ws{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function Fd(t){return t!==Lo}function Ma(t){return 32767&t}function Oa(t,e){let n=function xy(t){return t>>16}(t),r=e;for(;n>0;)r=r[os],n--;return r}let nc=!0;function rc(t){const e=nc;return nc=t,e}const f=255,c=5;let d=0;const p={};function I(t,e){const n=L(t,e);if(-1!==n)return n;const r=e[ce];r.firstCreatePass&&(t.injectorIndex=e.length,R(r.data,t),R(e,null),R(r.blueprint,null));const i=X(t,e),s=t.injectorIndex;if(Fd(i)){const o=Ma(i),a=Oa(i,e),u=a[ce].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|u[o+l]}return e[s+8]=i,s}function R(t,e){t.push(0,0,0,0,0,0,0,0,e)}function L(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function X(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;null!==i;){if(r=v0(i),null===r)return Lo;if(n++,i=i[os],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return Lo}function he(t,e,n){!function _(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(Fs)&&(r=n[Fs]),null==r&&(r=n[Fs]=d++);const i=r&f;e.data[t+(i>>c)]|=1<<i}(t,e,n)}function Xe(t,e,n){if(n&Ze.Optional||void 0!==t)return t;Vl()}function ir(t,e,n,r){if(n&Ze.Optional&&void 0===r&&(r=null),!(n&(Ze.Self|Ze.Host))){const i=t[is],s=pr(void 0);try{return i?i.get(e,r,n&Ze.Optional):Iu(e,r,n&Ze.Optional)}finally{pr(s)}}return Xe(r,0,n)}function Hi(t,e,n,r=Ze.Default,i){if(null!==t){if(2048&e[Oe]&&!(r&Ze.Self)){const o=function Ok(t,e,n,r,i){let s=t,o=e;for(;null!==s&&null!==o&&2048&o[Oe]&&!(512&o[Oe]);){const a=ka(s,o,n,r|Ze.Self,p);if(a!==p)return a;let u=s.parent;if(!u){const l=o[Ou];if(l){const h=l.get(n,p,r);if(h!==p)return h}u=v0(o),o=o[os]}s=u}return i}(t,e,n,r,p);if(o!==p)return o}const s=ka(t,e,n,r,p);if(s!==p)return s}return ir(e,n,r,i)}function ka(t,e,n,r,i){const s=function Hp(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Fs)?t[Fs]:void 0;return"number"==typeof e?e>=0?e&f:My:e}(n);if("function"==typeof s){if(!Mp(e,t,r))return r&Ze.Host?Xe(i,0,r):ir(e,n,r,i);try{let o;if(o=s(r),null!=o||r&Ze.Optional)return o;Vl()}finally{Lp()}}else if("number"==typeof s){let o=null,a=L(t,e),u=Lo,l=r&Ze.Host?e[sn][Wn]:null;for((-1===a||r&Ze.SkipSelf)&&(u=-1===a?X(t,e):e[a+8],u!==Lo&&Ld(r,!1)?(o=e[ce],a=Ma(u),e=Oa(u,e)):a=-1);-1!==a;){const h=e[ce];if(ic(s,a,h.data)){const g=$p(a,e,n,o,r,l);if(g!==p)return g}u=e[a+8],u!==Lo&&Ld(r,e[ce].data[a+8]===l)&&ic(s,a,e)?(o=h,a=Ma(u),e=Oa(u,e)):a=-1}}return i}function $p(t,e,n,r,i,s){const o=e[ce],a=o.data[t+8],h=Vo(a,o,n,null==r?js(a)&&nc:r!=o&&0!=(3&a.type),i&Ze.Host&&s===a);return null!==h?ds(e,o,h,a):p}function Vo(t,e,n,r,i){const s=t.providerIndexes,o=e.data,a=1048575&s,u=t.directiveStart,h=s>>20,m=i?a+h:t.directiveEnd;for(let y=r?a:a+h;y<m;y++){const D=o[y];if(y<u&&n===D||y>=u&&D.type===n)return y}if(i){const y=o[u];if(y&&Ai(y)&&y.type===n)return u}return null}function ds(t,e,n,r){let i=t[n];const s=e.data;if(function Ry(t){return t instanceof Ws}(i)){const o=i;o.resolving&&function pa(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new ie(-200,`Circular dependency in DI detected for ${t}${n}`)}(We(s[n]));const a=rc(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?pr(o.injectImpl):null;Mp(t,r,Ze.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&function by(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=Ep(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}(n,s[n],e)}finally{null!==l&&pr(l),rc(a),o.resolving=!1,Lp()}}return i}function ic(t,e,n){return!!(n[e+(t>>c)]&1<<t)}function Ld(t,e){return!(t&Ze.Self||t&Ze.Host&&e)}class Zn{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Hi(this._tNode,this._lView,e,Du(r),n)}}function My(){return new Zn(Fn(),Q())}function v0(t){const e=t[ce],n=e.type;return 2===n?e.declTNode:1===n?t[Wn]:null}const oc="__parameters__";function uc(t,e,n){return Rr(()=>{const r=function ky(t){return function(...n){if(t){const r=t(...n);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(u,l,h){const g=u.hasOwnProperty(oc)?u[oc]:Object.defineProperty(u,oc,{value:[]})[oc];for(;g.length<=h;)g.push(null);return(g[h]=g[h]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function lc(t,e){t.forEach(n=>Array.isArray(n)?lc(n,e):e(n))}function E0(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function zp(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const Wr=Au(uc("Optional"),8);function Qp(t){return 128==(128&t.flags)}var Bo=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Bo||{});const $y=new Map;let dF=0;const zy="__ngContext__";function gr(t,e){xr(e)?(t[zy]=e[Ia],function fF(t){$y.set(t[Ia],t)}(e)):t[zy]=e}let qy;function Wy(t,e){return qy(t,e)}function qd(t){const e=t[kt];return kn(e)?e[kt]:e}function $0(t){return z0(t[Vs])}function H0(t){return z0(t[si])}function z0(t){for(;null!==t&&!kn(t);)t=t[si];return t}function pc(t,e,n,r,i){if(null!=r){let s,o=!1;kn(r)?s=r:xr(r)&&(o=!0,r=r[Ot]);const a=bt(r);0===t&&null!==n?null==i?Z0(e,n,a):Fa(e,n,a,i||null,!0):1===t&&null!==n?Fa(e,n,a,i||null,!0):2===t?function rg(t,e,n){const r=tg(t,e);r&&function xF(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function kF(t,e,n,r,i){const s=n[Di];s!==bt(n)&&pc(e,t,r,s,i);for(let a=Gn;a<n.length;a++){const u=n[a];Gd(u[ce],u,t,e,r,s)}}(e,t,s,n,i)}}function Xp(t,e,n){return t.createElement(e,n)}function W0(t,e){const n=t[bo],r=n.indexOf(e);Gu(e),n.splice(r,1)}function eg(t,e){if(t.length<=Gn)return;const n=Gn+e,r=t[n];if(r){const i=r[Us];null!==i&&i!==t&&W0(i,r),e>0&&(t[n-1][si]=r[si]);const s=zp(t,Gn+e);!function DF(t,e){Gd(t,e,e[ke],2,null,null),e[Ot]=null,e[Wn]=null}(r[ce],r);const o=s[zr];null!==o&&o.detachView(s[ce]),r[kt]=null,r[si]=null,r[Oe]&=-129}return r}function Zy(t,e){if(!(256&e[Oe])){const n=e[ke];e[So]&&yd(e[So]),e[Bs]&&yd(e[Bs]),n.destroyNode&&Gd(t,e,n,3,null,null),function SF(t){let e=t[Vs];if(!e)return Ky(t[ce],t);for(;e;){let n=null;if(xr(e))n=e[Vs];else{const r=e[Gn];r&&(n=r)}if(!n){for(;e&&!e[si]&&e!==t;)xr(e)&&Ky(e[ce],e),e=e[kt];null===e&&(e=t),xr(e)&&Ky(e[ce],e),n=e&&e[si]}e=n}}(e)}}function Ky(t,e){if(!(256&e[Oe])){e[Oe]&=-129,e[Oe]|=256,function NF(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const i=e[n[r]];if(!(i instanceof Ws)){const s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],u=s[o+1];qr(4,a,u);try{u.call(a)}finally{qr(5,a,u)}}else{qr(4,i,s);try{s.call(i)}finally{qr(5,i,s)}}}}}(t,e),function PF(t,e){const n=t.cleanup,r=e[Ao];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[Ao]=null);const i=e[as];if(null!==i){e[as]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(t,e),1===e[ce].type&&e[ke].destroy();const n=e[Us];if(null!==n&&kn(e[kt])){n!==e[kt]&&W0(n,e);const r=e[zr];null!==r&&r.detachView(t)}!function pF(t){$y.delete(t[Ia])}(e)}}function Qy(t,e,n){return function G0(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[Ot];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=t.data[r.directiveStart+i];if(s===ii.None||s===ii.Emulated)return null}return fn(r,n)}}(t,e.parent,n)}function Fa(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Z0(t,e,n){t.appendChild(e,n)}function K0(t,e,n,r,i){null!==r?Fa(t,e,n,r,i):Z0(t,e,n)}function tg(t,e){return t.parentNode(e)}let Yy,tv,J0=function Y0(t,e,n){return 40&t.type?fn(t,n):null};function ng(t,e,n,r){const i=Qy(t,r,e),s=e[ke],a=function Q0(t,e,n){return J0(t,e,n)}(r.parent||e[Wn],r,e);if(null!=i)if(Array.isArray(n))for(let u=0;u<n.length;u++)K0(s,i,n[u],a,!1);else K0(s,i,n,a,!1);void 0!==Yy&&Yy(s,r,e,n,i)}function Wd(t,e){if(null!==e){const n=e.type;if(3&n)return fn(e,t);if(4&n)return Jy(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return Wd(t,r);{const i=t[e.index];return kn(i)?Jy(-1,i):bt(i)}}if(32&n)return Wy(e,t)()||bt(t[e.index]);{const r=eA(t,e);return null!==r?Array.isArray(r)?r[0]:Wd(qd(t[sn]),r):Wd(t,e.next)}}return null}function eA(t,e){return null!==e?t[sn][Wn].projection[e.projection]:null}function Jy(t,e){const n=Gn+t+1;if(n<e.length){const r=e[n],i=r[ce].firstChild;if(null!==i)return Wd(r,i)}return e[Di]}function Xy(t,e,n,r,i,s,o){for(;null!=n;){const a=r[n.index],u=n.type;if(o&&0===e&&(a&&gr(bt(a),r),n.flags|=2),32!=(32&n.flags))if(8&u)Xy(t,e,n.child,r,i,s,!1),pc(e,t,i,a,s);else if(32&u){const l=Wy(n,r);let h;for(;h=l();)pc(e,t,i,h,s);pc(e,t,i,a,s)}else 16&u?nA(t,e,r,n,i,s):pc(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Gd(t,e,n,r,i,s){Xy(n,r,t.firstChild,e,i,s,!1)}function nA(t,e,n,r,i,s){const o=n[sn],u=o[Wn].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++)pc(e,t,i,u[l],s);else{let l=u;const h=o[kt];Qp(r)&&(l.flags|=128),Xy(t,e,l,h,i,s,!0)}}function rA(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function iA(t,e,n){const{mergedAttrs:r,classes:i,styles:s}=n;null!==r&&Jl(t,e,r),null!==i&&rA(t,e,i),null!==s&&function LF(t,e,n){t.setAttribute(e,"style",n)}(t,e,s)}const ag=new ye("ENVIRONMENT_INITIALIZER"),_A=new ye("INJECTOR",-1),yA=new ye("INJECTOR_DEF_TYPES");class av{get(e,n=Os){if(n===Os){const r=new Error(`NullInjectorError: No provider for ${Ee(e)}!`);throw r.name="NullInjectorError",r}return n}}function uv(...t){return{\u0275providers:IA(0,t),\u0275fromNgModule:!0}}function IA(t,...e){const n=[],r=new Set;let i;const s=o=>{n.push(o)};return lc(e,o=>{const a=o;ug(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&EA(i,s),n}function EA(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:i}=t[n];cv(i,s=>{e(s,r)})}}function ug(t,e,n,r){if(!(t=P(t)))return!1;let i=null,s=ga(t);const o=!s&&Je(t);if(s||o){if(o&&!o.standalone)return!1;i=t}else{const u=t.ngModule;if(s=ga(u),!s)return!1;i=u}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of u)ug(l,e,n,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;r.add(i);try{lc(s.imports,h=>{ug(h,e,n,r)&&(l||=[],l.push(h))})}finally{}void 0!==l&&EA(l,e)}if(!a){const l=Ro(i)||(()=>new i);e({provide:i,useFactory:l,deps:ct},i),e({provide:yA,useValue:i,multi:!0},i),e({provide:ag,useValue:()=>pe(i),multi:!0},i)}const u=s.providers;if(null!=u&&!a){const l=t;cv(u,h=>{e(h,l)})}}}return i!==t&&void 0!==t.providers}function cv(t,e){for(let n of t)_e(n)&&(n=n.\u0275providers),Array.isArray(n)?cv(n,e):e(n)}const dL=ue({provide:String,useValue:ue});function lv(t){return null!==t&&"object"==typeof t&&dL in t}function La(t){return"function"==typeof t}const dv=new ye("Set Injector scope."),cg={},fL={};let hv;function lg(){return void 0===hv&&(hv=new av),hv}class Zs{}class yc extends Zs{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,pv(e,o=>this.processProvider(o)),this.records.set(_A,vc(void 0,this)),i.has("environment")&&this.records.set(Zs,vc(void 0,this));const s=this.records.get(dv);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(yA.multi,ct,Ze.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=ns(this),r=pr(void 0);try{return e()}finally{ns(n),pr(r)}}get(e,n=Os,r=Ze.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Pr))return e[Pr](this);r=Du(r);const s=ns(this),o=pr(void 0);try{if(!(r&Ze.SkipSelf)){let u=this.records.get(e);if(void 0===u){const l=function yL(t){return"function"==typeof t||"object"==typeof t&&t instanceof ye}(e)&&_u(e);u=l&&this.injectableDefInScope(l)?vc(fv(e),cg):null,this.records.set(e,u)}if(null!=u)return this.hydrate(e,u)}return(r&Ze.Self?lg():this.parent).get(e,n=r&Ze.Optional&&n===Os?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[br]=a[br]||[]).unshift(Ee(e)),s)throw a;return function Li(t,e,n,r){const i=t[br];throw e[Tu]&&i.unshift(e[Tu]),t.message=function wo(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let i=Ee(e);if(Array.isArray(e))i=e.map(Ee).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ee(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Gl,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t[br]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{pr(o),ns(s)}}resolveInjectorInitializers(){const e=ns(this),n=pr(void 0);try{const i=this.get(ag.multi,ct,Ze.Self);for(const s of i)s()}finally{ns(e),pr(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(Ee(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ie(205,!1)}processProvider(e){let n=La(e=P(e))?e:P(e&&e.provide);const r=function gL(t){return lv(t)?vc(void 0,t.useValue):vc(function DA(t,e,n){let r;if(La(t)){const i=P(t);return Ro(i)||fv(i)}if(lv(t))r=()=>P(t.useValue);else if(function TA(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...ks(t.deps||[]));else if(function wA(t){return!(!t||!t.useExisting)}(t))r=()=>pe(P(t.useExisting));else{const i=P(t&&(t.useClass||t.provide));if(!function mL(t){return!!t.deps}(t))return Ro(i)||fv(i);r=()=>new i(...ks(t.deps))}return r}(t),cg)}(e);if(La(e)||!0!==e.multi)this.records.get(n);else{let i=this.records.get(n);i||(i=vc(void 0,cg,!0),i.factory=()=>ks(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===cg&&(n.value=fL,n.value=n.factory()),"object"==typeof n.value&&n.value&&function _L(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=P(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function fv(t){const e=_u(t),n=null!==e?e.factory:Ro(t);if(null!==n)return n;if(t instanceof ye)throw new ie(204,!1);if(t instanceof Function)return function pL(t){const e=t.length;if(e>0)throw function $d(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}(e,"?"),new ie(204,!1);const n=function vo(t){return t&&(t[Io]||t[yu])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new ie(204,!1)}function vc(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function pv(t,e){for(const n of t)Array.isArray(n)?pv(n,e):n&&_e(n)?pv(n.\u0275providers,e):e(n)}const gv=new ye("AppId",{providedIn:"root",factory:()=>vL}),vL="ng",AA=new ye("Platform Initializer"),Ks=new ye("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),CA=new ye("CSP nonce",{providedIn:"root",factory:()=>function mc(){if(void 0!==tv)return tv;if(typeof document<"u")return document;throw new ie(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let SA=(t,e,n)=>null;function Tv(t,e,n=!1){return SA(t,e,n)}class RL{}class PA{}class NL{resolveComponentFactory(e){throw function PL(t){const e=Error(`No component factory found for ${Ee(t)}.`);return e.ngComponent=t,e}(e)}}let mg=(()=>{class t{static#e=this.NULL=new NL}return t})();function xL(){return wc(Fn(),Q())}function wc(t,e){return new Tc(fn(t,e))}let Tc=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=xL}return t})();function ML(t){return t instanceof Tc?t.nativeElement:t}class xA{}let kL=(()=>{class t{static#e=this.\u0275prov=ft({token:t,providedIn:"root",factory:()=>null})}return t})();class _g{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const OA=new _g("16.2.12"),Cv={};function VA(t,e=null,n=null,r){const i=function UA(t,e=null,n=null,r,i=new Set){const s=[n||ct,uv(t)];return r=r||("object"==typeof t?void 0:Ee(t)),new yc(s,e||lg(),r||null,i)}(t,e,n,r);return i.resolveInjectorInitializers(),i}let Pi=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=Os;static#t=this.NULL=new av;static create(n,r){if(Array.isArray(n))return VA({name:""},r,n,"");{const i=n.name??"";return VA({name:i},n.parent,n.providers,i)}}static#n=this.\u0275prov=ft({token:t,providedIn:"any",factory:()=>pe(_A)});static#r=this.__NG_ELEMENT_ID__=-1}return t})();function bv(t){return t.ngOriginalError}class Qs{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&bv(e);for(;n&&bv(n);)n=bv(n);return n||null}}function Pv(t){return e=>{setTimeout(t,void 0,e)}}const Ys=class $L extends q{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Pv(s),i&&(i=Pv(i)),o&&(o=Pv(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof gt&&e.add(a),a}};function jA(...t){}class Rt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ys(!1),this.onMicrotaskEmpty=new Ys(!1),this.onStable=new Ys(!1),this.onError=new Ys(!1),typeof Zone>"u")throw new ie(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function HL(){const t="function"==typeof wt.requestAnimationFrame;let e=wt[t?"requestAnimationFrame":"setTimeout"],n=wt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function WL(t){const e=()=>{!function qL(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(wt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,xv(t),t.isCheckStableRunning=!0,Nv(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),xv(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(function ZL(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return n.invokeTask(i,s,o,a);try{return $A(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),HA(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return $A(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),HA(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,xv(t),Nv(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Rt.isInAngularZone())throw new ie(909,!1)}static assertNotInAngularZone(){if(Rt.isInAngularZone())throw new ie(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,zL,jA,jA);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const zL={};function Nv(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function xv(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function $A(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function HA(t){t._nesting--,Nv(t)}const zA=new ye("",{providedIn:"root",factory:qA});function qA(){const t=_t(Rt);let e=!0;return w(new tt(i=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{i.next(e),i.complete()})}),new tt(i=>{let s;t.runOutsideAngular(()=>{s=t.onStable.subscribe(()=>{Rt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=t.onUnstable.subscribe(()=>{Rt.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(H()))}let Mv=(()=>{class t{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=ft({token:t,providedIn:"root",factory:()=>new t})}return t})();function Xd(t){for(;t;){t[Oe]|=64;const e=qd(t);if(sp(t)&&!e)return t;t=e}return null}const QA=new ye("",{providedIn:"root",factory:()=>!1});let vg=null;function eC(t,e){return t[e]??rC()}function tC(t,e){const n=rC();n.producerNode?.length&&(t[e]=vg,n.lView=t,vg=nC())}const iV={...dp,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Xd(t.lView)},lView:null};function nC(){return Object.create(iV)}function rC(){return vg??=nC(),vg}const Be={};function Qe(t,e=Ze.Default){const n=Q();return null===n?pe(t,e):Hi(Fn(),n,P(t),e)}function Ig(t,e,n,r,i,s,o,a,u,l,h){const g=e.blueprint.slice();return g[Ot]=i,g[Oe]=140|r,(null!==l||t&&2048&t[Oe])&&(g[Oe]|=2048),Wu(g),g[kt]=g[os]=t,g[qt]=n,g[ss]=o||t&&t[ss],g[ke]=a||t&&t[ke],g[is]=u||t&&t[is]||null,g[Wn]=s,g[Ia]=function hF(){return dF++}(),g[Bi]=h,g[Ou]=l,g[sn]=2==e.type?t[sn]:g,g}function Cc(t,e,n,r,i){let s=t.data[e];if(null===s)s=function Ov(t,e,n,r,i){const s=Rp(),o=Ra(),u=t.data[e]=function pV(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function Mo(){return null!==Ne.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,r,i);return null===t.firstChild&&(t.firstChild=u),null!==s&&(o?null==s.child&&null!==u.parent&&(s.child=u):null===s.next&&(s.next=u,u.prev=s)),u}(t,e,n,r,i),function Pp(){return Ne.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=n,s.value=r,s.attrs=i;const o=function zs(){const t=Ne.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Si(s,!0),s}function eh(t,e,n,r){if(0===n)return-1;const i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function sC(t,e,n,r,i){const s=eC(e,So),o=function rr(){return Ne.lFrame.selectedIndex}(),a=2&r;try{$i(-1),a&&e.length>Ke&&function iC(t,e,n,r){if(!r)if(3==(3&e[Oe])){const s=t.preOrderCheckHooks;null!==s&&ko(e,s,n)}else{const s=t.preOrderHooks;null!==s&&Fo(e,s,0,n)}$i(n)}(t,e,Ke,!1),qr(a?2:0,i);const l=a?s:null,h=Bu(l);try{null!==l&&(l.dirty=!1),n(r,i)}finally{_d(l,h)}}finally{a&&null===e[So]&&tC(e,So),$i(o),qr(a?3:1,i)}}function kv(t,e,n){if(hd(e)){const r=pt(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{pt(r)}}}function oC(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Vv(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Vv(t,e,n,r,i,s,o,a,u,l,h){const g=Ke+r,m=g+i,y=function uV(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Be);return n}(g,m),D="function"==typeof l?l():l;return y[ce]={type:t,blueprint:y,template:n,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:D,incompleteFirstPass:!1,ssrId:h}}let aC=t=>null;function uC(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=null===n?{}:n;const s=t[i];null===r?cC(n,e,i,s):r.hasOwnProperty(i)&&cC(n,e,r[i],s)}return n}function cC(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function lC(t,e,n,r,i,s){for(let l=0;l<r.length;l++)he(I(n,e),t,r[l].type);!function CV(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let l=0;l<r.length;l++){const h=r[l];h.providersResolver&&h.providersResolver(h)}let o=!1,a=!1,u=eh(t,e,r.length,null);for(let l=0;l<r.length;l++){const h=r[l];n.mergedAttrs=Do(n.mergedAttrs,h.hostAttrs),SV(t,n,e,u,h),AV(u,h,i),null!==h.contentQueries&&(n.flags|=4),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(n.flags|=64);const g=h.type.prototype;!o&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(g.ngOnChanges||g.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}!function gV(t,e,n){const i=e.directiveEnd,s=t.data,o=e.attrs,a=[];let u=null,l=null;for(let h=e.directiveStart;h<i;h++){const g=s[h],m=n?n.get(g):null,D=m?m.outputs:null;u=uC(g.inputs,h,u,m?m.inputs:null),l=uC(g.outputs,h,l,D);const C=null===u||null===o||bu(e)?null:PV(u,h,o);a.push(C)}null!==u&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}(t,n,s)}function dC(t,e,n){const r=n.directiveStart,i=n.directiveEnd,s=n.index,o=function Ey(){return Ne.lFrame.currentDirectiveIndex}();try{$i(s);for(let a=r;a<i;a++){const u=t.data[a],l=e[a];Nd(a),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&wV(u,l)}}finally{$i(-1),Nd(o)}}function wV(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Bv(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function AV(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Ai(e)&&(n[""]=t)}}function SV(t,e,n,r,i){t.data[r]=i;const s=i.factory||(i.factory=Ro(i.type)),o=new Ws(s,Ai(i),Qe);t.blueprint[r]=o,n[r]=o,function vV(t,e,n,r,i){const s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const a=~e.index;(function IV(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=a&&o.push(a),o.push(n,r,s)}}(t,e,r,eh(t,n,i.hostVars,Be),i)}function RV(t,e,n,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)hC(r,n,o[a++],o[a++],o[a++])}function hC(t,e,n,r,i){const s=pt(null);try{const o=t.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==t.setInput?t.setInput(e,i,n,r):e[r]=i}finally{pt(s)}}function PV(t,e,n){let r=null,i=0;for(;i<n.length;){const s=n[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(t.hasOwnProperty(s)){null===r&&(r=[]);const o=t[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],n[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function pC(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const s=n[r+1];if(-1!==s){const o=t.data[s];xd(n[r]),o.contentQueries(2,e[s],s)}}}function Eg(t,e){return t[Vs]?t[rp][si]=e:t[Vs]=e,t[rp]=e,e}function $v(t,e,n){xd(0);const r=pt(null);try{e(t,n)}finally{pt(r)}}function Hv(t,e,n,r,i){for(let s=0;s<n.length;){const o=n[s++],a=n[s++];hC(t.data[o],e[o],r,a,i)}}function NV(t,e){const n=Mr(e,t),r=n[ce];!function xV(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const i=n[Ot];null!==i&&null===n[Bi]&&(n[Bi]=Tv(i,n[is])),zv(r,n,n[qt])}function zv(t,e,n){Oo(e);try{const r=t.viewQuery;null!==r&&$v(1,r,n);const i=t.template;null!==i&&sC(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&pC(t,e),t.staticViewQueries&&$v(2,t.viewQuery,n);const s=t.components;null!==s&&function MV(t,e){for(let n=0;n<e.length;n++)NV(t,e[n])}(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Oe]&=-5,Md()}}let vC=(()=>{class t{constructor(){this.all=new Set,this.queue=new Map}create(n,r,i){const s=typeof Zone>"u"?null:Zone.current,o=function uy(t,e,n){const r=Object.create(cy);n&&(r.consumerAllowSignalWrites=!0),r.fn=t,r.schedule=e;const i=o=>{r.cleanupFn=o};return r.ref={notify:()=>fp(r),run:()=>{if(r.dirty=!1,r.hasRun&&!Ta(r))return;r.hasRun=!0;const o=Bu(r);try{r.cleanupFn(),r.cleanupFn=vp,r.fn(i)}finally{_d(r,o)}},cleanup:()=>r.cleanupFn()},r.ref}(n,l=>{this.all.has(l)&&this.queue.set(l,s)},i);let a;this.all.add(o),o.notify();const u=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=r?.onDestroy(u),{destroy:u}}flush(){if(0!==this.queue.size)for(const[n,r]of this.queue)this.queue.delete(n),r?r.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=ft({token:t,providedIn:"root",factory:()=>new t})}return t})();function wg(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=bn(i,a):2==s&&(r=bn(r,a+": "+e[++o]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}function th(t,e,n,r,i=!1){for(;null!==n;){const s=e[n.index];null!==s&&r.push(bt(s)),kn(s)&&IC(s,r);const o=n.type;if(8&o)th(t,e,n.child,r);else if(32&o){const a=Wy(n,e);let u;for(;u=a();)r.push(u)}else if(16&o){const a=eA(e,n);if(Array.isArray(a))r.push(...a);else{const u=qd(e[sn]);th(u[ce],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function IC(t,e){for(let n=Gn;n<t.length;n++){const r=t[n],i=r[ce].firstChild;null!==i&&th(r[ce],r,i,e)}t[Di]!==t[Ot]&&e.push(t[Di])}function Tg(t,e,n,r=!0){const i=e[ss],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{EC(t,e,t.template,n)}catch(u){throw r&&function yC(t,e){const n=t[is],r=n?n.get(Qs,null):null;r&&r.handleError(e)}(e,u),u}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function EC(t,e,n,r){const i=e[Oe];if(256!=(256&i)){e[ss].effectManager?.flush(),Oo(e);try{Wu(e),function Pd(t){return Ne.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&sC(t,e,n,2,r);const o=3==(3&i);if(o){const l=t.preOrderCheckHooks;null!==l&&ko(e,l,null)}else{const l=t.preOrderHooks;null!==l&&Fo(e,l,0,null),kd(e,0)}if(function FV(t){for(let e=$0(t);null!==e;e=H0(e)){if(!e[ip])continue;const n=e[bo];for(let r=0;r<n.length;r++){py(n[r])}}}(e),wC(e,2),null!==t.contentQueries&&pC(t,e),o){const l=t.contentCheckHooks;null!==l&&ko(e,l)}else{const l=t.contentHooks;null!==l&&Fo(e,l,1),kd(e,1)}!function aV(t,e){const n=t.hostBindingOpCodes;if(null===n)return;const r=eC(e,Bs);try{for(let i=0;i<n.length;i++){const s=n[i];if(s<0)$i(~s);else{const o=s,a=n[++i],u=n[++i];Iy(a,o),r.dirty=!1;const l=Bu(r);try{u(2,e[o])}finally{_d(r,l)}}}}finally{null===e[Bs]&&tC(e,Bs),$i(-1)}}(t,e);const a=t.components;null!==a&&DC(e,a,0);const u=t.viewQuery;if(null!==u&&$v(2,u,r),o){const l=t.viewCheckHooks;null!==l&&ko(e,l)}else{const l=t.viewHooks;null!==l&&Fo(e,l,2),kd(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Oe]&=-73,Gu(e)}finally{Md()}}}function wC(t,e){for(let n=$0(t);null!==n;n=H0(n))for(let r=Gn;r<n.length;r++)TC(n[r],e)}function LV(t,e,n){TC(Mr(e,t),n)}function TC(t,e){if(!function Dp(t){return 128==(128&t[Oe])}(t))return;const n=t[ce],r=t[Oe];if(80&r&&0===e||1024&r||2===e)EC(n,t,n.template,t[qt]);else if(t[Ls]>0){wC(t,1);const i=n.components;null!==i&&DC(t,i,1)}}function DC(t,e,n){for(let r=0;r<e.length;r++)LV(t,e[r],n)}class nh{get rootNodes(){const e=this._lView,n=e[ce];return th(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[qt]}set context(e){this._lView[qt]=e}get destroyed(){return 256==(256&this._lView[Oe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[kt];if(kn(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(eg(e,r),zp(n,r))}this._attachedToViewContainer=!1}Zy(this._lView[ce],this._lView)}onDestroy(e){!function Zu(t,e){if(256==(256&t[Oe]))throw new ie(911,!1);null===t[as]&&(t[as]=[]),t[as].push(e)}(this._lView,e)}markForCheck(){Xd(this._cdRefInjectingView||this._lView)}detach(){this._lView[Oe]&=-129}reattach(){this._lView[Oe]|=128}detectChanges(){Tg(this._lView[ce],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ie(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function CF(t,e){Gd(t,e,e[ke],2,null,null)}(this._lView[ce],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ie(902,!1);this._appRef=e}}class VV extends nh{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Tg(e[ce],e,e[qt],!1)}checkNoChanges(){}get context(){return null}}class AC extends mg{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=Je(e);return new rh(n,this.ngModule)}}function CC(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class BV{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Du(r);const i=this.injector.get(e,Cv,r);return i!==Cv||n===Cv?i:this.parentInjector.get(e,n,r)}}class rh extends PA{get inputs(){const e=this.componentDef,n=e.inputTransforms,r=CC(e.inputs);if(null!==n)for(const i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return CC(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function tp(t){return t.map(sd).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=(i=i||this.ngModule)instanceof Zs?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new BV(e,s):e,a=o.get(xA,null);if(null===a)throw new ie(407,!1);const g={rendererFactory:a,sanitizer:o.get(kL,null),effectManager:o.get(vC,null),afterRenderEventManager:o.get(Mv,null)},m=a.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",D=r?function cV(t,e,n,r){const s=r.get(QA,!1)||n===ii.ShadowDom,o=t.selectRootElement(e,s);return function lV(t){aC(t)}(o),o}(m,r,this.componentDef.encapsulation,o):Xp(m,y,function UV(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(y)),F=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let N=null;null!==D&&(N=Tv(D,o,!0));const V=Vv(0,null,null,1,0,null,null,null,null,null,null),Z=Ig(null,V,null,F,null,null,g,m,o,null,N);let se,be;Oo(Z);try{const ht=this.componentDef;let ln,_o=null;ht.findHostDirectiveDefs?(ln=[],_o=new Map,ht.findHostDirectiveDefs(ht,ln,_o),ln.push(ht)):ln=[ht];const j_=function $V(t,e){const n=t[ce],r=Ke;return t[r]=e,Cc(n,r,2,"#host",null)}(Z,D),L8=function HV(t,e,n,r,i,s,o){const a=i[ce];!function zV(t,e,n,r){for(const i of t)e.mergedAttrs=Do(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(wg(e,e.mergedAttrs,!0),null!==n&&iA(r,n,e))}(r,t,e,o);let u=null;null!==e&&(u=Tv(e,i[is]));const l=s.rendererFactory.createRenderer(e,n);let h=16;n.signals?h=4096:n.onPush&&(h=64);const g=Ig(i,oC(n),null,h,i[t.index],t,s,l,null,null,u);return a.firstCreatePass&&Bv(a,t,r.length-1),Eg(i,g),i[t.index]=g}(j_,D,ht,ln,Z,g,m);be=function Tp(t,e){return t.data[e]}(V,Ke),D&&function WV(t,e,n,r){if(r)Jl(t,n,["ng-version",OA.full]);else{const{attrs:i,classes:s}=function od(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let s=t[r];if("string"==typeof s)2===i?""!==s&&e.push(s,t[++r]):8===i&&n.push(s);else{if(!Nr(i))break;i=s}r++}return{attrs:e,classes:n}}(e.selectors[0]);i&&Jl(t,n,i),s&&s.length>0&&rA(t,n,s.join(" "))}}(m,ht,D,r),void 0!==n&&function GV(t,e,n){const r=t.projection=[];for(let i=0;i<e.length;i++){const s=n[i];r.push(null!=s?Array.from(s):null)}}(be,this.ngContentSelectors,n),se=function qV(t,e,n,r,i,s){const o=Fn(),a=i[ce],u=fn(o,i);lC(a,i,o,n,null,r);for(let h=0;h<n.length;h++)gr(ds(i,a,o.directiveStart+h,o),i);dC(a,i,o),u&&gr(u,i);const l=ds(i,a,o.directiveStart+o.componentOffset,o);if(t[qt]=i[qt]=l,null!==s)for(const h of s)h(l,e);return kv(a,o,t),l}(L8,ht,ln,_o,Z,[ZV]),zv(V,Z,null)}finally{Md()}return new jV(this.componentType,se,wc(be,Z),Z,be)}}class jV extends RL{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new VV(i),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const s=this._rootLView;Hv(s[ce],s,i,e,n),this.previousInputValues.set(e,n),Xd(Mr(this._tNode.index,s))}}get injector(){return new Zn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function ZV(){const t=Fn();Xu(Q()[ce],t)}function Yv(t,e,n,r,i){const o=i?"class":"style";Hv(t,n,e.inputs[o],o,r)}function an(t,e,n,r){const i=Q(),s=ot(),o=Ke+t,a=i[ke],u=s.firstCreatePass?function P2(t,e,n,r,i,s){const o=e.consts,u=Cc(e,t,2,r,cs(o,i));return function Uv(t,e,n,r){if(Ku()){const i=null===r?null:{"":-1},s=function TV(t,e){const n=t.directiveRegistry;let r=null,i=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];if(Pu(e,o.selectors,!1))if(r||(r=[]),Ai(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),Bv(t,e,a.length)}else r.unshift(o),Bv(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(t,n);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&lC(t,e,n,o,i,a),i&&function DV(t,e,n){if(e){const r=t.localNames=[];for(let i=0;i<e.length;i+=2){const s=n[e[i+1]];if(null==s)throw new ie(-301,!1);r.push(e[i],s)}}}(n,r,i)}n.mergedAttrs=Do(n.mergedAttrs,n.attrs)}(e,n,u,cs(o,s)),null!==u.attrs&&wg(u,u.attrs,!1),null!==u.mergedAttrs&&wg(u,u.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,u),u}(o,s,i,e,n,r):s.data[o],l=ZC(s,i,u,a,e,t);i[o]=l;const h=function fd(t){return 1==(1&t.flags)}(u);return Si(u,!0),iA(a,l,u),32!=(32&u.flags)&&Ju()&&ng(s,i,l,u),0===function gy(){return Ne.lFrame.elementDepthCount}()&&gr(l,i),function Cd(){Ne.lFrame.elementDepthCount++}(),h&&(function Fv(t,e,n){Ku()&&(function EV(t,e,n,r){const i=n.directiveStart,s=n.directiveEnd;js(n)&&function bV(t,e,n){const r=fn(e,t),i=oC(n);let o=16;n.signals?o=4096:n.onPush&&(o=64);const a=Eg(t,Ig(t,i,null,o,r,e,null,t[ss].rendererFactory.createRenderer(r,n),null,null,null));t[e.index]=a}(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||I(n,e),gr(r,e);const o=n.initialInputs;for(let a=i;a<s;a++){const u=t.data[a],l=ds(e,t,a,n);gr(l,e),null!==o&&RV(0,a-i,l,u,0,o),Ai(u)&&(Mr(n.index,e)[qt]=ds(e,t,a,n))}}(t,e,n,fn(n,e)),64==(64&n.flags)&&dC(t,e,n))}(s,i,u),kv(s,u,i)),null!==r&&function Lv(t,e,n=fn){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?n(e,t):t[o];t[i++]=a}}}(i,u),an}function un(){let t=Fn();Ra()?function Pa(){Ne.lFrame.isParent=!1}():(t=t.parent,Si(t,!1));const e=t;(function Cp(t){return Ne.skipHydrationRootTNode===t})(e)&&function _y(){Ne.skipHydrationRootTNode=null}(),function Sd(){Ne.lFrame.elementDepthCount--}();const n=ot();return n.firstCreatePass&&(Xu(n,t),hd(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function tc(t){return 0!=(8&t.flags)}(e)&&Yv(n,e,Q(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function jp(t){return 0!=(16&t.flags)}(e)&&Yv(n,e,Q(),e.stylesWithoutHost,!1),un}function ps(t,e,n,r){return an(t,e,n,r),un(),ps}let ZC=(t,e,n,r,i,s)=>(ls(!0),Xp(r,i,function Od(){return Ne.lFrame.currentNamespace}()));function eI(t){return!!t&&"function"==typeof t.then}function YC(t){return!!t&&"function"==typeof t.subscribe}function sr(t,e=""){const n=Q(),r=ot(),i=t+Ke,s=r.firstCreatePass?Cc(r,i,1,e,null):r.data[i],o=SS(r,n,s,e,t);n[i]=o,Ju()&&ng(r,n,o,s),Si(s,!1)}let SS=(t,e,n,r,i)=>(ls(!0),function Jp(t,e){return t.createText(e)}(e[ke],r));const Vc="en-US";let QS=Vc;class ja{}class wb extends ja{constructor(e){super(),this.componentFactoryResolver=new AC(this),this.instance=null;const n=new yc([...e.providers,{provide:ja,useValue:this},{provide:mg,useValue:this.componentFactoryResolver}],e.parent||lg(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}let FB=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=IA(0,n.type),i=r.length>0?function kB(t,e,n=null){return new wb({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,i)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=ft({token:t,providedIn:"environment",factory:()=>new t(pe(Zs))})}return t})();function gI(t){t.getStandaloneInjector=e=>e.get(FB).getOrCreateStandaloneInjector(t)}function uj(){return this._results[Symbol.iterator]()}class _I{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Ys)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=_I.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=uj)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){const r=this;r.dirty=!1;const i=function Ri(t){return t.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Uk(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}(r._results,i,n))&&(r._results=i,r.length=i.length,r.last=i[this.length-1],r.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function lj(t,e,n,r=!0){const i=e[ce];if(function bF(t,e,n,r){const i=Gn+r,s=n.length;r>0&&(n[i-1][si]=e),r<s-Gn?(e[si]=n[i],E0(n,Gn+r,e)):(n.push(e),e[si]=null),e[kt]=n;const o=e[Us];null!==o&&n!==o&&function RF(t,e){const n=t[bo];e[sn]!==e[kt][kt][sn]&&(t[ip]=!0),null===n?t[bo]=[e]:n.push(e)}(o,e);const a=e[zr];null!==a&&a.insertView(t),e[Oe]|=128}(i,e,t,n),r){const s=Jy(n,t),o=e[ke],a=tg(o,t[Di]);null!==a&&function AF(t,e,n,r,i,s){r[Ot]=i,r[Wn]=e,Gd(t,r,n,1,i,s)}(i,t[Wn],o,e,a,s)}}let eo=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=fj}return t})();const dj=eo,hj=class extends dj{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const i=function cj(t,e,n,r){const i=e.tView,a=Ig(t,i,n,4096&t[Oe]?4096:16,null,e,null,null,null,r?.injector??null,r?.hydrationInfo??null);a[Us]=t[e.index];const l=t[zr];return null!==l&&(a[zr]=l.createEmbeddedView(i)),zv(i,a,n),a}(this._declarationLView,this._declarationTContainer,e,{injector:n,hydrationInfo:r});return new nh(i)}};function fj(){return Fg(Fn(),Q())}function Fg(t,e){return 4&t.type?new hj(e,t,wc(t,e)):null}let _s=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=vj}return t})();function vj(){return Bb(Fn(),Q())}const Ij=_s,Vb=class extends Ij{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return wc(this._hostTNode,this._hostLView)}get injector(){return new Zn(this._hostTNode,this._hostLView)}get parentInjector(){const e=X(this._hostTNode,this._hostLView);if(Fd(e)){const n=Oa(e,this._hostLView),r=Ma(e);return new Zn(n[ce].data[r+8],n)}return new Zn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=Ub(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-Gn}createEmbeddedView(e,n,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(n||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,n,r,i,s){const o=e&&!function jd(t){return"function"==typeof t}(e);let a;if(o)a=n;else{const C=n||{};a=C.index,r=C.injector,i=C.projectableNodes,s=C.environmentInjector||C.ngModuleRef}const u=o?e:new rh(Je(e)),l=r||this.parentInjector;if(!s&&null==u.ngModule){const b=(o?l:this.parentInjector).get(Zs,null);b&&(s=b)}Je(u.componentType??{});const y=u.create(l,i,null,s);return this.insertImpl(y.hostView,a,false),y}insert(e,n){return this.insertImpl(e,n,!1)}insertImpl(e,n,r){const i=e._lView;if(function fy(t){return kn(t[kt])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const l=i[kt],h=new Vb(l,l[Wn],l[kt]);h.detach(h.indexOf(e))}}const o=this._adjustIndex(n),a=this._lContainer;return lj(a,i,o,!r),e.attachToViewContainerRef(),E0(yI(a),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=Ub(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=eg(this._lContainer,n);r&&(zp(yI(this._lContainer),n),Zy(r[ce],r))}detach(e){const n=this._adjustIndex(e,-1),r=eg(this._lContainer,n);return r&&null!=zp(yI(this._lContainer),n)?new nh(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function Ub(t){return t[8]}function yI(t){return t[8]||(t[8]=[])}function Bb(t,e){let n;const r=e[t.index];return kn(r)?n=r:(n=function fC(t,e,n,r){return[t,!0,!1,e,null,0,r,n,null,null,null]}(r,e,null,t),e[t.index]=n,Eg(e,n)),jb(n,e,t,r),new Vb(n,t,e)}let jb=function $b(t,e,n,r){if(t[Di])return;let i;i=8&n.type?bt(r):function Ej(t,e){const n=t[ke],r=n.createComment(""),i=fn(e,t);return Fa(n,tg(n,i),r,function MF(t,e){return t.nextSibling(e)}(n,i),!1),r}(e,n),t[Di]=i};class vI{constructor(e){this.queryList=e,this.matches=null}clone(){return new vI(this.queryList)}setDirty(){this.queryList.setDirty()}}class II{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const r=null!==e.contentQueries?e.contentQueries[0]:n.length,i=[];for(let s=0;s<r;s++){const o=n.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new II(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==Qb(e,n).matches&&this.queries[n].setDirty()}}class Hb{constructor(e,n,r=null){this.predicate=e,this.flags=n,this.read=r}}class EI{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){const i=null!==n?n.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,null!==n?n.push(s):n=[s])}return null!==n?new EI(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class wI{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new wI(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){const s=r[i];this.matchTNodeWithReadOption(e,n,Dj(n,s)),this.matchTNodeWithReadOption(e,n,Vo(n,e,s,!1,!1))}else r===eo?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Vo(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(null!==r){const i=this.metadata.read;if(null!==i)if(i===Tc||i===_s||i===eo&&4&n.type)this.addMatch(n.index,-2);else{const s=Vo(n,e,i,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,r)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function Dj(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Cj(t,e,n,r){return-1===n?function Aj(t,e){return 11&t.type?wc(t,e):4&t.type?Fg(t,e):null}(e,t):-2===n?function Sj(t,e,n){return n===Tc?wc(e,t):n===eo?Fg(e,t):n===_s?Bb(e,t):void 0}(t,e,r):ds(t,t[ce],n,e)}function zb(t,e,n,r){const i=e[zr].queries[r];if(null===i.matches){const s=t.data,o=n.matches,a=[];for(let u=0;u<o.length;u+=2){const l=o[u];a.push(l<0?null:Cj(e,s[l],o[u+1],n.metadata.read))}i.matches=a}return i.matches}function TI(t,e,n,r){const i=t.queries.getByIndex(n),s=i.matches;if(null!==s){const o=zb(t,e,i,n);for(let a=0;a<s.length;a+=2){const u=s[a];if(u>0)r.push(o[a/2]);else{const l=s[a+1],h=e[-u];for(let g=Gn;g<h.length;g++){const m=h[g];m[Us]===m[kt]&&TI(m[ce],m,l,r)}if(null!==h[bo]){const g=h[bo];for(let m=0;m<g.length;m++){const y=g[m];TI(y[ce],y,l,r)}}}}}return r}function qb(t){const e=Q(),n=ot(),r=Np();xd(r+1);const i=Qb(n,r);if(t.dirty&&function Dd(t){return 4==(4&t[Oe])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)t.reset([]);else{const s=i.crossesNgTemplate?TI(n,e,r,[]):zb(n,e,i,r);t.reset(s,ML),t.notifyOnChanges()}return!0}return!1}function Wb(t,e,n){const r=ot();r.firstCreatePass&&(function Kb(t,e,n){null===t.queries&&(t.queries=new EI),t.queries.track(new wI(e,n))}(r,new Hb(t,e,n),-1),2==(2&e)&&(r.staticViewQueries=!0)),function Zb(t,e,n){const r=new _I(4==(4&n));(function fV(t,e,n,r){const i=function gC(t){return t[Ao]||(t[Ao]=[])}(e);i.push(n),t.firstCreatePass&&function mC(t){return t.cleanup||(t.cleanup=[])}(t).push(r,i.length-1)})(t,e,r,r.destroy),null===e[zr]&&(e[zr]=new II),e[zr].queries.push(new vI(r))}(r,Q(),e)}function Qb(t,e){return t.queries.getByIndex(e)}const Jj=new ye("Application Initializer");let bI=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=_t(Jj,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const i of this.appInits){const s=i();if(eI(s))n.push(s);else if(YC(s)){const o=new Promise((a,u)=>{s.subscribe({complete:a,error:u})});n.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(i=>{this.reject(i)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const to=new ye("LocaleId",{providedIn:"root",factory:()=>_t(to,Ze.Optional|Ze.SkipSelf)||function e$(){return typeof $localize<"u"&&$localize.locale||Vc}()});let r$=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new v(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const _R=new ye("");let Ho=null;const OI=new ye("PlatformDestroyListeners"),vR=new ye("appBootstrapListener");function N$(t){try{const{rootComponent:e,appProviders:n,platformProviders:r}=t,i=function P$(t=[]){if(Ho)return Ho;const e=function wR(t=[],e){return Pi.create({name:e,providers:[{provide:dv,useValue:"platform"},{provide:OI,useValue:new Set([()=>Ho=null])},...t]})}(t);return Ho=e,function IR(){!function iy(t){ry=t}(()=>{throw new ie(600,!1)})}(),function ER(t){t.get(AA,null)?.forEach(n=>n())}(e),e}(r),s=[F$(),...n||[]],a=new wb({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,u=a.get(Rt);return u.run(()=>{a.resolveInjectorInitializers();const l=a.get(Qs,null);let h;u.runOutsideAngular(()=>{h=u.onError.subscribe({next:y=>{l.handleError(y)}})});const g=()=>a.destroy(),m=i.get(OI);return m.add(g),a.onDestroy(()=>{h.unsubscribe(),m.delete(g)}),function AR(t,e,n){try{const r=n();return eI(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(l,u,()=>{const y=a.get(bI);return y.runInitializers(),y.donePromise.then(()=>{!function YS(t){zn(t,"Expected localeId to be defined"),"string"==typeof t&&(QS=t.toLowerCase().replace(/_/g,"-"))}(a.get(to,Vc)||Vc);const C=a.get(yh);return void 0!==e&&C.bootstrap(e),C})})})}catch(e){return Promise.reject(e)}}let yh=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=_t(bR),this.zoneIsStable=_t(zA),this.componentTypes=[],this.components=[],this.isStable=_t(r$).hasPendingTasks.pipe(Ae(n=>n?M(!1):this.zoneIsStable),Pe(),H()),this._injector=_t(Zs)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const i=n instanceof PA;if(!this._injector.get(bI).done)throw!i&&function ya(t){const e=Je(t)||Mn(t)||On(t);return null!==e&&e.standalone}(n),new ie(405,!1);let o;o=i?n:this._injector.get(mg).resolveComponentFactory(n),this.componentTypes.push(o.componentType);const a=function b$(t){return t.isBoundToModule}(o)?void 0:this._injector.get(ja),l=o.create(Pi.NULL,[],r||o.selector,a),h=l.location.nativeElement,g=l.injector.get(_R,null);return g?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),jg(this.components,l),g?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new ie(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;jg(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(vR,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>jg(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new ie(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function jg(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const bR=new ye("",{providedIn:"root",factory:()=>_t(Qs).handleError.bind(void 0)});function O$(){const t=_t(Rt),e=_t(Qs);return n=>t.runOutsideAngular(()=>e.handleError(n))}let k$=(()=>{class t{constructor(){this.zone=_t(Rt),this.applicationRef=_t(yh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function RR(t){return[{provide:Rt,useFactory:t},{provide:ag,multi:!0,useFactory:()=>{const e=_t(k$,{optional:!0});return()=>e.initialize()}},{provide:bR,useFactory:O$},{provide:zA,useFactory:qA}]}function F$(t){return function vA(t){return{\u0275providers:t}}([[],RR(()=>new Rt(function DR(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}(t)))])}let jI=null;function $I(){return jI}class lH{}const Ha=new ye("DocumentToken");let uP=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=Ui({type:t});static#n=this.\u0275inj=Ms({})}return t})();function nm(t){return"server"===t}class e4 extends lH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class sE extends e4{static makeCurrent(){!function cH(t){jI||(jI=t)}(new sE)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function t4(){return Th=Th||document.querySelector("base"),Th?Th.getAttribute("href"):null}();return null==n?null:function n4(t){sm=sm||document.createElement("a"),sm.setAttribute("href",t);const e=sm.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){Th=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function QH(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[i,s]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let sm,Th=null,i4=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac})}return t})();const oE=new ye("EventManagerPlugins");let pP=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(i=>{i.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,i){return this._findPluginFor(r).addEventListener(n,r,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(s=>s.supports(n)),!r)throw new ie(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||t)(pe(oE),pe(Rt))};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac})}return t})();class gP{constructor(e){this._doc=e}}const aE="ng-app-id";let mP=(()=>{class t{constructor(n,r,i,s={}){this.doc=n,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=nm(s),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(i=>i.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${aE}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(n,r){const i=this.styleRef;if(i.has(n)){const s=i.get(n);return s.usage+=r,s.usage}return i.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===n)return i.delete(r),s.removeAttribute(aE),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(aE,this.appId),o}}addStyleToHost(n,r){const i=this.getStyleElement(n,r);n.appendChild(i);const s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||t)(pe(Ha),pe(gv),pe(CA,8),pe(Ks))};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac})}return t})();const uE={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},cE=/%COMP%/g,u4=new ye("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function yP(t,e){return e.map(n=>n.replace(cE,t))}let vP=(()=>{class t{constructor(n,r,i,s,o,a,u,l=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=nm(a),this.defaultRenderer=new lE(n,o,u,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===ii.ShadowDom&&(r={...r,encapsulation:ii.Emulated});const i=this.getOrCreateRenderer(n,r);return i instanceof EP?i.applyToHost(n):i instanceof dE&&i.applyStyles(),i}getOrCreateRenderer(n,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(r.encapsulation){case ii.Emulated:s=new EP(u,l,r,this.appId,h,o,a,g);break;case ii.ShadowDom:return new h4(u,l,n,r,o,a,this.nonce,g);default:s=new dE(u,l,r,h,o,a,g)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||t)(pe(pP),pe(mP),pe(gv),pe(u4),pe(Ha),pe(Ks),pe(Rt),pe(CA))};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac})}return t})();class lE{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(uE[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(IP(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(IP(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new ie(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;const s=uE[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const i=uE[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Bo.DashCase|Bo.Important)?e.style.setProperty(n,r,i&Bo.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Bo.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=$I().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function IP(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class h4 extends lE{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=yP(i.id,i.styles);for(const h of l){const g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=h,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class dE extends lE{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?yP(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class EP extends dE{constructor(e,n,r,i,s,o,a,u){const l=i+"-"+r.id;super(e,n,r,s,o,a,u,l),this.contentAttr=function c4(t){return"_ngcontent-%COMP%".replace(cE,t)}(l),this.hostAttr=function l4(t){return"_nghost-%COMP%".replace(cE,t)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let f4=(()=>{class t extends gP{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,i){return n.addEventListener(r,i,!1),()=>this.removeEventListener(n,r,i)}removeEventListener(n,r,i){return n.removeEventListener(r,i)}static#e=this.\u0275fac=function(r){return new(r||t)(pe(Ha))};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac})}return t})();const wP=["alt","control","meta","shift"],p4={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},g4={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let m4=(()=>{class t extends gP{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,i){const s=t.parseEventName(r),o=t.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$I().onAndCancel(n,s.domEventName,o))}static parseEventName(n){const r=n.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=t._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),wP.forEach(l=>{const h=r.indexOf(l);h>-1&&(r.splice(h,1),o+=l+".")}),o+=s,0!=r.length||0===s.length)return null;const u={};return u.domEventName=i,u.fullKey=o,u}static matchEventFullKeyCode(n,r){let i=p4[n.key]||n.key,s="";return r.indexOf("code.")>-1&&(i=n.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),wP.forEach(o=>{o!==i&&(0,g4[o])(n)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(n,r,i){return s=>{t.matchEventFullKeyCode(s,n)&&i.runGuarded(()=>r(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||t)(pe(Ha))};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac})}return t})();function TP(t){return{appProviders:[...T4,...t?.providers??[]],platformProviders:E4}}const E4=[{provide:Ks,useValue:"browser"},{provide:AA,useValue:function y4(){sE.makeCurrent()},multi:!0},{provide:Ha,useFactory:function I4(){return function jF(t){tv=t}(document),document},deps:[]}],T4=[{provide:dv,useValue:"root"},{provide:Qs,useFactory:function v4(){return new Qs},deps:[]},{provide:oE,useClass:f4,multi:!0,deps:[Ha,Rt,Ks]},{provide:oE,useClass:m4,multi:!0,deps:[Ha]},vP,mP,pP,{provide:xA,useExisting:vP},{provide:class Nz{},useClass:i4,deps:[]},[]];typeof window<"u"&&window;var W=Se(861),Un=Se(534);(0,Un.registerVersion)("firebase","10.6.0","app");class x4 extends gt{constructor(e,n){super()}schedule(e,n=0){return this}}const om={setInterval(t,e,...n){const{delegate:r}=om;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){const{delegate:e}=om;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};class SP extends x4{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return om.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;null!=n&&om.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,ve(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}const fE={now:()=>(fE.delegate||Date).now(),delegate:void 0};class Dh{constructor(e,n=Dh.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}}Dh.now=fE.now;class bP extends Dh{constructor(e,n=Dh.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}const k4=new class O4 extends bP{}(class M4 extends SP{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}}),RP=new bP(SP),pE=new _g("ANGULARFIRE2_VERSION");const am=(t,e)=>{const n=e?[e]:(0,Un.getApps)(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};class mE{constructor(){return am(L4)}}const L4="app-check";function $c(){}class PP{zone;delegate;constructor(e,n=k4){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},n,r)}}class V4{zone;task=null;constructor(e){this.zone=e}call(e,n){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$c,{},$c,$c)),n.pipe(function F4(t,e,n){const r=T(t)||e||n?{next:t,error:e,complete:n}:t;return r?Y((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(de(s,u=>{var l;null===(l=r.next)||void 0===l||l.call(r,u),s.next(u)},()=>{var u;a=!1,null===(u=r.complete)||void 0===u||u.call(r),s.complete()},u=>{var l;a=!1,null===(l=r.error)||void 0===l||l.call(r,u),s.error(u)},()=>{var u,l;a&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(l=r.finalize)||void 0===l||l.call(r)}))}):Sn}({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let um=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new PP(Zone.current)),this.insideAngular=n.run(()=>new PP(Zone.current,RP)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(pe(Rt))};static \u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Hc(){const t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return t}function za(t){return Hc().ngZone.run(()=>t())}function ci(t){return function B4(t){return function(n){return(n=n.lift(new V4(t.ngZone))).pipe(Hn(t.outsideAngular),hn(t.insideAngular))}}(Hc())(t)}const j4=(t,e)=>function(){const r=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),za(()=>t.apply(void 0,r))},NP=(t,e)=>function(){let n;const r=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof r[s]&&(e&&(n||=za(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",$c,{},$c,$c))),r[s]=j4(r[s],n));const i=function U4(t){return Hc().ngZone.runOutsideAngular(()=>t())}(()=>t.apply(this,r));if(!e){if(i instanceof tt){const s=Hc();return i.pipe(Hn(s.outsideAngular),hn(s.insideAngular))}return za(()=>i)}return i instanceof tt?i.pipe(ci):i instanceof Promise?za(()=>new Promise((s,o)=>i.then(a=>za(()=>s(a)),a=>za(()=>o(a))))):"function"==typeof i&&n?function(){return setTimeout(()=>{n&&"scheduled"===n.state&&n.invoke()},10),i.apply(this,arguments)}:za(()=>i)};class zc{constructor(e){return e}}class xP{constructor(){return(0,Un.getApps)()}}const _E=new ye("angularfire2._apps"),H4={provide:zc,useFactory:function $4(t){return t&&1===t.length?t[0]:new zc((0,Un.getApp)())},deps:[[new Wr,_E]]},z4={provide:xP,deps:[[new Wr,_E]]};function q4(t){return(e,n)=>{const r=e.runOutsideAngular(()=>t(n));return new zc(r)}}let W4=(()=>{class t{constructor(n){(0,Un.registerVersion)("angularfire",pE.full,"core"),(0,Un.registerVersion)("angularfire",pE.full,"app"),(0,Un.registerVersion)("angular",OA.full,n.toString())}static \u0275fac=function(r){return new(r||t)(pe(Ks))};static \u0275mod=Ui({type:t});static \u0275inj=Ms({providers:[H4,z4]})}return t})();const Z4=NP(Un.initializeApp,!0);Se(562);var Dt=Se(58),ys=Se(879),yE=Se(537);class OP{constructor(){return am("auth")}}var le,J4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zi={},EE=EE||{},Ue=J4||self;function cm(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Ah(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var wE="closure_uid_"+(1e9*Math.random()>>>0),eq=0;function tq(t,e,n){return t.call.apply(t.bind,arguments)}function nq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function _r(t,e,n){return(_r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?tq:nq).apply(null,arguments)}function lm(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Kn(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function qo(){this.s=this.s,this.o=this.o}qo.prototype.s=!1,qo.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function X4(t){Object.prototype.hasOwnProperty.call(t,wE)&&t[wE]||(t[wE]=++eq)}(this)},qo.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const kP=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function TE(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function FP(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(cm(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function yr(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}yr.prototype.h=function(){this.defaultPrevented=!0};var iq=function(){if(!Ue.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Ue.addEventListener("test",()=>{},e),Ue.removeEventListener("test",()=>{},e)}catch{}return t}();function Ch(t){return/^[\s\xa0]*$/.test(t)}function dm(){var t=Ue.navigator;return t&&(t=t.userAgent)?t:""}function vs(t){return-1!=dm().indexOf(t)}function DE(t){return DE[" "](t),t}DE[" "]=function(){};var CE,t,oq=vs("Opera"),qc=vs("Trident")||vs("MSIE"),LP=vs("Edge"),AE=LP||qc,VP=vs("Gecko")&&!(-1!=dm().toLowerCase().indexOf("webkit")&&!vs("Edge"))&&!(vs("Trident")||vs("MSIE"))&&!vs("Edge"),aq=-1!=dm().toLowerCase().indexOf("webkit")&&!vs("Edge");function UP(){var t=Ue.document;return t?t.documentMode:void 0}e:{var SE="",bE=(t=dm(),VP?/rv:([^\);]+)(\)|;)/.exec(t):LP?/Edge\/([\d\.]+)/.exec(t):qc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):aq?/WebKit\/(\S+)/.exec(t):oq?/(?:Version)[ \/]?(\S+)/.exec(t):void 0);if(bE&&(SE=bE?bE[1]:""),qc){var RE=UP();if(null!=RE&&RE>parseFloat(SE)){CE=String(RE);break e}}CE=SE}var uq=Ue.document&&qc&&(UP()||parseInt(CE,10))||void 0;function Sh(t,e){if(yr.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(VP){e:{try{DE(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:cq[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Sh.$.h.call(this)}}Kn(Sh,yr);var cq={2:"touch",3:"pen",4:"mouse"};Sh.prototype.h=function(){Sh.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var bh="closure_listenable_"+(1e6*Math.random()|0),lq=0;function dq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++lq,this.fa=this.ia=!1}function hm(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function NE(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function jP(t){const e={};for(const n in t)e[n]=t[n];return e}const $P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function HP(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let s=0;s<$P.length;s++)n=$P[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function fm(t){this.src=t,this.g={},this.h=0}function xE(t,e){var n=e.type;if(n in t.g){var s,r=t.g[n],i=kP(r,e);(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(hm(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function ME(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}fm.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=ME(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new dq(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var OE="closure_lm_"+(1e6*Math.random()|0),kE={};function zP(t,e,n,r,i){if(r&&r.once)return WP(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)zP(t,e[s],n,r,i);return null}return n=UE(n),t&&t[bh]?t.O(e,n,Ah(r)?!!r.capture:!!r,i):qP(t,e,n,!1,r,i)}function qP(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Ah(i)?!!i.capture:!!i,a=LE(t);if(a||(t[OE]=a=new fm(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function fq(){const e=pq;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)iq||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(ZP(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function WP(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)WP(t,e[s],n,r,i);return null}return n=UE(n),t&&t[bh]?t.P(e,n,Ah(r)?!!r.capture:!!r,i):qP(t,e,n,!0,r,i)}function GP(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)GP(t,e[s],n,r,i);else r=Ah(r)?!!r.capture:!!r,n=UE(n),t&&t[bh]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=ME(s=t.g[e],n,r,i))&&(hm(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=LE(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ME(e,n,r,i)),(n=-1<t?e[t]:null)&&FE(n))}function FE(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[bh])xE(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ZP(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=LE(e))?(xE(n,t),0==n.h&&(n.src=null,e[OE]=null)):hm(t)}}}function ZP(t){return t in kE?kE[t]:kE[t]="on"+t}function pq(t,e){if(t.fa)t=!0;else{e=new Sh(e,this);var n=t.listener,r=t.la||t.src;t.ia&&FE(t),t=n.call(r,e)}return t}function LE(t){return(t=t[OE])instanceof fm?t:null}var VE="__closure_events_fn_"+(1e9*Math.random()>>>0);function UE(t){return"function"==typeof t?t:(t[VE]||(t[VE]=function(e){return t.handleEvent(e)}),t[VE])}function Qn(){qo.call(this),this.i=new fm(this),this.S=this,this.J=null}function or(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new yr(e,t);else if(e instanceof yr)e.target=e.target||t;else{var i=e;HP(e=new yr(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=pm(o,r,!0,e)&&i}if(i=pm(o=e.g=t,r,!0,e)&&i,i=pm(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=pm(o=e.g=n[s],r,!1,e)&&i}function pm(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&xE(t.i,o),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Kn(Qn,qo),Qn.prototype[bh]=!0,Qn.prototype.removeEventListener=function(t,e,n,r){GP(this,t,e,n,r)},Qn.prototype.N=function(){if(Qn.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)hm(n[r]);delete t.g[e],t.h--}}this.J=null},Qn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Qn.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var BE=Ue.JSON.stringify;function mq(){var t=jE;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var KP=new class gq{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new yq,t=>t.reset());class yq{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function vq(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Iq(t){Ue.setTimeout(()=>{throw t},0)}let Rh,Ph=!1,jE=new class _q{constructor(){this.h=this.g=null}add(e,n){const r=KP.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},QP=()=>{const t=Ue.Promise.resolve(void 0);Rh=()=>{t.then(Eq)}};var Eq=()=>{for(var t;t=mq();){try{t.h.call(t.g)}catch(n){Iq(n)}var e=KP;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ph=!1};function gm(t,e){Qn.call(this),this.h=t||1,this.g=e||Ue,this.j=_r(this.qb,this),this.l=Date.now()}function $E(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function HE(t,e,n){if("function"==typeof t)n&&(t=_r(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_r(t.handleEvent,t)}return 2147483647<Number(e)?-1:Ue.setTimeout(t,e||0)}function YP(t){t.g=HE(()=>{t.g=null,t.i&&(t.i=!1,YP(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Kn(gm,Qn),(le=gm.prototype).ga=!1,le.T=null,le.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),or(this,"tick"),this.ga&&($E(this),this.start()))}},le.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},le.N=function(){gm.$.N.call(this),$E(this),delete this.g};class wq extends qo{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:YP(this)}N(){super.N(),this.g&&(Ue.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nh(t){qo.call(this),this.h=t,this.g={}}Kn(Nh,qo);var JP=[];function XP(t,e,n,r){Array.isArray(n)||(n&&(JP[0]=n.toString()),n=JP);for(var i=0;i<n.length;i++){var s=zP(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function eN(t){NE(t.g,function(e,n){this.g.hasOwnProperty(n)&&FE(e)},t),t.g={}}function mm(){this.g=!0}function Wc(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Cq(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return BE(n)}catch{return e}}(t,n)+(r?" "+r:"")})}Nh.prototype.N=function(){Nh.$.N.call(this),eN(this)},Nh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},mm.prototype.Ea=function(){this.g=!1},mm.prototype.info=function(){};var qa={},tN=null;function _m(){return tN=tN||new Qn}function nN(t){yr.call(this,qa.Ta,t)}function xh(t){const e=_m();or(e,new nN(e))}function rN(t,e){yr.call(this,qa.STAT_EVENT,t),this.stat=e}function Lr(t){const e=_m();or(e,new rN(e,t))}function iN(t,e){yr.call(this,qa.Ua,t),this.size=e}function Mh(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Ue.setTimeout(function(){t()},e)}qa.Ta="serverreachability",Kn(nN,yr),qa.STAT_EVENT="statevent",Kn(rN,yr),qa.Ua="timingevent",Kn(iN,yr);var ym={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},sN={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function zE(){}function aN(){}zE.prototype.h=null;var GE,Oh={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function qE(){yr.call(this,"d")}function WE(){yr.call(this,"c")}function vm(){}function kh(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Nh(this),this.P=Sq,this.V=new gm(t=AE?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new uN}function uN(){this.i=null,this.g="",this.h=!1}Kn(qE,yr),Kn(WE,yr),Kn(vm,zE),vm.prototype.g=function(){return new XMLHttpRequest},vm.prototype.i=function(){return{}},GE=new vm;var Sq=45e3,ZE={},Im={};function KE(t,e,n){t.L=1,t.v=Dm(io(e)),t.s=n,t.S=!0,cN(t,null)}function cN(t,e){t.G=Date.now(),Fh(t),t.A=io(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),vN(n.i,"t",r),t.C=0,n=t.l.J,t.h=new uN,t.g=HN(t.l,n?e:null,!t.s),0<t.O&&(t.M=new wq(_r(t.Pa,t,t.g),t.O)),XP(t.U,t.g,"readystatechange",t.nb),e=t.I?jP(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),xh(),function Tq(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var l=a[u].split("=");if(1<l.length){var h=l[0];l=l[1];var g=h.split("_");o=2<=g.length&&"type"==g[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.j,t.u,t.A,t.m,t.W,t.s)}function lN(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.l.Ha}function dN(t,e,n){let i,r=!0;for(;!t.J&&t.C<n.length;){if(i=bq(t,n),i==Im){4==e&&(t.o=4,Lr(14),r=!1),Wc(t.j,t.m,null,"[Incomplete Response]");break}if(i==ZE){t.o=4,Lr(15),Wc(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Wc(t.j,t.m,i,null),QE(t,i)}lN(t)&&i!=Im&&i!=ZE&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,Lr(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),rw(e),e.M=!0,Lr(11))):(Wc(t.j,t.m,n,"[Invalid Chunked Response]"),Wa(t),Lh(t))}function bq(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Im:(n=Number(e.substring(n,r)),isNaN(n)?ZE:(r+=1)+n>e.length?Im:(e=e.slice(r,r+n),t.C=r+n,e))}function Fh(t){t.Y=Date.now()+t.P,hN(t,t.P)}function hN(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Mh(_r(t.lb,t),e)}function Em(t){t.B&&(Ue.clearTimeout(t.B),t.B=null)}function Lh(t){0==t.l.H||t.J||UN(t.l,t)}function Wa(t){Em(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,$E(t.V),eN(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function QE(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||YE(n.i,t)))if(!t.K&&YE(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break e;Pm(n),bm(n)}nw(n),Lr(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=Mh(_r(n.ib,n),6e3));if(1>=wN(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Za(n,11)}else if((t.K||n.g==t)&&Pm(n),!Ch(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const h=l[3];null!=h&&(n.ra=h,n.l.info("VER="+n.ra));const g=l[4];null!=g&&(n.Ga=g,n.l.info("SVER="+n.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(n.L=r=1.5*m,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const y=t.g;if(y){const D=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(D){var s=r.i;s.g||-1==D.indexOf("spdy")&&-1==D.indexOf("quic")&&-1==D.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(JE(s,s.h),s.h=null))}if(r.F){const C=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;C&&(r.Da=C,Gt(r.I,r.F,C))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=$N(r,r.J?r.pa:null,r.Y),o.K){TN(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.B&&(Em(a),Fh(a)),r.g=o}else LN(r);0<n.j.length&&Rm(n)}else"stop"!=l[0]&&"close"!=l[0]||Za(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Za(n,7):tw(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}xh()}catch{}}function fN(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(cm(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function Pq(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(cm(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function Rq(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(cm(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(le=kh.prototype).setTimeout=function(t){this.P=t},le.nb=function(t){t=t.target;const e=this.M;e&&3==Is(t)?e.l():this.Pa(t)},le.Pa=function(t){try{if(t==this.g)e:{const h=Is(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||AE||this.g&&(this.h.h||this.g.ja()||NN(this.g)))){this.J||4!=h||7==e||xh(),Em(this);var n=this.g.da();this.ca=n;t:if(lN(this)){var r=NN(this.g);t="";var i=r.length,s=4==Is(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Wa(this),Lh(this);var o="";break t}this.h.i=new Ue.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function Dq(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ch(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.o=3,Lr(12),Wa(this),Lh(this);break e}Wc(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,QE(this,n)}this.S?(dN(this,h,o),AE&&this.i&&3==h&&(XP(this.U,this.V,"tick",this.mb),this.V.start())):(Wc(this.j,this.m,o,null),QE(this,o)),4==h&&Wa(this),this.i&&!this.J&&(4==h?UN(this.l,this):(this.i=!1,Fh(this)))}else(function Zq(t){const e={};t=(t.g&&2<=Is(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(Ch(t[r]))continue;var n=vq(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function hq(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(r){return r.join(", ")})})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Lr(12)):(this.o=0,Lr(13)),Wa(this),Lh(this)}}}catch{}},le.mb=function(){if(this.g){var t=Is(this.g),e=this.g.ja();this.C<e.length&&(Em(this),dN(this,t,e),this.i&&4!=t&&Fh(this))}},le.cancel=function(){this.J=!0,Wa(this)},le.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function Aq(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(xh(),Lr(17)),Wa(this),this.o=2,Lh(this)):hN(this,this.Y-t)};var pN=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ga(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ga){this.h=t.h,wm(this,t.j),this.s=t.s,this.g=t.g,Tm(this,t.m),this.l=t.l;var e=t.i,n=new Bh;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),gN(this,n),this.o=t.o}else t&&(e=String(t).match(pN))?(this.h=!1,wm(this,e[1]||"",!0),this.s=Vh(e[2]||""),this.g=Vh(e[3]||"",!0),Tm(this,e[4]),this.l=Vh(e[5]||"",!0),gN(this,e[6]||"",!0),this.o=Vh(e[7]||"")):(this.h=!1,this.i=new Bh(null,this.h))}function io(t){return new Ga(t)}function wm(t,e,n){t.j=n?Vh(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Tm(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function gN(t,e,n){e instanceof Bh?(t.i=e,function Lq(t,e){e&&!t.j&&(Wo(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(_N(this,r),vN(this,i,n))},t)),t.j=e}(t.i,t.h)):(n||(e=Uh(e,kq)),t.i=new Bh(e,t.h))}function Gt(t,e,n){t.i.set(e,n)}function Dm(t){return Gt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Vh(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Uh(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,xq),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xq(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ga.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Uh(e,mN,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Uh(e,mN,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(Uh(n,"/"==n.charAt(0)?Oq:Mq,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Uh(n,Fq)),t.join("")};var mN=/[#\/\?@]/g,Mq=/[#\?:]/g,Oq=/[#\?]/g,kq=/[#\?@]/g,Fq=/#/g;function Bh(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Wo(t){t.g||(t.g=new Map,t.h=0,t.i&&function Nq(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function _N(t,e){Wo(t),e=Gc(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function yN(t,e){return Wo(t),e=Gc(t,e),t.g.has(e)}function vN(t,e,n){_N(t,e),0<n.length&&(t.i=null,t.g.set(Gc(t,e),TE(n)),t.h+=n.length)}function Gc(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function IN(t){this.l=t||Uq,t=Ue.PerformanceNavigationTiming?0<(t=Ue.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Ue.g&&Ue.g.Ka&&Ue.g.Ka()&&Ue.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(le=Bh.prototype).add=function(t,e){Wo(this),this.i=null,t=Gc(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},le.forEach=function(t,e){Wo(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)},le.ta=function(){Wo(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n},le.Z=function(t){Wo(this);let e=[];if("string"==typeof t)yN(this,t)&&(e=e.concat(this.g.get(Gc(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},le.set=function(t,e){return Wo(this),this.i=null,yN(this,t=Gc(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},le.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},le.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var Uq=10;function EN(t){return!!t.h||!!t.g&&t.g.size>=t.j}function wN(t){return t.h?1:t.g?t.g.size:0}function YE(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function JE(t,e){t.g?t.g.add(e):t.h=e}function TN(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function DN(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return TE(t.i)}IN.prototype.cancel=function(){if(this.i=DN(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var Bq=class{stringify(t){return Ue.JSON.stringify(t,void 0)}parse(t){return Ue.JSON.parse(t,void 0)}};function jq(){this.g=new Bq}function $q(t,e,n){const r=n||"";try{fN(t,function(i,s){let o=i;Ah(i)&&(o=BE(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Am(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function jh(t){this.l=t.ec||null,this.j=t.ob||!1}function Cm(t,e){Qn.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=XE,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Kn(jh,zE),jh.prototype.g=function(){return new Cm(this.l,this.j)},jh.prototype.i=function(t){return function(){return t}}({}),Kn(Cm,Qn);var XE=0;function AN(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function $h(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Hh(t)}function Hh(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(le=Cm.prototype).open=function(t,e){if(this.readyState!=XE)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Hh(this)},le.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Ue).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},le.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,$h(this)),this.readyState=XE},le.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Hh(this)),this.g&&(this.readyState=3,Hh(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Ue.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;AN(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},le.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?$h(this):Hh(this),3==this.readyState&&AN(this)}},le.Za=function(t){this.g&&(this.response=this.responseText=t,$h(this))},le.Ya=function(t){this.g&&(this.response=t,$h(this))},le.ka=function(){this.g&&$h(this)},le.setRequestHeader=function(t,e){this.v.append(t,e)},le.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},le.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Cm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var zq=Ue.JSON.parse;function gn(t){Qn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=CN,this.L=this.M=!1}Kn(gn,Qn);var CN="",qq=/^https?$/i,Wq=["POST","PUT"];function SN(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bN(t),Sm(t)}function bN(t){t.F||(t.F=!0,or(t,"complete"),or(t,"error"))}function RN(t){if(t.h&&typeof EE<"u"&&(!t.C[1]||4!=Is(t)||2!=t.da()))if(t.v&&4==Is(t))HE(t.La,0,t);else if(or(t,"readystatechange"),4==Is(t)){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(pN)[1]||null;!i&&Ue.self&&Ue.self.location&&(i=Ue.self.location.protocol.slice(0,-1)),r=!qq.test(i?i.toLowerCase():"")}n=r}if(n)or(t,"complete"),or(t,"success");else{t.m=6;try{var s=2<Is(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",bN(t)}}finally{Sm(t)}}}function Sm(t,e){if(t.g){PN(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||or(t,"ready");try{n.onreadystatechange=r}catch{}}}function PN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Ue.clearTimeout(t.A),t.A=null)}function Is(t){return t.g?t.g.readyState:0}function NN(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case CN:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function xN(t){let e="";return NE(t,function(n,r){e+=r,e+=":",e+=n,e+="\r\n"}),e}function ew(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=xN(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Gt(t,e,n))}function zh(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function MN(t){this.Ga=0,this.j=[],this.l=new mm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=zh("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=zh("baseRetryDelayMs",5e3,t),this.hb=zh("retryDelaySeedMs",1e4,t),this.eb=zh("forwardChannelMaxRetries",2,t),this.xa=zh("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new IN(t&&t.concurrentRequestLimit),this.Ja=new jq,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function tw(t){if(ON(t),3==t.H){var e=t.W++,n=io(t.I);if(Gt(n,"SID",t.K),Gt(n,"RID",e),Gt(n,"TYPE","terminate"),qh(t,n),(e=new kh(t,t.l,e)).L=2,e.v=Dm(io(n)),n=!1,Ue.navigator&&Ue.navigator.sendBeacon)try{n=Ue.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&Ue.Image&&((new Image).src=e.v,n=!0),n||(e.g=HN(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Fh(e)}jN(t)}function bm(t){t.g&&(rw(t),t.g.cancel(),t.g=null)}function ON(t){bm(t),t.u&&(Ue.clearTimeout(t.u),t.u=null),Pm(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Ue.clearTimeout(t.m),t.m=null)}function Rm(t){if(!EN(t.i)&&!t.m){t.m=!0;var e=t.Na;Rh||QP(),Ph||(Rh(),Ph=!0),jE.add(e,t),t.C=0}}function kN(t,e){var n;n=e?e.m:t.W++;const r=io(t.I);Gt(r,"SID",t.K),Gt(r,"RID",n),Gt(r,"AID",t.V),qh(t,r),t.o&&t.s&&ew(r,t.o,t.s),n=new kh(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=FN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),JE(t.i,n),KE(n,r,e)}function qh(t,e){t.na&&NE(t.na,function(n,r){Gt(e,r,n)}),t.h&&fN({},function(n,r){Gt(e,r,n)})}function FN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?_r(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){const o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let l=i[u].g;const h=i[u].map;if(l-=s,0>l)s=Math.max(0,i[u].g-100),a=!1;else try{$q(h,o,"req"+l+"_")}catch{r&&r(h)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function LN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Rh||QP(),Ph||(Rh(),Ph=!0),jE.add(e,t),t.A=0}}function nw(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Mh(_r(t.Ma,t),BN(t,t.A)),t.A++,0))}function rw(t){null!=t.B&&(Ue.clearTimeout(t.B),t.B=null)}function VN(t){t.g=new kh(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=io(t.wa);Gt(e,"RID","rpc"),Gt(e,"SID",t.K),Gt(e,"AID",t.V),Gt(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Gt(e,"TO",t.qa),Gt(e,"TYPE","xmlhttp"),qh(t,e),t.o&&t.s&&ew(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Dm(io(e)),n.s=null,n.S=!0,cN(n,t)}function Pm(t){null!=t.v&&(Ue.clearTimeout(t.v),t.v=null)}function UN(t,e){var n=null;if(t.g==e){Pm(t),rw(t),t.g=null;var r=2}else{if(!YE(t.i,e))return;n=e.F,TN(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;or(r=_m(),new iN(r,n)),Rm(t)}else LN(t);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==r&&function Kq(t,e){return!(wN(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Mh(_r(t.Na,t,e),BN(t,t.C)),t.C++,0)))}(t,e)||2==r&&nw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Za(t,5);break;case 4:Za(t,10);break;case 3:Za(t,6);break;default:Za(t,2)}}function BN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Za(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=_r(t.pb,t);n||(n=new Ga("//www.google.com/images/cleardot.gif"),Ue.location&&"http"==Ue.location.protocol||wm(n,"https"),Dm(n)),function Hq(t,e){const n=new mm;if(Ue.Image){const r=new Image;r.onload=lm(Am,n,r,"TestLoadImage: loaded",!0,e),r.onerror=lm(Am,n,r,"TestLoadImage: error",!1,e),r.onabort=lm(Am,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=lm(Am,n,r,"TestLoadImage: timeout",!1,e),Ue.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Lr(2);t.H=0,t.h&&t.h.za(e),jN(t),ON(t)}function jN(t){if(t.H=0,t.ma=[],t.h){const e=DN(t.i);(0!=e.length||0!=t.j.length)&&(FP(t.ma,e),FP(t.ma,t.j),t.i.i.length=0,TE(t.j),t.j.length=0),t.h.ya()}}function $N(t,e,n){var r=n instanceof Ga?io(n):new Ga(n);if(""!=r.g)e&&(r.g=e+"."+r.g),Tm(r,r.m);else{var i=Ue.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ga(null);r&&wm(s,r),e&&(s.g=e),i&&Tm(s,i),n&&(s.l=n),r=s}return e=t.Da,(n=t.F)&&e&&Gt(r,n,e),Gt(r,"VER",t.ra),qh(t,r),r}function HN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new gn(n&&t.Ha&&!t.va?new jh({ob:!0}):t.va)).Oa(t.J),e}function zN(){}function Nm(){if(qc&&!(10<=Number(uq)))throw Error("Environmental error: no available transport.")}function li(t,e){Qn.call(this),this.g=new MN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Ch(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Ch(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new Zc(this)}function qN(t){qE.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function WN(){WE.call(this),this.status=1}function Zc(t){this.g=t}function Ki(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function iw(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;var s=t.g[3],o=(e=t.g[0])+(s^(n=t.g[1])&((i=t.g[2])^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function At(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(le=gn.prototype).Oa=function(t){this.M=t},le.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():GE.g(),this.C=function oN(t){return t.h||(t.h=t.i())}(this.u?this.u:GE),this.g.onreadystatechange=_r(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){return void SN(this,s)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const s of r.keys())n.set(s,r.get(s))}r=Array.from(n.keys()).find(s=>"content-type"==s.toLowerCase()),i=Ue.FormData&&t instanceof Ue.FormData,!(0<=kP(Wq,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{PN(this),0<this.B&&((this.L=function Gq(t){return qc&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_r(this.ua,this)):this.A=HE(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){SN(this,s)}},le.ua=function(){typeof EE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,or(this,"timeout"),this.abort(8))},le.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,or(this,"complete"),or(this,"abort"),Sm(this))},le.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Sm(this,!0)),gn.$.N.call(this)},le.La=function(){this.s||(this.G||this.v||this.l?RN(this):this.kb())},le.kb=function(){RN(this)},le.isActive=function(){return!!this.g},le.da=function(){try{return 2<Is(this)?this.g.status:-1}catch{return-1}},le.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},le.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),zq(e)}},le.Ia=function(){return this.m},le.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(le=MN.prototype).ra=8,le.H=1,le.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new kh(this,this.l,t);let s=this.s;if(this.U&&(s?(s=jP(s),HP(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break e}if(4096===e||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=FN(this,i,e),Gt(n=io(this.I),"RID",t),Gt(n,"CVER",22),this.F&&Gt(n,"X-HTTP-Session-Id",this.F),qh(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(xN(s)))+"&"+e:this.o&&ew(n,this.o,s)),JE(this.i,i),this.bb&&Gt(n,"TYPE","init"),this.P?(Gt(n,"$req",e),Gt(n,"SID","null"),i.aa=!0,KE(i,n,null)):KE(i,n,e),this.H=2}}else 3==this.H&&(t?kN(this,t):0==this.j.length||EN(this.i)||kN(this))},le.Ma=function(){if(this.u=null,VN(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Mh(_r(this.jb,this),t)}},le.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Lr(10),bm(this),VN(this))},le.ib=function(){null!=this.v&&(this.v=null,bm(this),nw(this),Lr(19))},le.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Lr(2)):(this.l.info("Failed to ping google.com"),Lr(1))},le.isActive=function(){return!!this.h&&this.h.isActive(this)},(le=zN.prototype).Ba=function(){},le.Aa=function(){},le.za=function(){},le.ya=function(){},le.isActive=function(){return!0},le.Va=function(){},Nm.prototype.g=function(t,e){return new li(t,e)},Kn(li,Qn),li.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Lr(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=$N(t,null,t.Y),Rm(t)},li.prototype.close=function(){tw(this.g)},li.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=BE(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&Rm(e)},li.prototype.N=function(){this.g.h=null,delete this.j,tw(this.g),delete this.g,li.$.N.call(this)},Kn(qN,qE),Kn(WN,WE),Kn(Zc,zN),Zc.prototype.Ba=function(){or(this.g,"a")},Zc.prototype.Aa=function(t){or(this.g,new qN(t))},Zc.prototype.za=function(t){or(this.g,new WN)},Zc.prototype.ya=function(){or(this.g,"b")},Kn(Ki,function Qq(){this.blockSize=-1}),Ki.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ki.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)iw(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){iw(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){iw(this,r),i=0;break}}this.h=i,this.i+=e},Ki.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var Yq={};function sw(t){return-128<=t&&128>t?function sq(t,e){var n=Yq;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(e){return new At([0|e],0>e?-1:0)}):new At([0|t],0>t?-1:0)}function Es(t){if(isNaN(t)||!isFinite(t))return Kc;if(0>t)return ar(Es(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=ow;return new At(e,0)}var ow=4294967296,Kc=sw(0),aw=sw(1),ZN=sw(16777216);function so(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Oi(t){return-1==t.h}function ar(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new At(n,~t.h).add(aw)}function xm(t,e){return t.add(ar(e))}function Mm(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Wh(t,e){this.g=t,this.h=e}function Om(t,e){if(so(e))throw Error("division by zero");if(so(t))return new Wh(Kc,Kc);if(Oi(t))return e=Om(ar(t),e),new Wh(ar(e.g),ar(e.h));if(Oi(e))return e=Om(t,ar(e)),new Wh(ar(e.g),e.h);if(30<t.g.length){if(Oi(t)||Oi(e))throw Error("slowDivide_ only works with positive integers.");for(var n=aw,r=e;0>=r.X(t);)n=KN(n),r=KN(r);var i=Qc(n,1),s=Qc(r,1);for(r=Qc(r,2),n=Qc(n,2);!so(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Qc(r,1),n=Qc(n,1)}return e=xm(t,i.R(e)),new Wh(i,e)}for(i=Kc;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Es(n)).R(e);Oi(o)||0<o.X(t);)o=(s=Es(n-=r)).R(e);so(s)&&(s=aw),i=i.add(s),t=xm(t,o)}return new Wh(i,t)}function KN(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new At(n,t.h)}function Qc(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new At(i,t.h)}(le=At.prototype).ea=function(){if(Oi(this))return-ar(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:ow+r)*e,e*=ow}return t},le.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(so(this))return"0";if(Oi(this))return"-"+ar(this).toString(t);for(var e=Es(Math.pow(t,6)),n=this,r="";;){var i=Om(n,e).g,s=((0<(n=xm(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(so(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},le.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},le.X=function(t){return Oi(t=xm(this,t))?-1:so(t)?0:1},le.abs=function(){return Oi(this)?ar(this):this},le.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,n[i]=(o&=65535)<<16|(s&=65535)}return new At(n,-2147483648&n[n.length-1]?-1:0)},le.R=function(t){if(so(this)||so(t))return Kc;if(Oi(this))return Oi(t)?ar(this).R(ar(t)):ar(ar(this).R(t));if(Oi(t))return ar(this.R(ar(t)));if(0>this.X(ZN)&&0>t.X(ZN))return Es(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,u=65535&t.D(i);n[2*r+2*i]+=o*u,Mm(n,2*r+2*i),n[2*r+2*i+1]+=s*u,Mm(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Mm(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Mm(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new At(n,0)},le.gb=function(t){return Om(this,t).h},le.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new At(n,this.h&t.h)},le.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new At(n,this.h|t.h)},le.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new At(n,this.h^t.h)},Nm.prototype.createWebChannel=Nm.prototype.g,li.prototype.send=li.prototype.u,li.prototype.open=li.prototype.m,li.prototype.close=li.prototype.close,ym.NO_ERROR=0,ym.TIMEOUT=8,ym.HTTP_ERROR=6,sN.COMPLETE="complete",aN.EventType=Oh,Oh.OPEN="a",Oh.CLOSE="b",Oh.ERROR="c",Oh.MESSAGE="d",Qn.prototype.listen=Qn.prototype.O,gn.prototype.listenOnce=gn.prototype.P,gn.prototype.getLastError=gn.prototype.Sa,gn.prototype.getLastErrorCode=gn.prototype.Ia,gn.prototype.getStatus=gn.prototype.da,gn.prototype.getResponseJson=gn.prototype.Wa,gn.prototype.getResponseText=gn.prototype.ja,gn.prototype.send=gn.prototype.ha,gn.prototype.setWithCredentials=gn.prototype.Oa,Ki.prototype.digest=Ki.prototype.l,Ki.prototype.reset=Ki.prototype.reset,Ki.prototype.update=Ki.prototype.j,At.prototype.add=At.prototype.add,At.prototype.multiply=At.prototype.R,At.prototype.modulo=At.prototype.gb,At.prototype.compare=At.prototype.X,At.prototype.toNumber=At.prototype.ea,At.prototype.toString=At.prototype.toString,At.prototype.getBits=At.prototype.D,At.fromNumber=Es,At.fromString=function GN(t,e){if(0==t.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==t.charAt(0))return ar(GN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Es(Math.pow(e,8)),r=Kc,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Es(Math.pow(e,s)),r=r.R(s).add(Es(o))):r=(r=r.R(n)).add(Es(o))}return r};var Jq=Zi.createWebChannelTransport=function(){return new Nm},Xq=Zi.getStatEventTarget=function(){return _m()},uw=Zi.ErrorCode=ym,eW=Zi.EventType=sN,tW=Zi.Event=qa,QN=Zi.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},nW=Zi.FetchXmlHttpFactory=jh,km=Zi.WebChannel=aN,rW=Zi.XhrIo=gn,iW=Zi.Md5=Ki,Yc=Zi.Integer=At;const YN="@firebase/firestore";class Yn{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yn.UNAUTHENTICATED=new Yn(null),Yn.GOOGLE_CREDENTIALS=new Yn("google-credentials-uid"),Yn.FIRST_PARTY=new Yn("first-party-uid"),Yn.MOCK_USER=new Yn("mock-user");let Jc="10.5.2";const Go=new ys.Yd("@firebase/firestore");function Xc(){return Go.logLevel}function ne(t,...e){if(Go.logLevel<=ys.in.DEBUG){const n=e.map(cw);Go.debug(`Firestore (${Jc}): ${t}`,...n)}}function Dn(t,...e){if(Go.logLevel<=ys.in.ERROR){const n=e.map(cw);Go.error(`Firestore (${Jc}): ${t}`,...n)}}function Qr(t,...e){if(Go.logLevel<=ys.in.WARN){const n=e.map(cw);Go.warn(`Firestore (${Jc}): ${t}`,...n)}}function cw(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function ge(t="Unexpected state"){const e=`FIRESTORE (${Jc}) INTERNAL ASSERTION FAILED: `+t;throw Dn(e),new Error(e)}function we(t,e){t||ge()}function oe(t,e){return t}const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends Dt.ZR{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Bn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class JN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aW{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Yn.UNAUTHENTICATED))}shutdown(){}}class uW{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class cW{constructor(e){this.t=e,this.currentUser=Yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,n(l)):Promise.resolve();let o=new Bn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Bn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable((0,W.Z)(function*(){yield l.promise,yield s(r.currentUser)}))},u=l=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>u(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?u(l):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Bn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we("string"==typeof r.accessToken),new JN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return we(null===e||"string"==typeof e),new Yn(e)}}class lW{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Yn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class dW{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new lW(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class XN{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hW{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=s=>{null!=s.error&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(we("string"==typeof n.token),this.R=n.token,new XN(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function fW(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class ex{static newId(){const n=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=fW(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function Fe(t,e){return t<e?-1:t>e?1:0}function el(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function tx(t){return t+"\0"}class Jt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new J(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Jt.fromMillis(Date.now())}static fromDate(e){return Jt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Jt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Fe(this.nanoseconds,e.nanoseconds):Fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Te(e)}static min(){return new Te(new Jt(0,0))}static max(){return new Te(new Jt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Gh{constructor(e,n,r){void 0===n?n=0:n>e.length&&ge(),void 0===r?r=e.length-n:r>e.length-n&&ge(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===Gh.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Gh?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class lt extends Gh{construct(e,n,r){return new lt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new lt(n)}static emptyPath(){return new lt([])}}const pW=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zt extends Gh{construct(e,n,r){return new Zt(e,n,r)}static isValidIdentifier(e){return pW.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Zt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(0===r.length)throw new J(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new J(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new J(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new J(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zt(n)}static emptyPath(){return new Zt([])}}class ae{constructor(e){this.path=e}static fromPath(e){return new ae(lt.fromString(e))}static fromName(e){return new ae(lt.fromString(e).popFirst(5))}static empty(){return new ae(lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===lt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return lt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new lt(e.slice()))}}class tl{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function lw(t){return t.fields.find(e=>2===e.kind)}function Ka(t){return t.fields.filter(e=>2!==e.kind)}tl.UNKNOWN_ID=-1;class Qa{constructor(e,n){this.fieldPath=e,this.kind=n}}class nl{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new nl(0,di.min())}}function nx(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=Te.fromTimestamp(1e9===r?new Jt(n+1,0):new Jt(n,r));return new di(i,ae.empty(),e)}function rx(t){return new di(t.readTime,t.key,-1)}class di{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new di(Te.min(),ae.empty(),-1)}static max(){return new di(Te.max(),ae.empty(),-1)}}function dw(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=ae.comparator(t.documentKey,e.documentKey),0!==n?n:Fe(t.largestBatchId,e.largestBatchId))}const ix="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Zo(t){return hw.apply(this,arguments)}function hw(){return hw=(0,W.Z)(function*(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==ix)throw t;ne("LocalStore","Unexpectedly lost primary lease")}),hw.apply(this,arguments)}class O{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ge(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new O((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof O?n:O.resolve(n)}catch(n){return O.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):O.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):O.reject(n)}static resolve(e){return new O((n,r)=>{n(e)})}static reject(e){return new O((n,r)=>{r(e)})}static waitFor(e){return new O((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=O.resolve(!1);for(const r of e)n=n.next(i=>i?O.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new O((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let u=0;u<s;u++){const l=u;n(e[l]).next(h=>{o[l]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,n){return new O((r,i)=>{const s=()=>{!0===e()?n().next(()=>{s()},i):r()};s()})}}class Fm{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Bn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Zh(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=fw(r.target.error);this.V.reject(new Zh(e,i))}}static open(e,n,r,i){try{return new Fm(n,e.transaction(i,r))}catch(s){throw new Zh(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(ne("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new yW(n)}}class Qi{constructor(e,n,r){this.name=e,this.version=n,this.p=r,12.2===Qi.S((0,Dt.z$)())&&Dn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ne("SimpleDb","Removing database:",e),Ya(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,Dt.hl)())return!1;if(Qi.C())return!0;const e=(0,Dt.z$)(),n=Qi.S(e),r=0<n&&n<10,i=Qi.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var n=this;return(0,W.Z)(function*(){return n.db||(ne("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,i)=>{const s=indexedDB.open(n.name,n.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new Zh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new J(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new J(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Zh(e,a))},s.onupgradeneeded=o=>{ne("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',o.oldVersion),n.p.N(o.target.result,s.transaction,o.oldVersion,n.version).next(()=>{ne("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.B&&(n.db.onversionchange=r=>n.B(r)),n.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){var s=this;return(0,W.Z)(function*(){const o="readonly"===n;let a=0;for(;;){++a;try{s.db=yield s.O(e);const u=Fm.open(s.db,e,o?"readonly":"readwrite",r),l=i(u).next(h=>(u.g(),h)).catch(h=>(u.abort(h),O.reject(h))).toPromise();return l.catch(()=>{}),yield u.m,l}catch(u){const l=u,h="FirebaseError"!==l.name&&a<3;if(ne("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),s.close(),!h)return Promise.reject(l)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class _W{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ya(this.k.delete())}}class Zh extends J{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ko(t){return"IndexedDbTransactionError"===t.name}class yW{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(ne("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(ne("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ya(r)}add(e){return ne("SimpleDb","ADD",this.store.name,e,e),Ya(this.store.add(e))}get(e){return Ya(this.store.get(e)).next(n=>(void 0===n&&(n=null),ne("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return ne("SimpleDb","DELETE",this.store.name,e),Ya(this.store.delete(e))}count(){return ne("SimpleDb","COUNT",this.store.name),Ya(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),s=[];return this.G(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new O((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}j(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new O((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){ne("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.G(i,n)}Z(e){const n=this.cursor({});return new O((r,i)=>{n.onerror=s=>{const o=fw(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){const r=[];return new O((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const u=new _W(a),l=n(a.primaryKey,a.value,u);if(l instanceof O){const h=l.catch(g=>(u.done(),O.reject(g)));r.push(h)}u.isDone?i():null===u.$?a.continue():a.continue(u.$)}}).next(()=>O.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ya(t){return new O((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const i=fw(r.target.error);n(i)}})}let ox=!1;function fw(t){const e=Qi.S((0,Dt.z$)());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new J("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ox||(ox=!0,setTimeout(()=>{throw r},0)),r}}return t}class vW{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){var n=this;ne("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,W.Z)(function*(){n.task=null;try{ne("IndexBackiller",`Documents written: ${yield n.X.te()}`)}catch(r){Ko(r)?ne("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield Zo(r)}yield n.ee(6e4)}))}}class IW{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){var n=this;return(0,W.Z)(function*(){return n.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>n.ne(r,e))})()}ne(e,n){const r=new Set;let i=n,s=!0;return O.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return ne("IndexBackiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(ne("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=rx(s);dw(o,r)>0&&(r=o)}),new di(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}let hi=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Kh(t){return null==t}function Qh(t){return 0===t&&1/t==-1/0}function ax(t){return"number"==typeof t&&Number.isInteger(t)&&!Qh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function vr(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ux(e)),e=EW(t.get(n),e);return ux(e)}function EW(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=s}}return n}function ux(t){return t+"\x01\x01"}function ws(t){const e=t.length;if(we(e>=2),2===e)return we("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),lt.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("\x01",s);switch((o<0||o>n)&&ge(),t.charAt(o+1)){case"\x01":const a=t.substring(s,o);let u;0===i.length?u=a:(i+=a,u=i,i=""),r.push(u);break;case"\x10":i+=t.substring(s,o),i+="\0";break;case"\x11":i+=t.substring(s,o+1);break;default:ge()}s=o+2}return new lt(r)}const cx=["userId","batchId"];function Lm(t,e){return[t,vr(e)]}function lx(t,e,n){return[t,vr(e),n]}const wW={},TW=["prefixPath","collectionGroup","readTime","documentId"],DW=["prefixPath","collectionGroup","documentId"],AW=["collectionGroup","readTime","prefixPath","documentId"],CW=["canonicalId","targetId"],SW=["targetId","path"],bW=["path","targetId"],RW=["collectionId","parent"],PW=["indexId","uid"],NW=["uid","sequenceNumber"],xW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],MW=["indexId","uid","orderedDocumentKey"],OW=["userId","collectionPath","documentId"],kW=["userId","collectionPath","largestBatchId"],FW=["userId","collectionGroup","largestBatchId"],dx=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],LW=[...dx,"documentOverlays"],hx=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fx=hx,VW=[...fx,"indexConfiguration","indexState","indexEntries"];class pw extends sx{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}}function Jn(t,e){const n=oe(t);return Qi.M(n.ae,e)}function px(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Qo(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Vt{constructor(e,n){this.comparator=e,this.root=n||ur.EMPTY}insert(e,n){return new Vt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ur.BLACK,null,null))}remove(e){return new Vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ur.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vm(this.root,e,this.comparator,!0)}}class Vm{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ur{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ur.RED,this.left=i??ur.EMPTY,this.right=s??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new ur(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):0===s?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return ur.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ge();const e=this.left.check();if(e!==this.right.check())throw ge();return e+(this.isRed()?0:1)}}ur.EMPTY=null,ur.RED=!0,ur.BLACK=!1,ur.EMPTY=new class{constructor(){this.size=0}get key(){throw ge()}get value(){throw ge()}get color(){throw ge()}get left(){throw ge()}get right(){throw ge()}copy(e,n,r,i,s){return this}insert(e,n,r){return new ur(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Pt{constructor(e){this.comparator=e,this.data=new Vt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new mx(this.data.getIterator())}getIteratorFrom(e){return new mx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Pt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Pt(this.comparator);return n.data=e,n}}class mx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function rl(t){return t.hasNext()?t.getNext():void 0}class Yr{constructor(e){this.fields=e,e.sort(Zt.comparator)}static empty(){return new Yr([])}unionWith(e){let n=new Pt(Zt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return el(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class _x extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class jn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new _x("Invalid base64 string: "+s):s}}(e);return new jn(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new jn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jn.EMPTY_BYTE_STRING=new jn("");const BW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yo(t){if(we(!!t),"string"==typeof t){let e=0;const n=BW.exec(t);if(we(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mn(t.seconds),nanos:mn(t.nanos)}}function mn(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function oo(t){return"string"==typeof t?jn.fromBase64String(t):jn.fromUint8Array(t)}function Um(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Bm(t){const e=t.mapValue.fields.__previous_value__;return Um(e)?Bm(e):e}function Yh(t){const e=Yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Jt(e.seconds,e.nanos)}class jW{constructor(e,n,r,i,s,o,a,u,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}}class Jo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Jo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Jo&&e.projectId===this.projectId&&e.database===this.database}}const Xo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},jm={nullValue:"NULL_VALUE"};function ea(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Um(t)?4:Ex(t)?9007199254740991:10:ge()}function Ts(t,e){if(t===e)return!0;const n=ea(t);if(n!==ea(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yh(t).isEqual(Yh(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Yo(i.timestampValue),a=Yo(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return s=e,oo(t.bytesValue).isEqual(oo(s.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return mn(i.geoPointValue.latitude)===mn(s.geoPointValue.latitude)&&mn(i.geoPointValue.longitude)===mn(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return mn(i.integerValue)===mn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=mn(i.doubleValue),a=mn(s.doubleValue);return o===a?Qh(o)===Qh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return el(t.arrayValue.values||[],e.arrayValue.values||[],Ts);case 10:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(px(o)!==px(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(void 0===a[u]||!Ts(o[u],a[u])))return!1;return!0}(t,e);default:return ge()}var s}function Jh(t,e){return void 0!==(t.values||[]).find(n=>Ts(n,e))}function ta(t,e){if(t===e)return 0;const n=ea(t),r=ea(e);if(n!==r)return Fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Fe(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=mn(s.integerValue||s.doubleValue),u=mn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return yx(t.timestampValue,e.timestampValue);case 4:return yx(Yh(t),Yh(e));case 5:return Fe(t.stringValue,e.stringValue);case 6:return function(s,o){const a=oo(s),u=oo(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){const h=Fe(a[l],u[l]);if(0!==h)return h}return Fe(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=Fe(mn(s.latitude),mn(o.latitude));return 0!==a?a:Fe(mn(s.longitude),mn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const a=s.values||[],u=o.values||[];for(let l=0;l<a.length&&l<u.length;++l){const h=ta(a[l],u[l]);if(h)return h}return Fe(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Xo.mapValue&&o===Xo.mapValue)return 0;if(s===Xo.mapValue)return 1;if(o===Xo.mapValue)return-1;const a=s.fields||{},u=Object.keys(a),l=o.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let g=0;g<u.length&&g<h.length;++g){const m=Fe(u[g],h[g]);if(0!==m)return m;const y=ta(a[u[g]],l[h[g]]);if(0!==y)return y}return Fe(u.length,h.length)}(t.mapValue,e.mapValue);default:throw ge()}}function yx(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Fe(t,e);const n=Yo(t),r=Yo(e),i=Fe(n.seconds,r.seconds);return 0!==i?i:Fe(n.nanos,r.nanos)}function il(t){return gw(t)}function gw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Yo(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?oo(t.bytesValue).toBase64():"referenceValue"in t?ae.fromName(t.referenceValue).toString():"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=gw(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${gw(n.fields[o])}`;return i+"}"}(t.mapValue):ge()}function Ja(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mw(t){return!!t&&"integerValue"in t}function Xh(t){return!!t&&"arrayValue"in t}function vx(t){return!!t&&"nullValue"in t}function Ix(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hm(t){return!!t&&"mapValue"in t}function ef(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Qo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ef(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ef(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Ex(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}function $W(t){return"nullValue"in t?jm:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ja(Jo.empty(),ae.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:ge()}function HW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ja(Jo.empty(),ae.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Xo:ge()}function wx(t,e){const n=ta(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Tx(t,e){const n=ta(t.value,e.value);return 0!==n?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}class cr{constructor(e){this.value=e}static empty(){return new cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Hm(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ef(n)}setAll(e){let n=Zt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ef(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Hm(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ts(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Hm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Qo(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new cr(ef(this.value))}}function Dx(t){const e=[];return Qo(t.fields,(n,r)=>{const i=new Zt([n]);if(Hm(r)){const s=Dx(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Yr(e)}class Kt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Kt(e,0,Te.min(),Te.min(),Te.min(),cr.empty(),0)}static newFoundDocument(e,n,r,i){return new Kt(e,1,n,Te.min(),r,i,0)}static newNoDocument(e,n){return new Kt(e,2,n,Te.min(),Te.min(),cr.empty(),0)}static newUnknownDocument(e,n){return new Kt(e,3,n,Te.min(),Te.min(),cr.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Te.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class na{constructor(e,n){this.position=e,this.inclusive=n}}function Ax(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?ae.comparator(ae.fromName(o.referenceValue),n.key):ta(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Cx(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ts(t.position[n],e.position[n]))return!1;return!0}class tf{constructor(e,n="asc"){this.field=e,this.dir=n}}function zW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Sx{}class at extends Sx{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new qW(e,n,r):"array-contains"===n?new ZW(e,r):"in"===n?new Mx(e,r):"not-in"===n?new KW(e,r):"array-contains-any"===n?new QW(e,r):new at(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new WW(e,r):new GW(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(ta(n,this.value)):null!==n&&ea(this.value)===ea(n)&&this.matchesComparison(ta(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ge()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ct extends Sx{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new Ct(e,n)}matches(e){return sl(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function sl(t){return"and"===t.op}function _w(t){return"or"===t.op}function yw(t){return bx(t)&&sl(t)}function bx(t){for(const e of t.filters)if(e instanceof Ct)return!1;return!0}function vw(t){if(t instanceof at)return t.field.canonicalString()+t.op.toString()+il(t.value);if(yw(t))return t.filters.map(e=>vw(e)).join(",");{const e=t.filters.map(n=>vw(n)).join(",");return`${t.op}(${e})`}}function Rx(t,e){return t instanceof at?(r=t,(i=e)instanceof at&&r.op===i.op&&r.field.isEqual(i.field)&&Ts(r.value,i.value)):t instanceof Ct?function(r,i){return i instanceof Ct&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&Rx(o,i.filters[a]),!0)}(t,e):void ge();var r,i}function Px(t,e){const n=t.filters.concat(e);return Ct.create(n,t.op)}function Nx(t){return t instanceof at?`${(n=t).field.canonicalString()} ${n.op} ${il(n.value)}`:t instanceof Ct?function(n){return n.op.toString()+" {"+n.getFilters().map(Nx).join(" ,")+"}"}(t):"Filter";var n}class qW extends at{constructor(e,n,r){super(e,n,r),this.key=ae.fromName(r.referenceValue)}matches(e){const n=ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class WW extends at{constructor(e,n){super(e,"in",n),this.keys=xx(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class GW extends at{constructor(e,n){super(e,"not-in",n),this.keys=xx(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xx(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>ae.fromName(r.referenceValue))}class ZW extends at{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Xh(n)&&Jh(n.arrayValue,this.value)}}class Mx extends at{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&Jh(this.value.arrayValue,n)}}class KW extends at{constructor(e,n){super(e,"not-in",n)}matches(e){if(Jh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!Jh(this.value.arrayValue,n)}}class QW extends at{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Xh(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Jh(this.value.arrayValue,r))}}class YW{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}}function Iw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new YW(t,e,n,r,i,s,o)}function Xa(t){const e=oe(t);if(null===e.ce){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vw(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Kh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>il(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>il(r)).join(",")),e.ce=n}return e.ce}function nf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zW(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Rx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cx(t.startAt,e.startAt)&&Cx(t.endAt,e.endAt)}function zm(t){return ae.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}function qm(t,e){return t.filters.filter(n=>n instanceof at&&n.field.isEqual(e))}function Ox(t,e,n){let r=jm,i=!0;for(const s of qm(t,e)){let o=jm,a=!0;switch(s.op){case"<":case"<=":o=$W(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=jm}wx({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];wx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}function kx(t,e,n){let r=Xo,i=!0;for(const s of qm(t,e)){let o=Xo,a=!0;switch(s.op){case">=":case">":o=HW(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Xo}Tx({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==n)for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Tx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}return{value:r,inclusive:i}}class ao{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null}}function Fx(t,e,n,r,i,s,o,a){return new ao(t,e,n,r,i,s,o,a)}function ol(t){return new ao(t)}function Lx(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Ew(t){return null!==t.collectionGroup}function al(t){const e=oe(t);if(null===e.le){e.le=[];const n=new Set;for(const s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Pt(Zt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new tf(s,r))}),n.has(Zt.keyField().canonicalString())||e.le.push(new tf(Zt.keyField(),r))}return e.le}function Vr(t){const e=oe(t);return e.he||(e.he=function Vx(t,e){if("F"===t.limitType)return Iw(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>new tf(i.field,"desc"===i.dir?"asc":"desc"));const n=t.endAt?new na(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new na(t.startAt.position,t.startAt.inclusive):null;return Iw(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,al(t))),e.he}function ww(t,e){const n=t.filters.concat([e]);return new ao(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Wm(t,e,n){return new ao(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function rf(t,e){return nf(Vr(t),Vr(e))&&t.limitType===e.limitType}function Ux(t){return`${Xa(Vr(t))}|lt:${t.limitType}`}function ul(t){return`Query(target=${function(n){let r=n.path.canonicalString();return null!==n.collectionGroup&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Nx(i)).join(", ")}]`),Kh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>il(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>il(i)).join(",")),`Target(${r})`}(Vr(t))}; limitType=${t.limitType})`}function sf(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ae.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of al(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&(i=e,!((r=t).startAt&&!function(o,a,u){const l=Ax(o,a,u);return o.inclusive?l<=0:l<0}(r.startAt,al(r),i)||r.endAt&&!function(o,a,u){const l=Ax(o,a,u);return o.inclusive?l>=0:l>0}(r.endAt,al(r),i)));var r,i}function Bx(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jx(t){return(e,n)=>{let r=!1;for(const i of al(t)){const s=JW(i,e,n);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function JW(t,e,n){const r=t.field.isKeyField()?ae.comparator(e.key,n.key):function(s,o,a){const u=o.data.field(s),l=a.data.field(s);return null!==u&&null!==l?ta(u,l):ge()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ge()}}class uo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Qo(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return gx(this.inner)}size(){return this.innerSize}}const XW=new Vt(ae.comparator);function Jr(){return XW}const $x=new Vt(ae.comparator);function of(...t){let e=$x;for(const n of t)e=e.insert(n.key,n);return e}function Hx(t){let e=$x;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ds(){return af()}function zx(){return af()}function af(){return new uo(t=>t.toString(),(t,e)=>t.isEqual(e))}const e9=new Vt(ae.comparator),t9=new Pt(ae.comparator);function He(...t){let e=t9;for(const n of t)e=e.add(n);return e}const n9=new Pt(Fe);function Tw(){return n9}function qx(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qh(e)?"-0":e}}function Wx(t){return{integerValue:""+t}}function Gx(t,e){return ax(e)?Wx(e):qx(t,e)}class Gm{constructor(){this._=void 0}}function r9(t,e,n){return t instanceof cl?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Um(s)&&(s=Bm(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof eu?Kx(t,e):t instanceof tu?Qx(t,e):function(i,s){const o=Zx(i,s),a=Yx(o)+Yx(i.Ie);return mw(o)&&mw(i.Ie)?Wx(a):qx(i.serializer,a)}(t,e)}function i9(t,e,n){return t instanceof eu?Kx(t,e):t instanceof tu?Qx(t,e):n}function Zx(t,e){return t instanceof ll?mw(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class cl extends Gm{}class eu extends Gm{constructor(e){super(),this.elements=e}}function Kx(t,e){const n=Jx(e);for(const r of t.elements)n.some(i=>Ts(i,r))||n.push(r);return{arrayValue:{values:n}}}class tu extends Gm{constructor(e){super(),this.elements=e}}function Qx(t,e){let n=Jx(e);for(const r of t.elements)n=n.filter(i=>!Ts(i,r));return{arrayValue:{values:n}}}class ll extends Gm{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function Yx(t){return mn(t.integerValue||t.doubleValue)}function Jx(t){return Xh(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class uf{constructor(e,n){this.field=e,this.transform=n}}class o9{constructor(e,n){this.version=e,this.transformResults=n}}class Xt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Xt}static exists(e){return new Xt(void 0,e)}static updateTime(e){return new Xt(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zm(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Km{}function Xx(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new hl(t.key,Xt.none()):new dl(t.key,t.data,Xt.none());{const n=t.data,r=cr.empty();let i=new Pt(Zt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);null===o&&s.length>1&&(s=s.popLast(),o=n.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new co(t.key,r,new Yr(i.toArray()),Xt.none())}}function a9(t,e,n){t instanceof dl?function(i,s,o){const a=i.value.clone(),u=nM(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof co?function(i,s,o){if(!Zm(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=nM(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(tM(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function cf(t,e,n,r){return t instanceof dl?function(s,o,a,u){if(!Zm(s.precondition,o))return a;const l=s.value.clone(),h=rM(s.fieldTransforms,u,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof co?function(s,o,a,u){if(!Zm(s.precondition,o))return a;const l=rM(s.fieldTransforms,u,o),h=o.data;return h.setAll(tM(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(t,e,n,r):(a=n,Zm(t.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function u9(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Zx(r.transform,i||null);null!=s&&(null===n&&(n=cr.empty()),n.set(r.field,s))}return n||null}function eM(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=t.fieldTransforms)&&void 0===i||r&&i&&el(r,i,(s,o)=>function s9(t,e){return t.field.isEqual(e.field)&&(i=e.transform,(r=t.transform)instanceof eu&&i instanceof eu||r instanceof tu&&i instanceof tu?el(r.elements,i.elements,Ts):r instanceof ll&&i instanceof ll?Ts(r.Ie,i.Ie):r instanceof cl&&i instanceof cl);var r,i}(s,o))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var r,i}class dl extends Km{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class co extends Km{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function tM(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function nM(t,e,n){const r=new Map;we(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,i9(o,a,n[i]))}return r}function rM(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,r9(s,o,e))}return r}class hl extends Km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Dw extends Km{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Aw{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&a9(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=cf(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=cf(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=zx();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const u=Xx(o,a);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),He())}isEqual(e){return this.batchId===e.batchId&&el(this.mutations,e.mutations,(n,r)=>eM(n,r))&&el(this.baseMutations,e.baseMutations,(n,r)=>eM(n,r))}}class Cw{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){we(e.mutations.length===r.length);let i=e9;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Cw(e,n,r,i)}}class Sw{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class l9{constructor(e,n){this.count=e,this.unchangedNames=n}}var Pn,dt;function iM(t){switch(t){default:return ge();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function sM(t){if(void 0===t)return Dn("GRPC error has no .code"),B.UNKNOWN;switch(t){case Pn.OK:return B.OK;case Pn.CANCELLED:return B.CANCELLED;case Pn.UNKNOWN:return B.UNKNOWN;case Pn.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Pn.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Pn.INTERNAL:return B.INTERNAL;case Pn.UNAVAILABLE:return B.UNAVAILABLE;case Pn.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Pn.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Pn.NOT_FOUND:return B.NOT_FOUND;case Pn.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Pn.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Pn.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Pn.ABORTED:return B.ABORTED;case Pn.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Pn.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Pn.DATA_LOSS:return B.DATA_LOSS;default:return ge()}}(dt=Pn||(Pn={}))[dt.OK=0]="OK",dt[dt.CANCELLED=1]="CANCELLED",dt[dt.UNKNOWN=2]="UNKNOWN",dt[dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",dt[dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",dt[dt.NOT_FOUND=5]="NOT_FOUND",dt[dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",dt[dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",dt[dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",dt[dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",dt[dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",dt[dt.ABORTED=10]="ABORTED",dt[dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",dt[dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",dt[dt.INTERNAL=13]="INTERNAL",dt[dt.UNAVAILABLE=14]="UNAVAILABLE",dt[dt.DATA_LOSS=15]="DATA_LOSS";function oM(){return new TextEncoder}const d9=new Yc([4294967295,4294967295],0);function aM(t){const e=oM().encode(t),n=new iW;return n.update(e),new Uint8Array(n.digest())}function uM(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Yc([n,r],0),new Yc([i,s],0)]}class bw{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new lf(`Invalid padding: ${n}`);if(r<0)throw new lf(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new lf(`Invalid hash count: ${r}`);if(0===e.length&&0!==n)throw new lf(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Yc.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Yc.fromNumber(r)));return 1===i.compare(d9)&&(i=new Yc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const n=aM(e),[r,i]=uM(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new bw(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Te)return;const n=aM(e),[r,i]=uM(n);for(let s=0;s<this.hashCount;s++){const o=this.de(r,i,s);this.Re(o)}}Re(e){const n=Math.floor(e/8);this.bitmap[n]|=1<<e%8}}class lf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class df{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,hf.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new df(Te.min(),i,new Vt(Fe),Jr(),He())}}class hf{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hf(r,n,He(),He(),He())}}class Ym{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}}class cM{constructor(e,n){this.targetId=e,this.fe=n}}class lM{constructor(e,n,r=jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class dM{constructor(){this.ge=0,this.pe=fM(),this.ye=jn.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=He(),n=He(),r=He();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ge()}}),new hf(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=fM()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1}Be(){this.Se=!0,this.we=!0}}class h9{constructor(e){this.Le=e,this.ke=new Map,this.qe=Jr(),this.Qe=hM(),this.Ke=new Vt(Fe)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:ge()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){const n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){const s=i.target;if(zm(s))if(0===r){const o=new ae(s.path);this.We(n,o,Kt.newNoDocument(o,Te.min()))}else we(1===r);else{const o=this.Ze(n);if(o!==r){const a=this.Xe(e),u=a?this.et(a,e,o):1;0!==u&&(this.He(n),this.Ke=this.Ke.insert(n,2===u?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=oo(r).toUint8Array()}catch(u){if(u instanceof _x)return Qr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new bw(o,i,s)}catch(u){return Qr(u instanceof lf?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return 0===a.Te?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){const n=new Map;this.ke.forEach((s,o)=>{const a=this.Ye(o);if(a){if(s.current&&zm(a.target)){const u=new ae(a.target.path);null!==this.qe.get(u)||this.st(o,u)||this.We(o,u,Kt.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=He();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{const l=this.Ye(u);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));const i=new df(e,n,this.Ke,this.qe,r);return this.qe=Jr(),this.Qe=hM(),this.Ke=new Vt(Fe),i}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new dM,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Pt(Fe),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=null!==this.Ye(e);return n||ne("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new dM),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function hM(){return new Vt(ae.comparator)}function fM(){return new Vt(ae.comparator)}const f9={asc:"ASCENDING",desc:"DESCENDING"},p9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g9={and:"AND",or:"OR"};class m9{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Rw(t,e){return t.useProto3Json||Kh(e)?e:{value:e}}function fl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pM(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _9(t,e){return fl(t,e.toTimestamp())}function An(t){return we(!!t),Te.fromTimestamp(function(n){const r=Yo(n);return new Jt(r.seconds,r.nanos)}(t))}function Pw(t,e){return(r=t,new lt(["projects",r.projectId,"databases",r.database])).child("documents").child(e).canonicalString();var r}function gM(t){const e=lt.fromString(t);return we(DM(e)),e}function ff(t,e){return Pw(t.databaseId,e.path)}function As(t,e){const n=gM(e);if(n.get(1)!==t.databaseId.projectId)throw new J(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ae(_M(n))}function Nw(t,e){return Pw(t.databaseId,e)}function mM(t){const e=gM(t);return 4===e.length?lt.emptyPath():_M(e)}function pf(t){return new lt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _M(t){return we(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function yM(t,e,n){return{name:ff(t,e),fields:n.value.mapValue.fields}}function vM(t,e,n){const r=As(t,e.name),i=An(e.updateTime),s=e.createTime?An(e.createTime):Te.min(),o=new cr({mapValue:{fields:e.fields}}),a=Kt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function gf(t,e){let n;if(e instanceof dl)n={update:yM(t,e.key,e.value)};else if(e instanceof hl)n={delete:ff(t,e.key)};else if(e instanceof co)n={update:yM(t,e.key,e.data),updateMask:A9(e.fieldMask)};else{if(!(e instanceof Dw))return ge();n={verify:ff(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof cl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof eu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof tu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ll)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw ge()}(0,r))),e.precondition.isNone||(n.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:_9(t,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:ge()),n;var s}function xw(t,e){const n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Xt.updateTime(An(s.updateTime)):void 0!==s.exists?Xt.exists(s.exists):Xt.none():Xt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;"setToServerValue"in a?(we("REQUEST_TIME"===a.setToServerValue),u=new cl):"appendMissingElements"in a?u=new eu(a.appendMissingElements.values||[]):"removeAllFromArray"in a?u=new tu(a.removeAllFromArray.values||[]):"increment"in a?u=new ll(o,a.increment):ge();const l=Zt.fromServerFormat(a.fieldPath);return new uf(l,u)}(t,i)):[];var s;if(e.update){const i=As(t,e.update.name),s=new cr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new Yr((e.updateMask.fieldPaths||[]).map(h=>Zt.fromServerFormat(h)));return new co(i,s,o,n,r)}return new dl(i,s,n,r)}if(e.delete){const i=As(t,e.delete);return new hl(i,n)}if(e.verify){const i=As(t,e.verify);return new Dw(i,n)}return ge()}function IM(t,e){return{documents:[Nw(t,e.path)]}}function Mw(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Nw(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Nw(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(u){if(0!==u.length)return TM(Ct.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const s=function(u){if(0!==u.length)return u.map(l=>{return{field:ra((g=l).field),direction:w9(g.dir)};var g})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Rw(t,e.limit);return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n;var u}function EM(t){let e=mM(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){we(1===r);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];n.where&&(s=function(g){const m=wM(g);return m instanceof Ct&&yw(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(m=>{return new tf(pl((D=m).field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction));var D}));let a=null;n.limit&&(a=function(g){let m;return m="object"==typeof g?g.value:g,Kh(m)?null:m}(n.limit));let u=null;var g;n.startAt&&(u=new na((g=n.startAt).values||[],!!g.before));let l=null;return n.endAt&&(l=function(g){return new na(g.values||[],!g.before)}(n.endAt)),Fx(e,i,o,s,a,"F",u,l)}function wM(t){return void 0!==t.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=pl(n.unaryFilter.field);return at.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=pl(n.unaryFilter.field);return at.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=pl(n.unaryFilter.field);return at.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=pl(n.unaryFilter.field);return at.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ge()}}(t):void 0!==t.fieldFilter?at.create(pl((n=t).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ge()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==t.compositeFilter?function(n){return Ct.create(n.compositeFilter.filters.map(r=>wM(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ge()}}(n.compositeFilter.op))}(t):ge();var n}function w9(t){return f9[t]}function T9(t){return p9[t]}function D9(t){return g9[t]}function ra(t){return{fieldPath:t.canonicalString()}}function pl(t){return Zt.fromServerFormat(t.fieldPath)}function TM(t){return t instanceof at?function(n){if("=="===n.op){if(Ix(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NAN"}};if(vx(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(Ix(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NOT_NAN"}};if(vx(n.value))return{unaryFilter:{field:ra(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ra(n.field),op:T9(n.op),value:n.value}}}(t):t instanceof Ct?function(n){const r=n.getFilters().map(i=>TM(i));return 1===r.length?r[0]:{compositeFilter:{op:D9(n.op),filters:r}}}(t):ge()}function A9(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function DM(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class lo{constructor(e,n,r,i,s=Te.min(),o=Te.min(),a=jn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new lo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new lo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class AM{constructor(e){this.ut=e}}function CM(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Jm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:ff(s=t.ut,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:fl(s,o.version.toTimestamp()),createTime:fl(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:nu(e.version)};else{if(!e.isUnknownDocument())return ge();r.unknownDocument={path:n.path.toArray(),version:nu(e.version)}}var s,o;return r}function Jm(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function nu(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ru(t){const e=new Jt(t.seconds,t.nanoseconds);return Te.fromTimestamp(e)}function iu(t,e){const n=(e.baseMutations||[]).map(s=>xw(t.ut,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>xw(t.ut,s)),i=Jt.fromMillis(e.localWriteTimeMs);return new Aw(e.batchId,i,n,r)}function mf(t){const e=ru(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?ru(t.lastLimboFreeSnapshotVersion):Te.min();let r;return r=void 0!==t.query.documents?(we(1===(s=t.query).documents.length),Vr(ol(mM(s.documents[0])))):function(s){return Vr(EM(s))}(t.query),new lo(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,jn.fromBase64String(t.resumeToken));var s}function SM(t,e){const n=nu(e.snapshotVersion),r=nu(e.lastLimboFreeSnapshotVersion);let i;i=zm(e.target)?IM(t.ut,e.target):Mw(t.ut,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Xa(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Ow(t){const e=EM({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Wm(e,e.limit,"L"):e}function kw(t,e){return new Sw(e.largestBatchId,xw(t.ut,e.overlayMutation))}function bM(t,e){const n=e.path.lastSegment();return[t,vr(e.path.popLast()),n]}function RM(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:nu(r.readTime),documentKey:vr(r.documentKey.path),largestBatchId:r.largestBatchId}}class S9{getBundleMetadata(e,n){return PM(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:ru(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return PM(e).put({bundleId:(i=n).id,createTime:nu(An(i.createTime)),version:i.version});var i}getNamedQuery(e,n){return NM(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:Ow(s.bundledQuery),readTime:ru(s.readTime)};var s})}saveNamedQuery(e,n){return NM(e).put({name:(i=n).name,readTime:nu(An(i.readTime)),bundledQuery:i.bundledQuery});var i}}function PM(t){return Jn(t,"bundles")}function NM(t){return Jn(t,"namedQueries")}class Xm{constructor(e,n){this.serializer=e,this.userId=n}static ct(e,n){return new Xm(e,n.uid||"")}getOverlay(e,n){return _f(e).get(bM(this.userId,n)).next(r=>r?kw(this.serializer,r):null)}getOverlays(e,n){const r=Ds();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Sw(n,o);i.push(this.lt(e,a))}),O.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(vr(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(_f(e).H("collectionPathOverlayIndex",a))}),O.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Ds(),s=vr(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return _f(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const l=kw(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Ds();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return _f(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,l,h)=>{const g=kw(this.serializer,l);s.size()<i||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):h.done()}).next(()=>s)}lt(e,n){return _f(e).put(function(i,s,o){const[a,u,l]=bM(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:gf(i.ut,o.mutation)}}(this.serializer,this.userId,n))}}function _f(t){return Jn(t,"documentOverlays")}class su{constructor(){}ht(e,n){this.Pt(e,n),n.It()}Pt(e,n){if("nullValue"in e)this.Tt(n,5);else if("booleanValue"in e)this.Tt(n,10),n.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(n,15),n.Et(mn(e.integerValue));else if("doubleValue"in e){const r=mn(e.doubleValue);isNaN(r)?this.Tt(n,13):(this.Tt(n,15),Qh(r)?n.Et(0):n.Et(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Tt(n,20),"string"==typeof r?n.dt(r):(n.dt(`${r.seconds||""}`),n.Et(r.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,n),this.Rt(n);else if("bytesValue"in e)this.Tt(n,30),n.Vt(oo(e.bytesValue)),this.Rt(n);else if("referenceValue"in e)this.ft(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Tt(n,45),n.Et(r.latitude||0),n.Et(r.longitude||0)}else"mapValue"in e?Ex(e)?this.Tt(n,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,n),this.Rt(n)):"arrayValue"in e?(this.yt(e.arrayValue,n),this.Rt(n)):ge()}At(e,n){this.Tt(n,25),this.wt(e,n)}wt(e,n){n.dt(e)}gt(e,n){const r=e.fields||{};this.Tt(n,55);for(const i of Object.keys(r))this.At(i,n),this.Pt(r[i],n)}yt(e,n){const r=e.values||[];this.Tt(n,50);for(const i of r)this.Pt(i,n)}ft(e,n){this.Tt(n,37),ae.fromName(e).path.forEach(r=>{this.Tt(n,60),this.wt(r,n)})}Tt(e,n){e.Et(n)}Rt(e){e.Et(2)}}function b9(t){if(0===t)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function xM(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=b9(255&r[s]);if(i+=o,8!==o)break}return i}(t);return Math.ceil(e/8)}su.St=new su;class R9{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Dt(r.value),r=n.next();this.Ct()}vt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Dt(r);else if(r<2048)this.Dt(960|r>>>6),this.Dt(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Dt(480|r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r);else{const i=n.codePointAt(0);this.Dt(240|i>>>18),this.Dt(128|63&i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i)}}this.Ct()}Ot(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\ud800"||"\udbff"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Nt(e){const n=this.Bt(e),r=xM(n);this.Lt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}kt(e){const n=this.Bt(e),r=xM(n);this.Lt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&n[0]);n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Dt(e){const n=255&e;0===n?(this.Qt(0),this.Qt(255)):255===n?(this.Qt(255),this.Qt(0)):this.Qt(n)}Ft(e){const n=255&e;0===n?(this.$t(0),this.$t(255)):255===n?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class P9{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class N9{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class yf{constructor(){this.Wt=new R9,this.Gt=new P9(this.Wt),this.zt=new N9(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class ou{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ht(){const e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new ou(this.indexId,this.documentKey,this.arrayValue,r)}}function ia(t,e){let n=t.indexId-e.indexId;return 0!==n?n:(n=MM(t.arrayValue,e.arrayValue),0!==n?n:(n=MM(t.directionalValue,e.directionalValue),0!==n?n:ae.comparator(t.documentKey,e.documentKey)))}function MM(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(0!==r)return r}return t.length-e.length}class OM{constructor(e){this.Jt=new Pt((n,r)=>Zt.comparator(n.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const n of e.filters){const r=n;r.isInequality()?this.Jt=this.Jt.add(r):this.Zt.push(r)}}get Xt(){return this.Jt.size>1}en(e){if(we(e.collectionGroup===this.collectionId),this.Xt)return!1;const n=lw(e);if(void 0!==n&&!this.tn(n))return!1;const r=Ka(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.tn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Jt.size>0){const a=this.Jt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const u=r[s];if(!this.nn(a,u)||!this.rn(this.Yt[o++],u))return!1}++s}for(;s<r.length;++s)if(o>=this.Yt.length||!this.rn(this.Yt[o++],r[s]))return!1;return!0}sn(){if(this.Xt)return null;let e=new Pt(Zt.comparator);const n=[];for(const r of this.Zt)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)n.push(new Qa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Qa(r.field,0))}for(const r of this.Yt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Qa(r.field,"asc"===r.dir?0:1)));return new tl(tl.UNKNOWN_ID,this.collectionId,n,nl.empty())}tn(e){for(const n of this.Zt)if(this.nn(n,e))return!0;return!1}nn(e,n){return!(void 0===e||!e.field.isEqual(n.fieldPath))&&2===n.kind==("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,n){return!!e.field.isEqual(n.fieldPath)&&(0===n.kind&&"asc"===e.dir||1===n.kind&&"desc"===e.dir)}}function kM(t){var e,n;if(we(t instanceof at||t instanceof Ct),t instanceof at){if(t instanceof Mx){const i=(null===(n=null===(e=t.value.arrayValue)||void 0===e?void 0:e.values)||void 0===n?void 0:n.map(s=>at.create(t.field,"==",s)))||[];return Ct.create(i,"or")}return t}const r=t.filters.map(i=>kM(i));return Ct.create(r,t.op)}function x9(t){if(0===t.getFilters().length)return[];const e=Vw(kM(t));return we(FM(e)),Fw(e)||Lw(e)?[e]:e.getFilters()}function Fw(t){return t instanceof at}function Lw(t){return t instanceof Ct&&yw(t)}function FM(t){return Fw(t)||Lw(t)||function(n){if(n instanceof Ct&&_w(n)){for(const r of n.getFilters())if(!Fw(r)&&!Lw(r))return!1;return!0}return!1}(t)}function Vw(t){if(we(t instanceof at||t instanceof Ct),t instanceof at)return t;if(1===t.filters.length)return Vw(t.filters[0]);const e=t.filters.map(r=>Vw(r));let n=Ct.create(e,t.op);return n=e_(n),FM(n)?n:(we(n instanceof Ct),we(sl(n)),we(n.filters.length>1),n.filters.reduce((r,i)=>Uw(r,i)))}function Uw(t,e){let n;return we(t instanceof at||t instanceof Ct),we(e instanceof at||e instanceof Ct),n=t instanceof at?e instanceof at?Ct.create([t,e],"and"):LM(t,e):e instanceof at?LM(e,t):function(i,s){if(we(i.filters.length>0&&s.filters.length>0),sl(i)&&sl(s))return Px(i,s.getFilters());const o=_w(i)?i:s,a=_w(i)?s:i,u=o.filters.map(l=>Uw(l,a));return Ct.create(u,"or")}(t,e),e_(n)}function LM(t,e){if(sl(e))return Px(e,t.getFilters());{const n=e.filters.map(r=>Uw(t,r));return Ct.create(n,"or")}}function e_(t){if(we(t instanceof at||t instanceof Ct),t instanceof at)return t;const e=t.getFilters();if(1===e.length)return e_(e[0]);if(bx(t))return t;const n=e.map(i=>e_(i)),r=[];return n.forEach(i=>{i instanceof at?r.push(i):i instanceof Ct&&(i.op===t.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:Ct.create(r,t.op)}class M9{constructor(){this.on=new Bw}addToCollectionParentIndex(e,n){return this.on.add(n),O.resolve()}getCollectionParents(e,n){return O.resolve(this.on.getEntries(n))}addFieldIndex(e,n){return O.resolve()}deleteFieldIndex(e,n){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,n){return O.resolve()}getDocumentsMatchingTarget(e,n){return O.resolve(null)}getIndexType(e,n){return O.resolve(0)}getFieldIndexes(e,n){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,n){return O.resolve(di.min())}getMinOffsetFromCollectionGroup(e,n){return O.resolve(di.min())}updateCollectionGroup(e,n,r){return O.resolve()}updateIndexEntries(e,n){return O.resolve()}}class Bw{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Pt(lt.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Pt(lt.comparator)).toArray()}}const t_=new Uint8Array(0);class O9{constructor(e,n){this.user=e,this.databaseId=n,this._n=new Bw,this.an=new uo(r=>Xa(r),(r,i)=>nf(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this._n.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this._n.add(n)});const s={collectionId:r,parent:vr(i)};return VM(e).put(s)}return O.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[tx(n),""],!1,!0);return VM(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(ws(o.parent))}return r})}addFieldIndex(e,n){const r=vf(e),i={indexId:(a=n).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])};var a;delete i.indexId;const s=r.add(i);if(n.indexState){const o=ml(e);return s.next(a=>{o.put(RM(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=vf(e),i=ml(e),s=gl(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=vf(e),r=gl(e),i=ml(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return O.forEach(this.un(n),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new OM(r).sn();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=gl(e);let i=!0;const s=new Map;return O.forEach(this.un(n),o=>this.cn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=He();const a=[];return O.forEach(s,(u,l)=>{var V;ne("IndexedDbIndexManager",`Using index ${V=u,`id=${V.indexId}|cg=${V.collectionGroup}|f=${V.fields.map(Z=>`${Z.fieldPath}:${Z.kind}`).join(",")}`} to execute ${Xa(n)}`);const h=function(V,Z){const se=lw(Z);if(void 0===se)return null;for(const be of qm(V,se.fieldPath))switch(be.op){case"array-contains-any":return be.value.arrayValue.values||[];case"array-contains":return[be.value]}return null}(l,u),g=function(V,Z){const se=new Map;for(const be of Ka(Z))for(const ht of qm(V,be.fieldPath))switch(ht.op){case"==":case"in":se.set(be.fieldPath.canonicalString(),ht.value);break;case"not-in":case"!=":return se.set(be.fieldPath.canonicalString(),ht.value),Array.from(se.values())}return null}(l,u),m=function(V,Z){const se=[];let be=!0;for(const ht of Ka(Z)){const ln=0===ht.kind?Ox(V,ht.fieldPath,V.startAt):kx(V,ht.fieldPath,V.startAt);se.push(ln.value),be&&(be=ln.inclusive)}return new na(se,be)}(l,u),y=function(V,Z){const se=[];let be=!0;for(const ht of Ka(Z)){const ln=0===ht.kind?kx(V,ht.fieldPath,V.endAt):Ox(V,ht.fieldPath,V.endAt);se.push(ln.value),be&&(be=ln.inclusive)}return new na(se,be)}(l,u),D=this.ln(u,l,m),C=this.ln(u,l,y),b=this.hn(u,l,g),F=this.Pn(u.indexId,h,D,m.inclusive,C,y.inclusive,b);return O.forEach(F,N=>r.j(N,n.limit).next(V=>{V.forEach(Z=>{const se=ae.fromSegments(Z.documentKey);o.has(se)||(o=o.add(se),a.push(se))})}))}).next(()=>a)}return O.resolve(null)})}un(e){let n=this.an.get(e);return n||(n=0===e.filters.length?[e]:x9(Ct.create(e.filters,"and")).map(r=>Iw(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.an.set(e,n),n)}Pn(e,n,r,i,s,o,a){const u=(null!=n?n.length:1)*Math.max(r.length,s.length),l=u/(null!=n?n.length:1),h=[];for(let g=0;g<u;++g){const m=n?this.In(n[g/l]):t_,y=this.Tn(e,m,r[g%l],i),D=this.En(e,m,s[g%l],o),C=a.map(b=>this.Tn(e,m,b,!0));h.push(...this.createRange(y,D,C))}return h}Tn(e,n,r,i){const s=new ou(e,ae.empty(),n,r);return i?s:s.Ht()}En(e,n,r,i){const s=new ou(e,ae.empty(),n,r);return i?s.Ht():s}cn(e,n){const r=new OM(n),i=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.en(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.un(n);return O.forEach(i,s=>this.cn(e,s).next(o=>{o?0!==r&&o.fields.length<function(u){let l=new Pt(Zt.comparator),h=!1;for(const g of u.filters)for(const m of g.getFlattenedFilters())m.field.isKeyField()||("array-contains"===m.op||"array-contains-any"===m.op?h=!0:l=l.add(m.field));for(const g of u.orderBy)g.field.isKeyField()||(l=l.add(g.field));return l.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>null!==n.limit&&i.length>1&&2===r?1:r)}dn(e,n){const r=new yf;for(const i of Ka(e)){const s=n.data.field(i.fieldPath);if(null==s)return null;const o=r.jt(i.kind);su.St.ht(s,o)}return r.Ut()}In(e){const n=new yf;return su.St.ht(e,n.jt(0)),n.Ut()}An(e,n){const r=new yf;return su.St.ht(Ja(this.databaseId,n),r.jt(function(s){const o=Ka(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.Ut()}hn(e,n,r){if(null===r)return[];let i=[];i.push(new yf);let s=0;for(const o of Ka(e)){const a=r[s++];for(const u of i)if(this.Rn(n,o.fieldPath)&&Xh(a))i=this.Vn(i,o,a);else{const l=u.jt(o.kind);su.St.ht(a,l)}}return this.mn(i)}ln(e,n,r){return this.hn(e,n,r.position)}mn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Ut();return n}Vn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const u=new yf;u.seed(a.Ut()),su.St.ht(o,u.jt(n.kind)),s.push(u)}return s}Rn(e,n){return!!e.filters.find(r=>r instanceof at&&r.field.isEqual(n)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,n){const r=vf(e),i=ml(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const o=[];return O.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(h,g){const m=g?new nl(g.sequenceNumber,new di(ru(g.readTime),new ae(ws(g.documentKey)),g.largestBatchId)):nl.empty(),y=h.fields.map(([D,C])=>new Qa(Zt.fromServerFormat(D),C));return new tl(h.indexId,h.collectionGroup,y,m)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>0===n.length?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:Fe(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=vf(e),s=ml(e);return this.fn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>O.forEach(a,u=>s.put(RM(u.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return O.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?O.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),O.forEach(a,u=>this.gn(e,i,u).next(l=>{const h=this.pn(s,u);return l.isEqual(h)?O.resolve():this.yn(e,s,u,l,h)}))))})}wn(e,n,r,i){return gl(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.An(r,n.key),documentKey:n.key.path.toArray()})}Sn(e,n,r,i){return gl(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.An(r,n.key),n.key.path.toArray()])}gn(e,n,r){const i=gl(e);let s=new Pt(ia);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.An(r,n)])},(o,a)=>{s=s.add(new ou(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}pn(e,n){let r=new Pt(ia);const i=this.dn(n,e);if(null==i)return r;const s=lw(n);if(null!=s){const o=e.data.field(s.fieldPath);if(Xh(o))for(const a of o.arrayValue.values||[])r=r.add(new ou(n.indexId,e.key,this.In(a),i))}else r=r.add(new ou(n.indexId,e.key,t_,i));return r}yn(e,n,r,i,s){ne("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,l,h,g,m){const y=u.getIterator(),D=l.getIterator();let C=rl(y),b=rl(D);for(;C||b;){let F=!1,N=!1;if(C&&b){const V=h(C,b);V<0?N=!0:V>0&&(F=!0)}else null!=C?N=!0:F=!0;F?(g(b),b=rl(D)):N?(m(C),C=rl(y)):(C=rl(y),b=rl(D))}}(i,s,ia,a=>{o.push(this.wn(e,n,r,a))},a=>{o.push(this.Sn(e,n,r,a))}),O.waitFor(o)}fn(e){let n=1;return ml(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ia(o,a)).filter((o,a,u)=>!a||0!==ia(o,u[a-1]));const i=[];i.push(e);for(const o of r){const a=ia(o,e),u=ia(o,n);if(0===a)i[0]=e.Ht();else if(a>0&&u<0)i.push(o),i.push(o.Ht());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,t_,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,t_,[]]))}return s}bn(e,n){return ia(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(UM)}getMinOffset(e,n){return O.mapArray(this.un(n),r=>this.cn(e,r).next(i=>i||ge())).next(UM)}}function VM(t){return Jn(t,"collectionParents")}function gl(t){return Jn(t,"indexEntries")}function vf(t){return Jn(t,"indexConfiguration")}function ml(t){return Jn(t,"indexState")}function UM(t){we(0!==t.length);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;dw(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new di(e.readTime,e.documentKey,n)}const BM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ir{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ir(e,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function jM(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=r.Y({range:o},(h,g,m)=>(a++,m.delete()));s.push(u.next(()=>{we(1===a)}));const l=[];for(const h of n.mutations){const g=lx(e,h.key.path,n.batchId);s.push(i.delete(g)),l.push(h.key)}return O.waitFor(s).next(()=>l)}function n_(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ge();e=t.noDocument}return JSON.stringify(e).length}Ir.DEFAULT_COLLECTION_PERCENTILE=10,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ir.DEFAULT=new Ir(41943040,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ir.DISABLED=new Ir(-1,0,0);class r_{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Dn={}}static ct(e,n,r,i){we(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new r_(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sa(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=_l(e),o=sa(e);return o.add({}).next(a=>{we("number"==typeof a);const u=new Aw(a,n,r,i),l=function(y,D,C){const b=C.baseMutations.map(N=>gf(y.ut,N)),F=C.mutations.map(N=>gf(y.ut,N));return{userId:D,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:b,mutations:F}}(this.serializer,this.userId,u),h=[];let g=new Pt((m,y)=>Fe(m.canonicalString(),y.canonicalString()));for(const m of i){const y=lx(this.userId,m.key.path,a);g=g.add(m.key.path.popLast()),h.push(o.put(l)),h.push(s.put(y,wW))}return g.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Dn[a]=u.keys()}),O.waitFor(h).next(()=>u)})}lookupMutationBatch(e,n){return sa(e).get(n).next(r=>r?(we(r.userId===this.userId),iu(this.serializer,r)):null)}Cn(e,n){return this.Dn[n]?O.resolve(this.Dn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Dn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return sa(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(we(a.batchId>=r),s=iu(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return sa(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return sa(e).W("userMutationsIndex",n).next(r=>r.map(i=>iu(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Lm(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return _l(e).Y({range:i},(o,a,u)=>{const[l,h,g]=o,m=ws(h);if(l===this.userId&&n.path.isEqual(m))return sa(e).get(g).next(y=>{if(!y)throw ge();we(y.userId===this.userId),s.push(iu(this.serializer,y))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Pt(Fe);const i=[];return n.forEach(s=>{const o=Lm(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=_l(e).Y({range:a},(l,h,g)=>{const[m,y,D]=l,C=ws(y);m===this.userId&&s.path.isEqual(C)?r=r.add(D):g.done()});i.push(u)}),O.waitFor(i).next(()=>this.vn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Lm(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Pt(Fe);return _l(e).Y({range:o},(u,l,h)=>{const[g,m,y]=u,D=ws(m);g===this.userId&&r.isPrefixOf(D)?D.length===i&&(a=a.add(y)):h.done()}).next(()=>this.vn(e,a))}vn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(sa(e).get(s).next(o=>{if(null===o)throw ge();we(o.userId===this.userId),r.push(iu(this.serializer,o))}))}),O.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return jM(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Fn(n.batchId)}),O.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return O.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return _l(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){const u=ws(s[1]);i.push(u)}else a.done()}).next(()=>{we(0===i.length)})})}containsKey(e,n){return $M(e,this.userId,n)}Mn(e){return HM(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function $M(t,e,n){const r=Lm(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return _l(t).Y({range:s,J:!0},(a,u,l)=>{const[h,g,m]=a;h===e&&g===i&&(o=!0),l.done()}).next(()=>o)}function sa(t){return Jn(t,"mutations")}function _l(t){return Jn(t,"documentMutations")}function HM(t){return Jn(t,"mutationQueues")}class au{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new au(0)}static Nn(){return new au(-1)}}class k9{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{const r=new au(n.highestTargetId);return n.highestTargetId=r.next(),this.Ln(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>Te.fromTimestamp(new Jt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Ln(e,i)))}addTargetData(e,n){return this.kn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.qn(n,r),this.Ln(e,r))))}updateTargetData(e,n){return this.kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>yl(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(we(r.targetCount>0),r.targetCount-=1,this.Ln(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return yl(e).Y((o,a)=>{const u=mf(a);u.sequenceNumber<=n&&null===r.get(u.targetId)&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>O.waitFor(s)).next(()=>i)}forEachTarget(e,n){return yl(e).Y((r,i)=>{const s=mf(i);n(s)})}Bn(e){return zM(e).get("targetGlobalKey").next(n=>(we(null!==n),n))}Ln(e,n){return zM(e).put("targetGlobalKey",n)}kn(e,n){return yl(e).put(SM(this.serializer,n))}qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Xa(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return yl(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{const l=mf(a);nf(n,l.target)&&(s=l,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=oa(e);return n.forEach(o=>{const a=vr(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),O.waitFor(i)}removeMatchingKeys(e,n,r){const i=oa(e);return O.forEach(n,s=>{const o=vr(s.path);return O.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=oa(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=oa(e);let s=He();return i.Y({range:r,J:!0},(o,a,u)=>{const l=ws(o[1]),h=new ae(l);s=s.add(h)}).next(()=>s)}containsKey(e,n){const r=vr(n.path),i=IDBKeyRange.bound([r],[tx(r)],!1,!0);let s=0;return oa(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,l)=>{0!==o&&(s++,l.done())}).next(()=>s>0)}_t(e,n){return yl(e).get(n).next(r=>r?mf(r):null)}}function yl(t){return Jn(t,"targets")}function zM(t){return Jn(t,"targetGlobal")}function oa(t){return Jn(t,"targetDocuments")}function qM([t,e],[n,r]){const i=Fe(t,n);return 0===i?Fe(e,r):i}class F9{constructor(e){this.Qn=e,this.buffer=new Pt(qM),this.Kn=0}$n(){return++this.Kn}Un(e){const n=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();qM(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class WM{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){var n=this;ne("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,W.Z)(function*(){n.Wn=null;try{yield n.localStore.collectGarbage(n.garbageCollector)}catch(r){Ko(r)?ne("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Zo(r)}yield n.Gn(3e5)}))}}class L9{constructor(e,n){this.zn=e,this.params=n}calculateTargetCount(e,n){return this.zn.jn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(0===n)return O.resolve(hi._e);const r=new F9(n);return this.zn.forEachTarget(e,i=>r.Un(i.sequenceNumber)).next(()=>this.zn.Hn(e,i=>r.Un(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.zn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.zn.removeOrphanedDocuments(e,n)}collect(e,n){return-1===this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),O.resolve(BM)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),BM):this.Jn(e,n))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,n){let r,i,s,o,a,u,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,a=Date.now(),this.removeTargets(e,r,n))).next(g=>(s=g,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(l=Date.now(),Xc()<=ys.in.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-h}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(u-a)+`ms\n\tRemoved ${g} documents in `+(l-u)+`ms\nTotal Duration: ${l-h}ms`),O.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}}class V9{constructor(e,n){this.db=e,this.garbageCollector=function GM(t,e){return new L9(t,e)}(this,n)}jn(e){const n=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Yn(e){let n=0;return this.Hn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Hn(e,n){return this.Zn(e,(r,i)=>n(i))}addReference(e,n,r){return i_(e,r)}removeReference(e,n,r){return i_(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return i_(e,n)}Xn(e,n){return function(i,s){let o=!1;return HM(i).Z(a=>$M(i,a,s).next(u=>(u&&(o=!0),O.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Zn(e,(o,a)=>{if(a<=n){const u=this.Xn(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Te.min()),oa(e).delete([0,vr(o.path)])))});i.push(u)}}).next(()=>O.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return i_(e,n)}Zn(e,n){const r=oa(e);let i,s=hi._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:l})=>{0===o?(s!==hi._e&&n(new ae(ws(i)),s),s=l,i=u):s=hi._e}).next(()=>{s!==hi._e&&n(new ae(ws(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function i_(t,e){return oa(t).put((i=t.currentSequenceNumber,{targetId:0,path:vr(e.path),sequenceNumber:i}));var i}class ZM{constructor(){this.changes=new uo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Kt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?O.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class U9{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return uu(e).put(r)}removeEntry(e,n,r){return uu(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Jm(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.er(e,r)))}getEntry(e,n){let r=Kt.newInvalidDocument(n);return uu(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(If(n))},(i,s)=>{r=this.tr(n,s)}).next(()=>r)}nr(e,n){let r={size:0,document:Kt.newInvalidDocument(n)};return uu(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(If(n))},(i,s)=>{r={document:this.tr(n,s),size:n_(s)}}).next(()=>r)}getEntries(e,n){let r=Jr();return this.rr(e,n,(i,s)=>{const o=this.tr(i,s);r=r.insert(i,o)}).next(()=>r)}ir(e,n){let r=Jr(),i=new Vt(ae.comparator);return this.rr(e,n,(s,o)=>{const a=this.tr(s,o);r=r.insert(s,a),i=i.insert(s,n_(o))}).next(()=>({documents:r,sr:i}))}rr(e,n,r){if(n.isEmpty())return O.resolve();let i=new Pt(JM);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(If(i.first()),If(i.last())),o=i.getIterator();let a=o.getNext();return uu(e).Y({index:"documentKeyIndex",range:s},(u,l,h)=>{const g=ae.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&JM(a,g)<0;)r(a,null),a=o.getNext();a&&a.isEqual(g)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?h.U(If(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Jm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return uu(e).W(IDBKeyRange.bound(a,u,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let h=Jr();for(const g of l){const m=this.tr(ae.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);m.isFoundDocument()&&(sf(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let s=Jr();const o=YM(n,r),a=YM(n,di.max());return uu(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,l,h)=>{const g=this.tr(ae.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(g.key,g),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new B9(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return QM(e).get("remoteDocumentGlobalKey").next(n=>(we(!!n),n))}er(e,n){return QM(e).put("remoteDocumentGlobalKey",n)}tr(e,n){if(n){const r=function C9(t,e){let n;if(e.document)n=vM(t.ut,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ae.fromSegments(e.noDocument.path),i=ru(e.noDocument.readTime);n=Kt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ge();{const r=ae.fromSegments(e.unknownDocument.path),i=ru(e.unknownDocument.version);n=Kt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Jt(i[0],i[1]);return Te.fromTimestamp(s)}(e.readTime)),n}(this.serializer,n);if(!r.isNoDocument()||!r.version.isEqual(Te.min()))return r}return Kt.newInvalidDocument(e)}}function KM(t){return new U9(t)}class B9 extends ZM{constructor(e,n){super(),this._r=e,this.trackRemovals=n,this.ar=new uo(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Pt((s,o)=>Fe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.ar.get(s);if(n.push(this._r.removeEntry(e,s,a.readTime)),o.isValidDocument()){const u=CM(this._r.serializer,o);i=i.add(s.path.popLast());const l=n_(u);r+=l-a.size,n.push(this._r.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){const u=CM(this._r.serializer,o.convertToNoDocument(Te.min()));n.push(this._r.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this._r.indexManager.addToCollectionParentIndex(e,s))}),n.push(this._r.updateMetadata(e,r)),O.waitFor(n)}getFromCache(e,n){return this._r.nr(e,n).next(r=>(this.ar.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this._r.ir(e,n).next(({documents:r,sr:i})=>(i.forEach((s,o)=>{this.ar.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function QM(t){return Jn(t,"remoteDocumentGlobal")}function uu(t){return Jn(t,"remoteDocumentsV14")}function If(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function YM(t,e){const n=e.documentKey.path.toArray();return[t,Jm(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function JM(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Fe(n[s],r[s]),i)return i;return i=Fe(n.length,r.length),i||(i=Fe(n[n.length-2],r[r.length-2]),i||Fe(n[n.length-1],r[r.length-1]))}class j9{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class XM{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(null!==r&&cf(r.mutation,i,Yr.empty(),Jt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,He()).next(()=>r))}getLocalViewOfDocuments(e,n,r=He()){const i=Ds();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=of();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ds();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,He()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Jr();const o=af(),a=af();return n.forEach((u,l)=>{const h=r.get(l.key);i.has(l.key)&&(void 0===h||h.mutation instanceof co)?s=s.insert(l.key,l):void 0!==h?(o.set(l.key,h.mutation.getFieldMask()),cf(h.mutation,l,h.mutation.getFieldMask(),Jt.now())):o.set(l.key,Yr.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((l,h)=>o.set(l,h)),n.forEach((l,h)=>{var g;return a.set(l,new j9(h,null!==(g=o.get(l))&&void 0!==g?g:null))}),a))}recalculateAndSaveOverlays(e,n){const r=af();let i=new Vt((o,a)=>o-a),s=He();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const l=n.get(u);if(null===l)return;let h=r.get(u)||Yr.empty();h=a.applyToLocalView(l,h),r.set(u,h);const g=(i.get(a.batchId)||He()).add(u);i=i.insert(a.batchId,g)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,h=u.value,g=zx();h.forEach(m=>{if(!s.has(m)){const y=Xx(n.get(m),r.get(m));null!==y&&g.set(m,y),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,g))}return O.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return ae.isDocumentKey((o=n).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):Ew(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i);var o}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):O.resolve(Ds());let a=-1,u=s;return o.next(l=>O.forEach(l,(h,g)=>(a<g.largestBatchId&&(a=g.largestBatchId),s.get(h)?O.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,u,l,He())).next(h=>({batchId:a,changes:Hx(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ae(n)).next(r=>{let i=of();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=of();return this.indexManager.getCollectionParents(e,s).next(a=>O.forEach(a,u=>{const l=(g=n,m=u.child(s),new ao(m,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt));var g,m;return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((g,m)=>{o=o.insert(g,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,l)=>{const h=l.getKey();null===o.get(h)&&(o=o.insert(h,Kt.newInvalidDocument(h)))});let a=of();return o.forEach((u,l)=>{const h=s.get(u);void 0!==h&&cf(h.mutation,l,Yr.empty(),Jt.now()),sf(n,l)&&(a=a.insert(u,l))}),a})}}class $9{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,n){return O.resolve(this.ur.get(n))}saveBundleMetadata(e,n){return this.ur.set(n.id,{id:(i=n).id,version:i.version,createTime:An(i.createTime)}),O.resolve();var i}getNamedQuery(e,n){return O.resolve(this.cr.get(n))}saveNamedQuery(e,n){return this.cr.set(n.name,{name:(i=n).name,query:Ow(i.bundledQuery),readTime:An(i.readTime)}),O.resolve();var i}}class H9{constructor(){this.overlays=new Vt(ae.comparator),this.lr=new Map}getOverlay(e,n){return O.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ds();return O.forEach(n,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.lt(e,n,s)}),O.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.lr.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.lr.delete(r)),O.resolve()}getOverlaysForCollection(e,n,r){const i=Ds(),s=n.length+1,o=new ae(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return O.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Vt((l,h)=>l-h);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>r){let h=s.get(l.largestBatchId);null===h&&(h=Ds(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}const a=Ds(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return O.resolve(a)}lt(e,n,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.lr.get(i.largestBatchId).delete(r.key);this.lr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Sw(n,r));let s=this.lr.get(n);void 0===s&&(s=He(),this.lr.set(n,s)),this.lr.set(n,s.add(r.key))}}class jw{constructor(){this.hr=new Pt(Xn.Pr),this.Ir=new Pt(Xn.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,n){const r=new Xn(e,n);this.hr=this.hr.add(r),this.Ir=this.Ir.add(r)}Er(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.dr(new Xn(e,n))}Ar(e,n){e.forEach(r=>this.removeReference(r,n))}Rr(e){const n=new ae(new lt([])),r=new Xn(n,e),i=new Xn(n,e+1),s=[];return this.Ir.forEachInRange([r,i],o=>{this.dr(o),s.push(o.key)}),s}Vr(){this.hr.forEach(e=>this.dr(e))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const n=new ae(new lt([])),r=new Xn(n,e),i=new Xn(n,e+1);let s=He();return this.Ir.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Xn(e,0),r=this.hr.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class Xn{constructor(e,n){this.key=e,this.gr=n}static Pr(e,n){return ae.comparator(e.key,n.key)||Fe(e.gr,n.gr)}static Tr(e,n){return Fe(e.gr,n.gr)||ae.comparator(e.key,n.key)}}class z9{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.pr=1,this.yr=new Pt(Xn.Pr)}checkEmpty(e){return O.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,i){const s=this.pr;this.pr++;const o=new Aw(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.yr=this.yr.add(new Xn(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return O.resolve(o)}lookupMutationBatch(e,n){return O.resolve(this.wr(n))}getNextMutationBatchAfterBatchId(e,n){const i=this.Sr(n+1),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Xn(n,0),i=new Xn(n,Number.POSITIVE_INFINITY),s=[];return this.yr.forEachInRange([r,i],o=>{const a=this.wr(o.gr);s.push(a)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Pt(Fe);return n.forEach(i=>{const s=new Xn(i,0),o=new Xn(i,Number.POSITIVE_INFINITY);this.yr.forEachInRange([s,o],a=>{r=r.add(a.gr)})}),O.resolve(this.br(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ae.isDocumentKey(s)||(s=s.child(""));const o=new Xn(new ae(s),0);let a=new Pt(Fe);return this.yr.forEachWhile(u=>{const l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.gr)),!0)},o),O.resolve(this.br(a))}br(e){const n=[];return e.forEach(r=>{const i=this.wr(r);null!==i&&n.push(i)}),n}removeMutationBatch(e,n){we(0===this.Dr(n.batchId,"removed")),this.mutationQueue.shift();let r=this.yr;return O.forEach(n.mutations,i=>{const s=new Xn(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.yr=r})}Fn(e){}containsKey(e,n){const r=new Xn(n,0),i=this.yr.firstAfterOrEqual(r);return O.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return O.resolve()}Dr(e,n){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const n=this.Sr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class q9{constructor(e){this.Cr=e,this.docs=new Vt(ae.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Cr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return O.resolve(r?r.document.mutableCopy():Kt.newInvalidDocument(n))}getEntries(e,n){let r=Jr();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Kt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Jr();const o=n.path,a=new ae(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:h}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||dw(rx(h),r)<=0||(i.has(h.key)||sf(n,h))&&(s=s.insert(h.key,h.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ge()}vr(e,n){return O.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new W9(this)}getSize(e){return O.resolve(this.size)}}class W9 extends ZM{constructor(e){super(),this._r=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this._r.addEntry(e,i)):this._r.removeEntry(r)}),O.waitFor(n)}getFromCache(e,n){return this._r.getEntry(e,n)}getAllFromCache(e,n){return this._r.getEntries(e,n)}}class G9{constructor(e){this.persistence=e,this.Fr=new uo(n=>Xa(n),nf),this.lastRemoteSnapshotVersion=Te.min(),this.highestTargetId=0,this.Mr=0,this.Or=new jw,this.targetCount=0,this.Nr=au.On()}forEachTarget(e,n){return this.Fr.forEach((r,i)=>n(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Mr&&(this.Mr=n),O.resolve()}kn(e){this.Fr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Nr=new au(n),this.highestTargetId=n),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,n){return this.kn(n),this.targetCount+=1,O.resolve()}updateTargetData(e,n){return this.kn(n),O.resolve()}removeTargetData(e,n){return this.Fr.delete(n.target),this.Or.Rr(n.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Fr.forEach((o,a)=>{a.sequenceNumber<=n&&null===r.get(a.targetId)&&(this.Fr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,n){const r=this.Fr.get(n)||null;return O.resolve(r)}addMatchingKeys(e,n,r){return this.Or.Er(n,r),O.resolve()}removeMatchingKeys(e,n,r){this.Or.Ar(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Or.Rr(n),O.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Or.mr(n);return O.resolve(r)}containsKey(e,n){return O.resolve(this.Or.containsKey(n))}}class $w{constructor(e,n){this.Br={},this.overlays={},this.Lr=new hi(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new G9(this),this.indexManager=new M9,this.remoteDocumentCache=new q9(r=>this.referenceDelegate.Qr(r)),this.serializer=new AM(n),this.Kr=new $9(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new H9,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new z9(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,n,r){ne("MemoryPersistence","Starting transaction:",e);const i=new Z9(this.Lr.next());return this.referenceDelegate.$r(),r(i).next(s=>this.referenceDelegate.Ur(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Wr(e,n){return O.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}}class Z9 extends sx{constructor(e){super(),this.currentSequenceNumber=e}}class s_{constructor(e){this.persistence=e,this.Gr=new jw,this.zr=null}static jr(e){return new s_(e)}get Hr(){if(this.zr)return this.zr;throw ge()}addReference(e,n,r){return this.Gr.addReference(r,n),this.Hr.delete(r.toString()),O.resolve()}removeReference(e,n,r){return this.Gr.removeReference(r,n),this.Hr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,n){return this.Hr.add(n.toString()),O.resolve()}removeTarget(e,n){this.Gr.Rr(n.targetId).forEach(i=>this.Hr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Hr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}$r(){this.zr=new Set}Ur(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Hr,r=>{const i=ae.fromPath(r);return this.Jr(e,i).next(s=>{s||n.removeEntry(i,Te.min())})}).next(()=>(this.zr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Jr(e,n).next(r=>{r?this.Hr.delete(n.toString()):this.Hr.add(n.toString())})}Qr(e){return 0}Jr(e,n){return O.or([()=>O.resolve(this.Gr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Wr(e,n)])}}class K9{constructor(e){this.serializer=e}N(e,n,r,i){const s=new Fm("createOrUpgrade",n);var u;r<1&&i>=1&&(e.createObjectStore("owner"),(u=e).createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",cx,{unique:!0}),u.createObjectStore("documentMutations"),e1(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=O.resolve();return r<3&&i>=3&&(0!==r&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),e1(e)),o=o.next(()=>function(u){const l=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Te.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(u,l){return l.store("mutations").W().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",cx,{unique:!0});const g=l.store("mutations"),m=h.map(y=>g.put(y));return O.waitFor(m)})}(e,s))),o=o.next(()=>{!function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.Zr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(s)))),r<7&&i>=7&&(o=o.next(()=>this.ei(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.ni(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(u){const l=u.createObjectStore("documentOverlays",{keyPath:OW});l.createIndex("collectionPathOverlayIndex",kW,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",FW,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const l=u.createObjectStore("remoteDocumentsV14",{keyPath:TW});l.createIndex("documentKeyIndex",DW),l.createIndex("collectionGroupIndex",AW)}(e)).next(()=>this.ri(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ii(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:PW}).createIndex("sequenceNumberIndex",NW,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:xW}).createIndex("documentKeyIndex",MW,{unique:!1})}(e))),o}Xr(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=n_(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Zr(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>O.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>O.forEach(a,u=>{we(u.userId===s.userId);const l=iu(this.serializer,u);return jM(e,s.userId,l).next(()=>{})}))}))}ei(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Y((o,a)=>{const u=new lt(o),l=[0,vr(u)];s.push(n.get(l).next(h=>h?O.resolve():n.put({targetId:0,path:vr(u),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>O.waitFor(s))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:RW});const r=n.store("collectionParents"),i=new Bw,s=o=>{if(i.add(o)){const a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:vr(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{const u=new lt(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],l)=>{const h=ws(a);return s(h.popLast())}))}ni(e){const n=e.store("targets");return n.Y((r,i)=>{const s=mf(i),o=SM(this.serializer,s);return n.put(o)})}ri(e,n){const r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{const a=n.store("remoteDocumentsV14"),u=(g=o,g.document?new ae(lt.fromString(g.document.name).popFirst(5)):g.noDocument?ae.fromSegments(g.noDocument.path):g.unknownDocument?ae.fromSegments(g.unknownDocument.path):ge()).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var g;i.push(a.put(l))}).next(()=>O.waitFor(i))}ii(e,n){const r=n.store("mutations"),i=KM(this.serializer),s=new $w(s_.jr,this.serializer.ut);return r.W().next(o=>{const a=new Map;return o.forEach(u=>{var l;let h=null!==(l=a.get(u.userId))&&void 0!==l?l:He();iu(this.serializer,u).keys().forEach(g=>h=h.add(g)),a.set(u.userId,h)}),O.forEach(a,(u,l)=>{const h=new Yn(l),g=Xm.ct(this.serializer,h),m=s.getIndexManager(h),y=r_.ct(h,this.serializer,m,s.referenceDelegate);return new XM(i,y,g,m).recalculateAndSaveOverlaysForDocumentKeys(new pw(n,hi._e),u).next()})})}}function e1(t){t.createObjectStore("targetDocuments",{keyPath:SW}).createIndex("documentTargetsIndex",bW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",CW,{unique:!0}),t.createObjectStore("targetGlobal")}const Hw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class zw{constructor(e,n,r,i,s,o,a,u,l,h,g=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.si=s,this.window=o,this.document=a,this.oi=l,this._i=h,this.ai=g,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=m=>Promise.resolve(),!zw.D())throw new J(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new V9(this,i),this.Ii=n+"main",this.serializer=new AM(u),this.Ti=new Qi(this.Ii,this.ai,new K9(this.serializer)),this.qr=new k9(this.referenceDelegate,this.serializer),this.remoteDocumentCache=KM(this.serializer),this.Kr=new S9,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===h&&Dn("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new J(B.FAILED_PRECONDITION,Hw);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.qr.getHighestSequenceNumber(e))}).then(e=>{this.Lr=new hi(e,this.oi)}).then(()=>{this.kr=!0}).catch(e=>(this.Ti&&this.Ti.close(),Promise.reject(e)))}mi(e){var n=this;return this.Pi=function(){var r=(0,W.Z)(function*(i){if(n.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L(function(){var n=(0,W.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return n.apply(this,arguments)}}())}setNetworkEnabled(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((0,W.Z)(function*(){n.started&&(yield n.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>a_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(e)).next(n=>this.isPrimary&&!n?this.pi(e).next(()=>!1):!!n&&this.yi(e).next(()=>!0))).catch(e=>{if(Ko(e))return ne("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ne("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.Pi(e)),this.isPrimary=e})}fi(e){return Ef(e).get("owner").next(n=>O.resolve(this.wi(n)))}Si(e){return a_(e).delete(this.clientId)}bi(){var e=this;return(0,W.Z)(function*(){if(e.isPrimary&&!e.Di(e.hi,18e5)){e.hi=Date.now();const n=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Jn(r,"clientMetadata");return i.W().next(s=>{const o=e.Ci(s,18e5),a=s.filter(u=>-1===o.indexOf(u));return O.forEach(a,u=>i.delete(u.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Ei)for(const r of n)e.Ei.removeItem(e.vi(r.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?O.resolve(!0):Ef(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)){if(this.wi(n)&&this.networkEnabled)return!0;if(!this.wi(n)){if(!n.allowTabSynchronization)throw new J(B.FAILED_PRECONDITION,Hw);return!1}}return!(!this.networkEnabled||!this.inForeground)||a_(e).W().next(r=>void 0===this.Ci(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(n=>(this.isPrimary!==n&&ne("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){var e=this;return(0,W.Z)(function*(){e.kr=!1,e.Mi(),e.li&&(e.li.cancel(),e.li=null),e.xi(),e.Oi(),yield e.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],n=>{const r=new pw(n,hi._e);return e.pi(r).next(()=>e.Si(r))}),e.Ti.close(),e.Ni()})()}Ci(e,n){return e.filter(r=>this.Di(r.updateTimeMs,n)&&!this.Fi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>a_(e).W().next(n=>this.Ci(n,18e5).map(r=>r.clientId)))}get started(){return this.kr}getMutationQueue(e,n){return r_.ct(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O9(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Xm.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,n,r){ne("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===n?"readonly":"readwrite",s=15===(u=this.ai)?VW:14===u?fx:13===u?hx:12===u?LW:11===u?dx:void ge();var u;let o;return this.Ti.runTransaction(e,i,s,a=>(o=new pw(a,this.Lr?this.Lr.next():hi._e),"readwrite-primary"===n?this.fi(o).next(u=>!!u||this.gi(o)).next(u=>{if(!u)throw Dn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new J(B.FAILED_PRECONDITION,ix);return r(o)}).next(u=>this.yi(o).next(()=>u)):this.Li(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Li(e){return Ef(e).get("owner").next(n=>{if(null!==n&&this.Di(n.leaseTimestampMs,5e3)&&!this.Fi(n.ownerId)&&!this.wi(n)&&!(this._i||this.allowTabSynchronization&&n.allowTabSynchronization))throw new J(B.FAILED_PRECONDITION,Hw)})}yi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ef(e).put("owner",n)}static D(){return Qi.D()}pi(e){const n=Ef(e);return n.get("owner").next(r=>this.wi(r)?(ne("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):O.resolve())}Di(e,n){const r=Date.now();return!(e<r-n||e>r&&(Dn(`Detected an update time that is in the future: ${e} > ${r}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const n=/(?:Version|Mobile)\/1[456]/;(0,Dt.G6)()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var n;try{const r=null!==(null===(n=this.Ei)||void 0===n?void 0:n.getItem(this.vi(e)));return ne("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Dn("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){Dn("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ef(t){return Jn(t,"owner")}function a_(t){return Jn(t,"clientMetadata")}function qw(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}class Ww{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.ki=r,this.qi=i}static Qi(e,n){let r=He(),i=He();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ww(e,n.fromCache,r,i)}}class Q9{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class t1{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,n){this.Gi=e,this.indexManager=n,this.Ki=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.zi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ji(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Q9;return this.Hi(e,n,o).next(a=>{if(s.result=a,this.$i)return this.Ji(e,n,o,a.size)})}).next(()=>s.result)}Ji(e,n,r,i){return r.documentReadCount<this.Ui?(Xc()<=ys.in.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",ul(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),O.resolve()):(Xc()<=ys.in.DEBUG&&ne("QueryEngine","Query:",ul(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Wi*i?(Xc()<=ys.in.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",ul(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vr(n))):O.resolve())}zi(e,n){if(Lx(n))return O.resolve(null);let r=Vr(n);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==n.limit&&1===i&&(n=Wm(n,null,"F"),r=Vr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=He(...s);return this.Gi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{const l=this.Yi(n,a);return this.Zi(n,l,o,u.readTime)?this.zi(e,Wm(n,null,"F")):this.Xi(e,l,n,u)}))})))}ji(e,n,r,i){return Lx(n)||i.isEqual(Te.min())?O.resolve(null):this.Gi.getDocuments(e,r).next(s=>{const o=this.Yi(n,s);return this.Zi(n,o,r,i)?O.resolve(null):(Xc()<=ys.in.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ul(n)),this.Xi(e,o,n,nx(i,-1)).next(a=>a))})}Yi(e,n){let r=new Pt(jx(e));return n.forEach((i,s)=>{sf(e,s)&&(r=r.add(s))}),r}Zi(e,n,r,i){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const s="F"===e.limitType?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Hi(e,n,r){return Xc()<=ys.in.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",ul(n)),this.Gi.getDocumentsMatchingQuery(e,n,di.min(),r)}Xi(e,n,r,i){return this.Gi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}class Y9{constructor(e,n,r,i){this.persistence=e,this.es=n,this.serializer=i,this.ts=new Vt(Fe),this.ns=new uo(s=>Xa(s),nf),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(r)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XM(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ts))}}function n1(t,e,n,r){return new Y9(t,e,n,r)}function r1(t,e){return Gw.apply(this,arguments)}function Gw(){return Gw=(0,W.Z)(function*(t,e){const n=oe(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.os(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let u=He();for(const l of i){o.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}for(const l of s){a.push(l.batchId);for(const h of l.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(l=>({_s:l,removedBatchIds:o,addedBatchIds:a}))})})}),Gw.apply(this,arguments)}function i1(t){const e=oe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.qr.getLastRemoteSnapshotVersion(n))}function s1(t,e,n){let r=He(),i=He();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Jr();return n.forEach((a,u)=>{const l=s.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(Te.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||0===u.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):ne("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{us:o,cs:i}})}function e6(t,e){const n=oe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function vl(t,e){const n=oe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.qr.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):n.qr.allocateTargetId(r).next(o=>(i=new lo(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.qr.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.ts.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ts=n.ts.insert(r.targetId,r),n.ns.set(e,r.targetId)),r})}function Il(t,e,n){return Zw.apply(this,arguments)}function Zw(){return Zw=(0,W.Z)(function*(t,e,n){const r=oe(t),i=r.ts.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Ko(o))throw o;ne("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ts=r.ts.remove(e),r.ns.delete(i.target)}),Zw.apply(this,arguments)}function u_(t,e,n){const r=oe(t);let i=Te.min(),s=He();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,h){const g=oe(u),m=g.ns.get(h);return void 0!==m?O.resolve(g.ts.get(m)):g.qr.getTargetData(l,h)}(r,o,Vr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.es.getDocumentsMatchingQuery(o,e,n?i:Te.min(),n?s:He())).next(a=>(u1(r,Bx(e),a),{documents:a,ls:s})))}function o1(t,e){const n=oe(t),r=oe(n.qr),i=n.ts.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function a1(t,e){const n=oe(t),r=n.rs.get(e)||Te.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.ss.getAllFromCollectionGroup(i,e,nx(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(u1(n,e,i),i))}function u1(t,e,n){let r=t.rs.get(e)||Te.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.rs.set(e,r)}function Kw(){return Kw=(0,W.Z)(function*(t,e,n,r){const i=oe(t);let s=He(),o=Jr();for(const l of n){const h=e.hs(l.metadata.name);l.document&&(s=s.add(h));const g=e.Ps(l);g.setReadTime(e.Is(l.metadata.readTime)),o=o.insert(h,g)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),u=yield vl(i,(h=r,Vr(ol(lt.fromString(`__bundle__/docs/${h}`)))));var h;return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>s1(l,a,o).next(h=>(a.apply(l),h)).next(h=>i.qr.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.qr.addMatchingKeys(l,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.us,h.cs)).next(()=>h.us)))}),Kw.apply(this,arguments)}function n6(t,e){return Qw.apply(this,arguments)}function Qw(){return Qw=(0,W.Z)(function*(t,e,n=He()){const r=yield vl(t,Vr(Ow(e.bundledQuery))),i=oe(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=An(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Kr.saveNamedQuery(s,e);const a=r.withResumeToken(jn.EMPTY_BYTE_STRING,o);return i.ts=i.ts.insert(a.targetId,a),i.qr.updateTargetData(s,a).next(()=>i.qr.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.qr.addMatchingKeys(s,n,r.targetId)).next(()=>i.Kr.saveNamedQuery(s,e))})}),Qw.apply(this,arguments)}function c1(t,e){return`firestore_clients_${t}_${e}`}function l1(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Yw(t,e){return`firestore_targets_${t}_${e}`}class c_{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Ts(e,n,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new J(i.error.code,i.error.message))),o?new c_(e,n,i.state,s):(Dn("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class wf{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Ts(e,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new J(r.error.code,r.error.message))),s?new wf(e,r.state,i):(Dn("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class l_{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ts(e,n){const r=JSON.parse(n);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=Tw();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=ax(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new l_(e,s):(Dn("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Jw{constructor(e,n){this.clientId=e,this.onlineState=n}static Ts(e){const n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new Jw(n.clientId,n.onlineState):(Dn("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Xw{constructor(){this.activeTargetIds=Tw()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eT{constructor(e,n,r,i,s){this.window=e,this.si=n,this.persistenceKey=r,this.Rs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Vt(Fe),this.started=!1,this.ps=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ys=c1(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new Xw),this.Ss=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,W.Z)(function*(){const n=yield e.syncEngine.Bi();for(const i of n){if(i===e.Rs)continue;const s=e.getItem(c1(e.persistenceKey,i));if(s){const o=l_.Ts(i,s);o&&(e.gs=e.gs.insert(o.clientId,o))}}e.Fs();const r=e.storage.getItem(e.Cs);if(r){const i=e.Ms(r);i&&e.xs(i)}for(const i of e.ps)e.fs(i);e.ps=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let n=!1;return this.gs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,n,r){this.Ns(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Yw(this.persistenceKey,e));if(r){const i=wf.Ts(e,r);i&&(n=i.state)}}return this.Ls.ds(e),this.Fs(),n}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Yw(this.persistenceKey,e))}updateQueryState(e,n,r){this.ks(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return ne("SharedClientState","READ",e,n),n}setItem(e,n){ne("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){ne("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){var n=this;const r=e;if(r.storageArea===this.storage){if(ne("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ys)return void Dn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,W.Z)(function*(){if(n.started){if(null!==r.key)if(n.Ss.test(r.key)){if(null==r.newValue){const i=n.Ks(r.key);return n.$s(i,null)}{const i=n.Us(r.key,r.newValue);if(i)return n.$s(i.clientId,i)}}else if(n.bs.test(r.key)){if(null!==r.newValue){const i=n.Ws(r.key,r.newValue);if(i)return n.Gs(i)}}else if(n.Ds.test(r.key)){if(null!==r.newValue){const i=n.zs(r.key,r.newValue);if(i)return n.js(i)}}else if(r.key===n.Cs){if(null!==r.newValue){const i=n.Ms(r.newValue);if(i)return n.xs(i)}}else if(r.key===n.ws){const i=function(o){let a=hi._e;if(null!=o)try{const u=JSON.parse(o);we("number"==typeof u),a=u}catch(u){Dn("SharedClientState","Failed to read sequence number from WebStorage",u)}return a}(r.newValue);i!==hi._e&&n.sequenceNumberHandler(i)}else if(r.key===n.vs){const i=n.Hs(r.newValue);yield Promise.all(i.map(s=>n.syncEngine.Js(s)))}}else n.ps.push(r)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,n,r){const i=new c_(this.currentUser,e,n,r),s=l1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Es())}Bs(e){const n=l1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}qs(e){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:e}))}ks(e,n,r){const i=Yw(this.persistenceKey,e),s=new wf(e,n,r);this.setItem(i,s.Es())}Qs(e){const n=JSON.stringify(Array.from(e));this.setItem(this.vs,n)}Ks(e){const n=this.Ss.exec(e);return n?n[1]:null}Us(e,n){const r=this.Ks(e);return l_.Ts(r,n)}Ws(e,n){const r=this.bs.exec(e),i=Number(r[1]);return c_.Ts(new Yn(void 0!==r[2]?r[2]:null),i,n)}zs(e,n){const r=this.Ds.exec(e),i=Number(r[1]);return wf.Ts(i,n)}Ms(e){return Jw.Ts(e)}Hs(e){return JSON.parse(e)}Gs(e){var n=this;return(0,W.Z)(function*(){if(e.user.uid===n.currentUser.uid)return n.syncEngine.Ys(e.batchId,e.state,e.error);ne("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,n){const r=n?this.gs.insert(e,n):this.gs.remove(e),i=this.Os(this.gs),s=this.Os(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.Xs(o,a).then(()=>{this.gs=r})}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let n=Tw();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class d1{constructor(){this.eo=new Xw,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,n,r){this.no[e]=n}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Xw,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class r6{ro(e){}shutdown(){}}class h1{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){ne("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){ne("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let d_=null;function tT(){return null===d_?d_=268435456+Math.round(2147483648*Math.random()):d_++,"0x"+d_.toString(16)}const i6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class s6{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const Er="WebChannelConnection";class o6 extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.mo=r+"://"+n.host,this.fo=`projects/${i}/databases/${s}`,this.po="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get yo(){return!1}wo(n,r,i,s,o){const a=tT(),u=this.So(n,r);ne("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);const l={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(l,s,o),this.Do(n,u,l,i).then(h=>(ne("RestConnection",`Received RPC '${n}' ${a}: `,h),h),h=>{throw Qr("RestConnection",`RPC '${n}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}Co(n,r,i,s,o,a){return this.wo(n,r,i,s,o)}bo(n,r,i){n["X-Goog-Api-Client"]="gl-js/ fire/"+Jc,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}So(n,r){return`${this.mo}/v1/${r}:${i6[n]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,n,r,i){const s=tT();return new Promise((o,a)=>{const u=new rW;u.setWithCredentials(!0),u.listenOnce(eW.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case uw.NO_ERROR:const h=u.getResponseJson();ne(Er,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case uw.TIMEOUT:ne(Er,`RPC '${e}' ${s} timed out`),a(new J(B.DEADLINE_EXCEEDED,"Request time out"));break;case uw.HTTP_ERROR:const g=u.getStatus();if(ne(Er,`RPC '${e}' ${s} failed with status:`,g,"response text:",u.getResponseText()),g>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const D=function(b){const F=b.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(F)>=0?F:B.UNKNOWN}(y.status);a(new J(D,y.message))}else a(new J(B.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new J(B.UNAVAILABLE,"Connection failed."));break;default:ge()}}finally{ne(Er,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);ne(Er,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",l,r,15)})}vo(e,n,r){const i=tT(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Jq(),a=Xq(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new nW({})),this.bo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=s.join("");ne(Er,`Creating RPC '${e}' stream ${i}: ${h}`,u);const g=o.createWebChannel(h,u);let m=!1,y=!1;const D=new s6({co:b=>{y?ne(Er,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(m||(ne(Er,`Opening RPC '${e}' stream ${i} transport.`),g.open(),m=!0),ne(Er,`RPC '${e}' stream ${i} sending:`,b),g.send(b))},lo:()=>g.close()}),C=(b,F,N)=>{b.listen(F,V=>{try{N(V)}catch(Z){setTimeout(()=>{throw Z},0)}})};return C(g,km.EventType.OPEN,()=>{y||ne(Er,`RPC '${e}' stream ${i} transport opened.`)}),C(g,km.EventType.CLOSE,()=>{y||(y=!0,ne(Er,`RPC '${e}' stream ${i} transport closed`),D.Ro())}),C(g,km.EventType.ERROR,b=>{y||(y=!0,Qr(Er,`RPC '${e}' stream ${i} transport errored:`,b),D.Ro(new J(B.UNAVAILABLE,"The operation could not be completed")))}),C(g,km.EventType.MESSAGE,b=>{var F;if(!y){const N=b.data[0];we(!!N);const Z=N.error||(null===(F=N[0])||void 0===F?void 0:F.error);if(Z){ne(Er,`RPC '${e}' stream ${i} received error:`,Z);const se=Z.status;let be=function(_o){const j_=Pn[_o];if(void 0!==j_)return sM(j_)}(se),ht=Z.message;void 0===be&&(be=B.INTERNAL,ht="Unknown error status: "+se+" with message "+Z.message),y=!0,D.Ro(new J(be,ht)),g.close()}else ne(Er,`RPC '${e}' stream ${i} received:`,N),D.Vo(N)}}),C(a,tW.STAT_EVENT,b=>{b.stat===QN.PROXY?ne(Er,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===QN.NOPROXY&&ne(Er,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.Ao()},0),D}}function f1(){return typeof window<"u"?window:null}function h_(){return typeof document<"u"?document:null}function Tf(t){return new m9(t,!0)}class nT{constructor(e,n,r=1e3,i=1.5,s=6e4){this.si=e,this.timerId=n,this.Fo=r,this.Mo=i,this.xo=s,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const n=Math.floor(this.Oo+this.qo()),r=Math.max(0,Date.now()-this.Bo),i=Math.max(0,n-r);i>0&&ne("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Oo} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,i,()=>(this.Bo=Date.now(),e())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class p1{constructor(e,n,r,i,s,o,a,u){this.si=e,this.Ko=r,this.$o=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new nT(e,n)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var e=this;return(0,W.Z)(function*(){e.jo()&&(yield e.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(e){this.t_(),this.stream.send(e)}Xo(){var e=this;return(0,W.Z)(function*(){if(e.Ho())return e.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(e,n){var r=this;return(0,W.Z)(function*(){r.t_(),r.n_(),r.zo.cancel(),r.Uo++,4!==e?r.zo.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(Dn(n.toString()),Dn("Using maximum backoff delay to prevent overloading the backend."),r.zo.Lo()):n&&n.code===B.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.r_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Io(n)})()}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),n=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Uo===n&&this.s_(r,i)},r=>{e(()=>{const i=new J(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.o_(i)})})}s_(e,n){const r=this.i_(this.Uo);this.stream=this.__(e,n),this.stream.ho(()=>{r(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(i=>{r(()=>this.o_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Jo(){var e=this;this.state=5,this.zo.ko((0,W.Z)(function*(){e.state=0,e.start()}))}o_(e){return ne("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return n=>{this.si.enqueueAndForget(()=>this.Uo===e?n():(ne("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class a6 extends p1{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}__(e,n){return this.connection.vo("Listen",e,n)}onMessage(e){this.zo.reset();const n=function v9(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(l=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===l?1:"REMOVE"===l?2:"CURRENT"===l?3:"RESET"===l?4:ge(),i=e.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(we(void 0===h||"string"==typeof h),jn.fromBase64String(h||"")):(we(void 0===h||h instanceof Uint8Array),jn.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const h=void 0===l.code?B.UNKNOWN:sM(l.code);return new J(h,l.message||"")}(o);n=new lM(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=As(t,r.document.name),s=An(r.document.updateTime),o=r.document.createTime?An(r.document.createTime):Te.min(),a=new cr({mapValue:{fields:r.document.fields}}),u=Kt.newFoundDocument(i,s,o,a);n=new Ym(r.targetIds||[],r.removedTargetIds||[],u.key,u)}else if("documentDelete"in e){const r=e.documentDelete,i=As(t,r.document),s=r.readTime?An(r.readTime):Te.min(),o=Kt.newNoDocument(i,s);n=new Ym([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=As(t,r.document);n=new Ym([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ge();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new l9(i,s);n=new cM(r.targetId,o)}}var l;return n}(this.serializer,e),r=function(s){if(!("targetChange"in s))return Te.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?Te.min():o.readTime?An(o.readTime):Te.min()}(e);return this.listener.a_(n,r)}u_(e){const n={};n.database=pf(this.serializer),n.addTarget=function(s,o){let a;const u=o.target;if(a=zm(u)?{documents:IM(s,u)}:{query:Mw(s,u)},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=pM(s,o.resumeToken);const l=Rw(s,o.expectedCount);null!==l&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Te.min())>0){a.readTime=fl(s,o.snapshotVersion.toTimestamp());const l=Rw(s,o.expectedCount);null!==l&&(a.expectedCount=l)}return a}(this.serializer,e);const r=function E9(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ge()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.e_(n)}c_(e){const n={};n.database=pf(this.serializer),n.removeTarget=e,this.e_(n)}}class u6 extends p1{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,n){return this.connection.vo("Write",e,n)}onMessage(e){if(we(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const n=function I9(t,e){return t&&t.length>0?(we(void 0!==e),t.map(n=>function(i,s){let o=An(i.updateTime?i.updateTime:s);return o.isEqual(Te.min())&&(o=An(s)),new o9(o,i.transformResults||[])}(n,e))):[]}(e.writeResults,e.commitTime),r=An(e.commitTime);return this.listener.I_(r,n)}return we(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=pf(this.serializer),this.e_(e)}P_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>gf(this.serializer,r))};this.e_(n)}}class c6 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.d_=!1}A_(){if(this.d_)throw new J(B.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.wo(e,n,r,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J(B.UNKNOWN,i.toString())})}Co(e,n,r,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,n,r,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new J(B.UNKNOWN,s.toString())})}terminate(){this.d_=!0}}class d6{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(Dn(n),this.f_=!1):ne("OnlineStateTracker",n)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class h6{constructor(e,n,r,i,s){var o=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=s,this.F_.ro(a=>{r.enqueueAndForget((0,W.Z)(function*(){var u;aa(o)&&(ne("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,W.Z)(function*(h){const g=oe(h);g.C_.add(4),yield El(g),g.M_.set("Unknown"),g.C_.delete(4),yield Df(g)}),function l(h){return u.apply(this,arguments)})(o))}))}),this.M_=new d6(r,i)}}function Df(t){return iT.apply(this,arguments)}function iT(){return iT=(0,W.Z)(function*(t){if(aa(t))for(const e of t.v_)yield e(!0)}),iT.apply(this,arguments)}function El(t){return sT.apply(this,arguments)}function sT(){return sT=(0,W.Z)(function*(t){for(const e of t.v_)yield e(!1)}),sT.apply(this,arguments)}function f_(t,e){const n=oe(t);n.D_.has(e.targetId)||(n.D_.set(e.targetId,e),uT(n)?aT(n):Tl(n).Ho()&&oT(n,e))}function Af(t,e){const n=oe(t),r=Tl(n);n.D_.delete(e),r.Ho()&&g1(n,e),0===n.D_.size&&(r.Ho()?r.Zo():aa(n)&&n.M_.set("Unknown"))}function oT(t,e){if(t.x_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Tl(t).u_(e)}function g1(t,e){t.x_.Oe(e),Tl(t).c_(e)}function aT(t){t.x_=new h9({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.D_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Tl(t).start(),t.M_.g_()}function uT(t){return aa(t)&&!Tl(t).jo()&&t.D_.size>0}function aa(t){return 0===oe(t).C_.size}function m1(t){t.x_=void 0}function f6(t){return cT.apply(this,arguments)}function cT(){return cT=(0,W.Z)(function*(t){t.D_.forEach((e,n)=>{oT(t,e)})}),cT.apply(this,arguments)}function p6(t,e){return lT.apply(this,arguments)}function lT(){return lT=(0,W.Z)(function*(t,e){m1(t),uT(t)?(t.M_.w_(e),aT(t)):t.M_.set("Unknown")}),lT.apply(this,arguments)}function g6(t,e,n){return dT.apply(this,arguments)}function dT(){return dT=(0,W.Z)(function*(t,e,n){if(t.M_.set("Online"),e instanceof lM&&2===e.state&&e.cause)try{yield(r=(0,W.Z)(function*(s,o){const a=o.cause;for(const u of o.targetIds)s.D_.has(u)&&(yield s.remoteSyncer.rejectListen(u,a),s.D_.delete(u),s.x_.removeTarget(u))}),function i(s,o){return r.apply(this,arguments)})(t,e)}catch(r){ne("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield p_(t,r)}else if(e instanceof Ym?t.x_.$e(e):e instanceof cM?t.x_.Je(e):t.x_.Ge(e),!n.isEqual(Te.min()))try{const r=yield i1(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){const a=s.x_.it(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const h=s.D_.get(l);h&&s.D_.set(l,h.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{const h=s.D_.get(u);if(!h)return;s.D_.set(u,h.withResumeToken(jn.EMPTY_BYTE_STRING,h.snapshotVersion)),g1(s,u);const g=new lo(h.target,u,l,h.sequenceNumber);oT(s,g)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){ne("RemoteStore","Failed to raise snapshot:",r),yield p_(t,r)}var r}),dT.apply(this,arguments)}function p_(t,e,n){return hT.apply(this,arguments)}function hT(){return hT=(0,W.Z)(function*(t,e,n){if(!Ko(e))throw e;t.C_.add(1),yield El(t),t.M_.set("Offline"),n||(n=()=>i1(t.localStore)),t.asyncQueue.enqueueRetryable((0,W.Z)(function*(){ne("RemoteStore","Retrying IndexedDB access"),yield n(),t.C_.delete(1),yield Df(t)}))}),hT.apply(this,arguments)}function _1(t,e){return e().catch(n=>p_(t,n,e))}function wl(t){return fT.apply(this,arguments)}function fT(){return fT=(0,W.Z)(function*(t){const e=oe(t),n=ua(e);let r=e.b_.length>0?e.b_[e.b_.length-1].batchId:-1;for(;m6(e);)try{const i=yield e6(e.localStore,r);if(null===i){0===e.b_.length&&n.Zo();break}r=i.batchId,_6(e,i)}catch(i){yield p_(e,i)}y1(e)&&v1(e)}),fT.apply(this,arguments)}function m6(t){return aa(t)&&t.b_.length<10}function _6(t,e){t.b_.push(e);const n=ua(t);n.Ho()&&n.h_&&n.P_(e.mutations)}function y1(t){return aa(t)&&!ua(t).jo()&&t.b_.length>0}function v1(t){ua(t).start()}function y6(t){return pT.apply(this,arguments)}function pT(){return pT=(0,W.Z)(function*(t){ua(t).E_()}),pT.apply(this,arguments)}function v6(t){return gT.apply(this,arguments)}function gT(){return gT=(0,W.Z)(function*(t){const e=ua(t);for(const n of t.b_)e.P_(n.mutations)}),gT.apply(this,arguments)}function I6(t,e,n){return mT.apply(this,arguments)}function mT(){return mT=(0,W.Z)(function*(t,e,n){const r=t.b_.shift(),i=Cw.from(r,e,n);yield _1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield wl(t)}),mT.apply(this,arguments)}function E6(t,e){return _T.apply(this,arguments)}function _T(){return _T=(0,W.Z)(function*(t,e){var n;e&&ua(t).h_&&(yield(n=(0,W.Z)(function*(i,s){if(iM(a=s.code)&&a!==B.ABORTED){const o=i.b_.shift();ua(i).Yo(),yield _1(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield wl(i)}var a}),function r(i,s){return n.apply(this,arguments)})(t,e)),y1(t)&&v1(t)}),_T.apply(this,arguments)}function I1(t,e){return yT.apply(this,arguments)}function yT(){return yT=(0,W.Z)(function*(t,e){const n=oe(t);n.asyncQueue.verifyOperationInProgress(),ne("RemoteStore","RemoteStore received new credentials");const r=aa(n);n.C_.add(3),yield El(n),r&&n.M_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.C_.delete(3),yield Df(n)}),yT.apply(this,arguments)}function vT(t,e){return IT.apply(this,arguments)}function IT(){return IT=(0,W.Z)(function*(t,e){const n=oe(t);e?(n.C_.delete(2),yield Df(n)):e||(n.C_.add(2),yield El(n),n.M_.set("Unknown"))}),IT.apply(this,arguments)}function Tl(t){return t.O_||(t.O_=function(n,r,i){const s=oe(n);return s.A_(),new a6(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:f6.bind(null,t),Io:p6.bind(null,t),a_:g6.bind(null,t)}),t.v_.push(function(){var e=(0,W.Z)(function*(n){n?(t.O_.Yo(),uT(t)?aT(t):t.M_.set("Unknown")):(yield t.O_.stop(),m1(t))});return function(n){return e.apply(this,arguments)}}())),t.O_}function ua(t){return t.N_||(t.N_=function(n,r,i){const s=oe(n);return s.A_(),new u6(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{ho:y6.bind(null,t),Io:E6.bind(null,t),T_:v6.bind(null,t),I_:I6.bind(null,t)}),t.v_.push(function(){var e=(0,W.Z)(function*(n){n?(t.N_.Yo(),yield wl(t)):(yield t.N_.stop(),t.b_.length>0&&(ne("RemoteStore",`Stopping write stream with ${t.b_.length} pending writes`),t.b_=[]))});return function(n){return e.apply(this,arguments)}}())),t.N_}class ET{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Bn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new ET(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new J(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dl(t,e){if(Dn("AsyncQueue",`${e}: ${t}`),Ko(t))return new J(B.UNAVAILABLE,`${e}: ${t}`);throw t}class Al{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ae.comparator(n.key,r.key):(n,r)=>ae.comparator(n.key,r.key),this.keyedMap=of(),this.sortedSet=new Vt(this.comparator)}static emptySet(e){return new Al(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Al)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new Al;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class E1{constructor(){this.B_=new Vt(ae.comparator)}track(e){const n=e.doc.key,r=this.B_.get(n);r?0!==e.type&&3===r.type?this.B_=this.B_.insert(n,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(n):1===e.type&&2===r.type?this.B_=this.B_.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(n,{type:2,doc:e.doc}):ge():this.B_=this.B_.insert(n,e)}L_(){const e=[];return this.B_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Cl{constructor(e,n,r,i,s,o,a,u,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Cl(e,n,Al.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}class w6{constructor(){this.k_=void 0,this.listeners=[]}}class T6{constructor(){this.queries=new uo(e=>Ux(e),rf),this.onlineState="Unknown",this.q_=new Set}}function wT(t,e){return TT.apply(this,arguments)}function TT(){return TT=(0,W.Z)(function*(t,e){const n=oe(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new w6),i)try{s.k_=yield n.onListen(r)}catch(o){const a=Dl(o,`Initialization of query '${ul(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Q_(n.onlineState),s.k_&&e.K_(s.k_)&&CT(n)}),TT.apply(this,arguments)}function DT(t,e){return AT.apply(this,arguments)}function AT(){return AT=(0,W.Z)(function*(t,e){const n=oe(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}),AT.apply(this,arguments)}function D6(t,e){const n=oe(t);let r=!1;for(const i of e){const o=n.queries.get(i.query);if(o){for(const a of o.listeners)a.K_(i)&&(r=!0);o.k_=i}}r&&CT(n)}function A6(t,e,n){const r=oe(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function CT(t){t.q_.forEach(e=>{e.next()})}class ST{constructor(e,n,r){this.query=e,this.U_=n,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=r||{}}K_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new Cl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.W_?this.z_(e)&&(this.U_.next(e),n=!0):this.j_(e,this.onlineState)&&(this.H_(e),n=!0),this.G_=e,n}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let n=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),n=!0),n}j_(e,n){return!e.fromCache||(!this.options.J_||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}z_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(e){e=Cl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class C6{constructor(e,n){this.Y_=e,this.byteLength=n}Z_(){return"metadata"in this.Y_}}class w1{constructor(e){this.serializer=e}hs(e){return As(this.serializer,e)}Ps(e){return e.metadata.exists?vM(this.serializer,e.document,!1):Kt.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return An(e)}}class S6{constructor(e,n,r){this.X_=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=T1(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++n;const r=lt.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ta(e){const n=new Map,r=new w1(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.hs(i.metadata.name);for(const o of i.metadata.queries){const a=(n.get(o)||He()).add(s);n.set(o,a)}}return n}complete(){var e=this;return(0,W.Z)(function*(){const n=yield function t6(t,e,n,r){return Kw.apply(this,arguments)}(e.localStore,new w1(e.serializer),e.documents,e.X_.id),r=e.ta(e.documents);for(const i of e.queries)yield n6(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,na:e.collectionGroups,ra:n}})()}}function T1(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}class D1{constructor(e){this.key=e}}class A1{constructor(e){this.key=e}}class C1{constructor(e,n){this.query=e,this.ia=n,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=He(),this.mutatedKeys=He(),this._a=jx(e),this.aa=new Al(this._a)}get ua(){return this.ia}ca(e,n){const r=n?n.la:new E1,i=n?n.aa:this.aa;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,g)=>{const m=i.get(h),y=sf(this.query,g)?g:null,D=!!m&&this.mutatedKeys.has(m.key),C=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let b=!1;m&&y?m.data.isEqual(y.data)?D!==C&&(r.track({type:3,doc:y}),b=!0):this.ha(m,y)||(r.track({type:2,doc:y}),b=!0,(u&&this._a(y,u)>0||l&&this._a(y,l)<0)&&(a=!0)):!m&&y?(r.track({type:0,doc:y}),b=!0):m&&!y&&(r.track({type:1,doc:m}),b=!0,(u||l)&&(a=!0)),b&&(y?(o=o.add(y),s=C?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const h="F"===this.query.limitType?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{aa:o,la:r,Zi:a,mutatedKeys:s}}ha(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const s=e.la.L_();s.sort((l,h)=>function(m,y){const D=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ge()}};return D(m)-D(y)}(l.type,h.type)||this._a(l.doc,h.doc)),this.Pa(r);const o=n?this.Ia():[],a=0===this.oa.size&&this.current?1:0,u=a!==this.sa;return this.sa=a,0!==s.length||u?{snapshot:new Cl(this.query,e.aa,i,s,e.mutatedKeys,0===a,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new E1,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach(n=>this.ia=this.ia.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.ia=this.ia.delete(n)),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=He(),this.aa.forEach(r=>{this.Ea(r.key)&&(this.oa=this.oa.add(r.key))});const n=[];return e.forEach(r=>{this.oa.has(r)||n.push(new A1(r))}),this.oa.forEach(r=>{e.has(r)||n.push(new D1(r))}),n}da(e){this.ia=e.ls,this.oa=He();const n=this.ca(e.documents);return this.applyChanges(n,!0)}Aa(){return Cl.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class b6{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class R6{constructor(e){this.key=e,this.Ra=!1}}class P6{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Va={},this.ma=new uo(a=>Ux(a),rf),this.fa=new Map,this.ga=new Set,this.pa=new Vt(ae.comparator),this.ya=new Map,this.wa=new jw,this.Sa={},this.ba=new Map,this.Da=au.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function N6(t,e){return bT.apply(this,arguments)}function bT(){return bT=(0,W.Z)(function*(t,e){const n=YT(t);let r,i;const s=n.ma.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const o=yield vl(n.localStore,Vr(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield RT(n,e,r,"current"===a,o.resumeToken),n.isPrimaryClient&&f_(n.remoteStore,o)}return i}),bT.apply(this,arguments)}function RT(t,e,n,r,i){return PT.apply(this,arguments)}function PT(){return PT=(0,W.Z)(function*(t,e,n,r,i){t.va=(g,m,y)=>{return(D=(0,W.Z)(function*(b,F,N,V){let Z=F.view.ca(N);Z.Zi&&(Z=yield u_(b.localStore,F.query,!1).then(({documents:ht})=>F.view.ca(ht,Z)));const se=V&&V.targetChanges.get(F.targetId),be=F.view.applyChanges(Z,b.isPrimaryClient,se);return BT(b,F.targetId,be.Ta),be.snapshot}),function C(b,F,N,V){return D.apply(this,arguments)})(t,g,m,y);var D};const s=yield u_(t.localStore,e,!0),o=new C1(e,s.ls),a=o.ca(s.documents),u=hf.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),l=o.applyChanges(a,t.isPrimaryClient,u);BT(t,n,l.Ta);const h=new b6(e,n,o);return t.ma.set(e,h),t.fa.has(n)?t.fa.get(n).push(e):t.fa.set(n,[e]),l.snapshot}),PT.apply(this,arguments)}function x6(t,e){return NT.apply(this,arguments)}function NT(){return NT=(0,W.Z)(function*(t,e){const n=oe(t),r=n.ma.get(e),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter(s=>!rf(s,e))),void n.ma.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Il(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Af(n.remoteStore,r.targetId),Sl(n,r.targetId)}).catch(Zo))):(Sl(n,r.targetId),yield Il(n.localStore,r.targetId,!0))}),NT.apply(this,arguments)}function xT(){return xT=(0,W.Z)(function*(t,e,n){const r=JT(t);try{const i=yield function(o,a){const u=oe(o),l=Jt.now(),h=a.reduce((y,D)=>y.add(D.key),He());let g,m;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let D=Jr(),C=He();return u.ss.getEntries(y,h).next(b=>{D=b,D.forEach((F,N)=>{N.isValidDocument()||(C=C.add(F))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,D)).next(b=>{g=b;const F=[];for(const N of a){const V=u9(N,g.get(N.key).overlayedDocument);null!=V&&F.push(new co(N.key,V,Dx(V.value.mapValue),Xt.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,F,a)}).next(b=>{m=b;const F=b.applyToLocalDocumentSet(g,C);return u.documentOverlayCache.saveOverlays(y,b.batchId,F)})}).then(()=>({batchId:m.batchId,changes:Hx(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let l=o.Sa[o.currentUser.toKey()];l||(l=new Vt(Fe)),l=l.insert(a,u),o.Sa[o.currentUser.toKey()]=l}(r,i.batchId,n),yield ho(r,i.changes),yield wl(r.remoteStore)}catch(i){const s=Dl(i,"Failed to persist write");n.reject(s)}}),xT.apply(this,arguments)}function S1(t,e){return MT.apply(this,arguments)}function MT(){return MT=(0,W.Z)(function*(t,e){const n=oe(t);try{const r=yield function X9(t,e){const n=oe(t),r=e.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const a=[];e.targetChanges.forEach((h,g)=>{const m=i.get(g);if(!m)return;a.push(n.qr.removeMatchingKeys(s,h.removedDocuments,g).next(()=>n.qr.addMatchingKeys(s,h.addedDocuments,g)));let y=m.withSequenceNumber(s.currentSequenceNumber);var C,b,F;null!==e.targetMismatches.get(g)?y=y.withResumeToken(jn.EMPTY_BYTE_STRING,Te.min()).withLastLimboFreeSnapshotVersion(Te.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(g,y),b=y,F=h,(0===(C=m).resumeToken.approximateByteSize()||b.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8||F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0)&&a.push(n.qr.updateTargetData(s,y))});let u=Jr(),l=He();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(s1(s,o,e.documentUpdates).next(h=>{u=h.us,l=h.cs})),!r.isEqual(Te.min())){const h=n.qr.getLastRemoteSnapshotVersion(s).next(g=>n.qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return O.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,l)).next(()=>u)}).then(s=>(n.ts=i,s))}(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.ya.get(s);o&&(we(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ra=!0:i.modifiedDocuments.size>0?we(o.Ra):i.removedDocuments.size>0&&(we(o.Ra),o.Ra=!1))}),yield ho(n,r,e)}catch(r){yield Zo(r)}}),MT.apply(this,arguments)}function b1(t,e,n){const r=oe(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const i=[];r.ma.forEach((s,o)=>{const a=o.view.Q_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const u=oe(o);u.onlineState=a;let l=!1;u.queries.forEach((h,g)=>{for(const m of g.listeners)m.Q_(a)&&(l=!0)}),l&&CT(u)}(r.eventManager,e),i.length&&r.Va.a_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function O6(t,e,n){return OT.apply(this,arguments)}function OT(){return OT=(0,W.Z)(function*(t,e,n){const r=oe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.ya.get(e),s=i&&i.key;if(s){let o=new Vt(ae.comparator);o=o.insert(s,Kt.newNoDocument(s,Te.min()));const a=He().add(s),u=new df(Te.min(),new Map,new Vt(Fe),o,a);yield S1(r,u),r.pa=r.pa.remove(s),r.ya.delete(e),jT(r)}else yield Il(r.localStore,e,!1).then(()=>Sl(r,e,n)).catch(Zo)}),OT.apply(this,arguments)}function k6(t,e){return kT.apply(this,arguments)}function kT(){return kT=(0,W.Z)(function*(t,e){const n=oe(t),r=e.batch.batchId;try{const i=yield function J9(t,e){const n=oe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.ss.newChangeBuffer({trackRemovals:!0});return function(a,u,l,h){const g=l.batch,m=g.keys();let y=O.resolve();return m.forEach(D=>{y=y.next(()=>h.getEntry(u,D)).next(C=>{const b=l.docVersions.get(D);we(null!==b),C.version.compareTo(b)<0&&(g.applyToRemoteDocument(C,l),C.isValidDocument()&&(C.setReadTime(l.commitVersion),h.addEntry(C)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,g))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=He();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}(n.localStore,e);UT(n,r,null),VT(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ho(n,i)}catch(i){yield Zo(i)}}),kT.apply(this,arguments)}function F6(t,e,n){return FT.apply(this,arguments)}function FT(){return FT=(0,W.Z)(function*(t,e,n){const r=oe(t);try{const i=yield function(o,a){const u=oe(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,a).next(g=>(we(null!==g),h=g.keys(),u.mutationQueue.removeMutationBatch(l,g))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})}(r.localStore,e);UT(r,e,n),VT(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ho(r,i)}catch(i){yield Zo(i)}}),FT.apply(this,arguments)}function LT(){return LT=(0,W.Z)(function*(t,e){const n=oe(t);aa(n.remoteStore)||ne("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=oe(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(-1===r)return void e.resolve();const i=n.ba.get(r)||[];i.push(e),n.ba.set(r,i)}catch(r){const i=Dl(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),LT.apply(this,arguments)}function VT(t,e){(t.ba.get(e)||[]).forEach(n=>{n.resolve()}),t.ba.delete(e)}function UT(t,e,n){const r=oe(t);let i=r.Sa[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Sa[r.currentUser.toKey()]=i}}function Sl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.fa.get(e))t.ma.delete(r),n&&t.Va.Fa(r,n);t.fa.delete(e),t.isPrimaryClient&&t.wa.Rr(e).forEach(r=>{t.wa.containsKey(r)||R1(t,r)})}function R1(t,e){t.ga.delete(e.path.canonicalString());const n=t.pa.get(e);null!==n&&(Af(t.remoteStore,n),t.pa=t.pa.remove(e),t.ya.delete(n),jT(t))}function BT(t,e,n){for(const r of n)r instanceof D1?(t.wa.addReference(r.key,e),V6(t,r)):r instanceof A1?(ne("SyncEngine","Document no longer in limbo: "+r.key),t.wa.removeReference(r.key,e),t.wa.containsKey(r.key)||R1(t,r.key)):ge()}function V6(t,e){const n=e.key,r=n.path.canonicalString();t.pa.get(n)||t.ga.has(r)||(ne("SyncEngine","New document in limbo: "+n),t.ga.add(r),jT(t))}function jT(t){for(;t.ga.size>0&&t.pa.size<t.maxConcurrentLimboResolutions;){const e=t.ga.values().next().value;t.ga.delete(e);const n=new ae(lt.fromString(e)),r=t.Da.next();t.ya.set(r,new R6(n)),t.pa=t.pa.insert(n,r),f_(t.remoteStore,new lo(Vr(ol(n.path)),r,"TargetPurposeLimboResolution",hi._e))}}function ho(t,e,n){return $T.apply(this,arguments)}function $T(){return $T=(0,W.Z)(function*(t,e,n){const r=oe(t),i=[],s=[],o=[];var a;r.ma.isEmpty()||(r.ma.forEach((a,u)=>{o.push(r.va(u,e,n).then(l=>{if((l||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const h=Ww.Qi(u.targetId,l);s.push(h)}}))}),yield Promise.all(o),r.Va.a_(i),yield(a=(0,W.Z)(function*(l,h){const g=oe(l);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(h,y=>O.forEach(y.ki,D=>g.persistence.referenceDelegate.addReference(m,y.targetId,D)).next(()=>O.forEach(y.qi,D=>g.persistence.referenceDelegate.removeReference(m,y.targetId,D)))))}catch(m){if(!Ko(m))throw m;ne("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const y=m.targetId;if(!m.fromCache){const D=g.ts.get(y),b=D.withLastLimboFreeSnapshotVersion(D.snapshotVersion);g.ts=g.ts.insert(y,b)}}}),function u(l,h){return a.apply(this,arguments)})(r.localStore,s))}),$T.apply(this,arguments)}function U6(t,e){return HT.apply(this,arguments)}function HT(){return HT=(0,W.Z)(function*(t,e){const n=oe(t);if(!n.currentUser.isEqual(e)){ne("SyncEngine","User change. New user:",e.toKey());const r=yield r1(n.localStore,e);n.currentUser=e,(s=n).ba.forEach(a=>{a.forEach(u=>{u.reject(new J(B.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ba.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ho(n,r._s)}var s}),HT.apply(this,arguments)}function B6(t,e){const n=oe(t),r=n.ya.get(e);if(r&&r.Ra)return He().add(r.key);{let i=He();const s=n.fa.get(e);if(!s)return i;for(const o of s){const a=n.ma.get(o);i=i.unionWith(a.view.ua)}return i}}function j6(t,e){return zT.apply(this,arguments)}function zT(){return zT=(0,W.Z)(function*(t,e){const n=oe(t),r=yield u_(n.localStore,e.query,!0),i=e.view.da(r);return n.isPrimaryClient&&BT(n,e.targetId,i.Ta),i}),zT.apply(this,arguments)}function $6(t,e){return qT.apply(this,arguments)}function qT(){return qT=(0,W.Z)(function*(t,e){const n=oe(t);return a1(n.localStore,e).then(r=>ho(n,r))}),qT.apply(this,arguments)}function H6(t,e,n,r){return WT.apply(this,arguments)}function WT(){return WT=(0,W.Z)(function*(t,e,n,r){const i=oe(t),s=yield function(a,u){const l=oe(a),h=oe(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",g=>h.Cn(g,u).next(m=>m?l.localDocuments.getDocuments(g,m):O.resolve(null)))}(i.localStore,e);var u;null!==s?("pending"===n?yield wl(i.remoteStore):"acknowledged"===n||"rejected"===n?(UT(i,e,r||null),VT(i,e),u=e,oe(oe(i.localStore).mutationQueue).Fn(u)):ge(),yield ho(i,s)):ne("SyncEngine","Cannot apply mutation batch with id: "+e)}),WT.apply(this,arguments)}function GT(){return GT=(0,W.Z)(function*(t,e){const n=oe(t);if(YT(n),JT(n),!0===e&&!0!==n.Ca){const r=n.sharedClientState.getAllActiveQueryTargets(),i=yield P1(n,r.toArray());n.Ca=!0,yield vT(n.remoteStore,!0);for(const s of i)f_(n.remoteStore,s)}else if(!1===e&&!1!==n.Ca){const r=[];let i=Promise.resolve();n.fa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Sl(n,o),Il(n.localStore,o,!0))),Af(n.remoteStore,o)}),yield i,yield P1(n,r),function(o){const a=oe(o);a.ya.forEach((u,l)=>{Af(a.remoteStore,l)}),a.wa.Vr(),a.ya=new Map,a.pa=new Vt(ae.comparator)}(n),n.Ca=!1,yield vT(n.remoteStore,!1)}}),GT.apply(this,arguments)}function P1(t,e,n){return ZT.apply(this,arguments)}function ZT(){return ZT=(0,W.Z)(function*(t,e,n){const r=oe(t),i=[],s=[];for(const o of e){let a;const u=r.fa.get(o);if(u&&0!==u.length){a=yield vl(r.localStore,Vr(u[0]));for(const l of u){const h=r.ma.get(l),g=yield j6(r,h);g.snapshot&&s.push(g.snapshot)}}else{const l=yield o1(r.localStore,o);a=yield vl(r.localStore,l),yield RT(r,N1(l),o,!1,a.resumeToken)}i.push(a)}return r.Va.a_(s),i}),ZT.apply(this,arguments)}function N1(t){return Fx(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function q6(t){return n=oe(t).localStore,oe(oe(n).persistence).Bi();var n}function W6(t,e,n,r){return KT.apply(this,arguments)}function KT(){return KT=(0,W.Z)(function*(t,e,n,r){const i=oe(t);if(i.Ca)return void ne("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=yield a1(i.localStore,Bx(s[0])),a=df.createSynthesizedRemoteEventForCurrentChange(e,"current"===n,jn.EMPTY_BYTE_STRING);yield ho(i,o,a);break}case"rejected":yield Il(i.localStore,e,!0),Sl(i,e,r);break;default:ge()}}),KT.apply(this,arguments)}function G6(t,e,n){return QT.apply(this,arguments)}function QT(){return QT=(0,W.Z)(function*(t,e,n){const r=YT(t);if(r.Ca){for(const i of e){if(r.fa.has(i)){ne("SyncEngine","Adding an already active target "+i);continue}const s=yield o1(r.localStore,i),o=yield vl(r.localStore,s);yield RT(r,N1(s),o.targetId,!1,o.resumeToken),f_(r.remoteStore,o)}for(const i of n)r.fa.has(i)&&(yield Il(r.localStore,i,!1).then(()=>{Af(r.remoteStore,i),Sl(r,i)}).catch(Zo))}}),QT.apply(this,arguments)}function YT(t){const e=oe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=S1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=B6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=O6.bind(null,e),e.Va.a_=D6.bind(null,e.eventManager),e.Va.Fa=A6.bind(null,e.eventManager),e}function JT(t){const e=oe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=k6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=F6.bind(null,e),e}class Cf{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return(0,W.Z)(function*(){n.serializer=Tf(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return n1(this.persistence,new t1,e.initialUser,this.serializer)}createPersistence(e){return new $w(s_.jr,this.serializer)}createSharedClientState(e){return new d1}terminate(){var e=this;return(0,W.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class XT extends Cf{constructor(e,n,r){super(),this.xa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var n=()=>super.initialize,r=this;return(0,W.Z)(function*(){yield n().call(r,e),yield r.xa.initialize(r,e),yield JT(r.xa.syncEngine),yield wl(r.xa.remoteStore),yield r.persistence.mi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(e){return n1(this.persistence,new t1,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){return new WM(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new IW(n,this.persistence);return new vW(e.asyncQueue,r)}createPersistence(e){const n=qw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new zw(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,f1(),h_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new d1}}class x1 extends XT{constructor(e,n){super(e,n,!1),this.xa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){var n=()=>super.initialize,r=this;return(0,W.Z)(function*(){yield n().call(r,e);const i=r.xa.syncEngine;r.sharedClientState instanceof eT&&(r.sharedClientState.syncEngine={Ys:H6.bind(null,i),Zs:W6.bind(null,i),Xs:G6.bind(null,i),Bi:q6.bind(null,i),Js:$6.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.mi(function(){var s=(0,W.Z)(function*(o){yield function z6(t,e){return GT.apply(this,arguments)}(r.xa.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}createSharedClientState(e){const n=f1();if(!eT.D(n))throw new J(B.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=qw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new eT(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class bl{initialize(e,n){var r=this;return(0,W.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>b1(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=U6.bind(null,r.syncEngine),yield vT(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new T6}createDatastore(e){const n=Tf(e.databaseInfo.databaseId),r=new o6(e.databaseInfo);return new c6(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return r=this.localStore,i=this.datastore,s=e.asyncQueue,o=n=>b1(this.syncEngine,n,0),a=h1.D()?new h1:new r6,new h6(r,i,s,o,a);var r,i,s,o,a}createSyncEngine(e,n){return function(i,s,o,a,u,l,h){const g=new P6(i,s,o,a,u,l);return h&&(g.Ca=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return(e=(0,W.Z)(function*(r){const i=oe(r);ne("RemoteStore","RemoteStore shutting down."),i.C_.add(5),yield El(i),i.F_.shutdown(),i.M_.set("Unknown")}),function n(r){return e.apply(this,arguments)})(this.remoteStore);var e}}function M1(t,e=10240){let n=0;return{read:()=>(0,W.Z)(function*(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}})(),cancel:()=>(0,W.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class g_{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):Dn("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class Q6{constructor(e,n){this.Ba=e,this.serializer=n,this.metadata=new Bn,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(r=>{r&&r.Z_()?this.metadata.resolve(r.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.Y_)}`))},r=>this.metadata.reject(r))}close(){return this.Ba.cancel()}getMetadata(){var e=this;return(0,W.Z)(function*(){return e.metadata.promise})()}Ma(){var e=this;return(0,W.Z)(function*(){return yield e.getMetadata(),e.ka()})()}ka(){var e=this;return(0,W.Z)(function*(){const n=yield e.qa();if(null===n)return null;const r=e.La.decode(n),i=Number(r);isNaN(i)&&e.Qa(`length string (${r}) is not valid number`);const s=yield e.Ka(i);return new C6(JSON.parse(s),n.length+i)})()}$a(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}qa(){var e=this;return(0,W.Z)(function*(){for(;e.$a()<0&&!(yield e.Ua()););if(0===e.buffer.length)return null;const n=e.$a();n<0&&e.Qa("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,n);return e.buffer=e.buffer.slice(n),r})()}Ka(e){var n=this;return(0,W.Z)(function*(){for(;n.buffer.length<e;)(yield n.Ua())&&n.Qa("Reached the end of bundle when more is expected.");const r=n.La.decode(n.buffer.slice(0,e));return n.buffer=n.buffer.slice(e),r})()}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}Ua(){var e=this;return(0,W.Z)(function*(){const n=yield e.Ba.read();if(!n.done){const r=new Uint8Array(e.buffer.length+n.value.length);r.set(e.buffer),r.set(n.value,e.buffer.length),e.buffer=r}return n.done})()}}class Y6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var n=this;return(0,W.Z)(function*(){if(n.ensureCommitNotCalled(),n.mutations.length>0)throw new J(B.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,W.Z)(function*(o,a){const u=oe(o),l=pf(u.serializer)+"/documents",h={documents:a.map(D=>ff(u.serializer,D))},g=yield u.Co("BatchGetDocuments",l,h,a.length),m=new Map;g.forEach(D=>{const C=function y9(t,e){return"found"in e?function(r,i){we(!!i.found);const s=As(r,i.found.name),o=An(i.found.updateTime),a=i.found.createTime?An(i.found.createTime):Te.min(),u=new cr({mapValue:{fields:i.found.fields}});return Kt.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){we(!!i.missing),we(!!i.readTime);const s=As(r,i.missing),o=An(i.readTime);return Kt.newNoDocument(s,o)}(t,e):ge()}(u.serializer,D);m.set(C.key.toString(),C)});const y=[];return a.forEach(D=>{const C=m.get(D.toString());we(!!C),y.push(C)}),y}),function s(o,a){return i.apply(this,arguments)})(n.datastore,e);var i;return r.forEach(i=>n.recordVersion(i)),r})()}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new hl(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,W.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const n=e.readVersions;var r;e.mutations.forEach(r=>{n.delete(r.key.toString())}),n.forEach((r,i)=>{const s=ae.fromPath(i);e.mutations.push(new Dw(s,e.precondition(s)))}),yield(r=(0,W.Z)(function*(s,o){const a=oe(s),u=pf(a.serializer)+"/documents",l={writes:o.map(h=>gf(a.serializer,h))};yield a.wo("Commit",u,l)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw ge();n=Te.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new J(B.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Te.min())?Xt.exists(!1):Xt.updateTime(n):Xt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Te.min()))throw new J(B.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xt.updateTime(n)}return Xt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class J6{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Wa=r.maxAttempts,this.zo=new nT(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var e=this;this.zo.ko((0,W.Z)(function*(){const n=new Y6(e.datastore),r=e.za(n);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>n.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.ja(s)}))}).catch(i=>{e.ja(i)})}))}za(e){try{const n=this.updateFunction(e);return!Kh(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const n=e.code;return"aborted"===n||"failed-precondition"===n||"already-exists"===n||!iM(n)}return!1}}class X6{constructor(e,n,r,i){var s=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Yn.UNAUTHENTICATED,this.clientId=ex.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=(0,W.Z)(function*(a){ne("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(ne("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return(0,W.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new J(B.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new Bn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,W.Z)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const i=Dl(r,"Failed to shutdown persistence");n.reject(i)}})),n.promise}}function m_(t,e){return eD.apply(this,arguments)}function eD(){return eD=(0,W.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress(),ne("FirestoreClient","Initializing OfflineComponentProvider");const n=yield t.getConfiguration();yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var i=(0,W.Z)(function*(s){r.isEqual(s)||(yield r1(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),eD.apply(this,arguments)}function tD(t,e){return nD.apply(this,arguments)}function nD(){return nD=(0,W.Z)(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield rD(t);ne("FirestoreClient","Initializing OnlineComponentProvider");const r=yield t.getConfiguration();yield e.initialize(n,r),t.setCredentialChangeListener(i=>I1(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>I1(e.remoteStore,s)),t._onlineComponents=e}),nD.apply(this,arguments)}function O1(t){return"FirebaseError"===t.name?t.code===B.FAILED_PRECONDITION||t.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}function rD(t){return iD.apply(this,arguments)}function iD(){return iD=(0,W.Z)(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ne("FirestoreClient","Using user provided OfflineComponentProvider");try{yield m_(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!O1(n))throw n;Qr("Error using user provided cache. Falling back to memory cache: "+n),yield m_(t,new Cf)}}else ne("FirestoreClient","Using default OfflineComponentProvider"),yield m_(t,new Cf);return t._offlineComponents}),iD.apply(this,arguments)}function __(t){return sD.apply(this,arguments)}function sD(){return sD=(0,W.Z)(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ne("FirestoreClient","Using user provided OnlineComponentProvider"),yield tD(t,t._uninitializedComponentsProvider._online)):(ne("FirestoreClient","Using default OnlineComponentProvider"),yield tD(t,new bl))),t._onlineComponents}),sD.apply(this,arguments)}function k1(t){return rD(t).then(e=>e.persistence)}function Rl(t){return rD(t).then(e=>e.localStore)}function F1(t){return __(t).then(e=>e.remoteStore)}function oD(t){return __(t).then(e=>e.syncEngine)}function Pl(t){return aD.apply(this,arguments)}function aD(){return aD=(0,W.Z)(function*(t){const e=yield __(t),n=e.eventManager;return n.onListen=N6.bind(null,e.syncEngine),n.onUnlisten=x6.bind(null,e.syncEngine),n}),aD.apply(this,arguments)}function V1(t,e,n={}){const r=new Bn;return t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return function(s,o,a,u,l){const h=new g_({next:m=>{o.enqueueAndForget(()=>DT(s,g));const y=m.docs.has(a);!y&&m.fromCache?l.reject(new J(B.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&u&&"server"===u.source?l.reject(new J(B.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),g=new ST(ol(a.path),h,{includeMetadataChanges:!0,J_:!0});return wT(s,g)}(yield Pl(t),t.asyncQueue,e,n,r)})),r.promise}function U1(t,e,n={}){const r=new Bn;return t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return function(s,o,a,u,l){const h=new g_({next:m=>{o.enqueueAndForget(()=>DT(s,g)),m.fromCache&&"server"===u.source?l.reject(new J(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),g=new ST(a,h,{includeMetadataChanges:!0,J_:!0});return wT(s,g)}(yield Pl(t),t.asyncQueue,e,n,r)})),r.promise}function B1(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const j1=new Map;function uD(t,e,n){if(!n)throw new J(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $1(t,e,n,r){if(!0===e&&!0===r)throw new J(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function H1(t){if(!ae.isDocumentKey(t))throw new J(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function z1(t){if(ae.isDocumentKey(t))throw new J(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function y_(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(r=t).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof t?"a function":ge()}function nt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=y_(t);throw new J(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function q1(t,e){if(e<=0)throw new J(B.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}class W1{constructor(e){var n,r;if(void 0===e.host){if(void 0!==e.ssl)throw new J(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new J(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=B1(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new J(B.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new J(B.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new J(B.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new W1({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new J(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new J(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new W1(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new aW;switch(r.type){case"firstParty":return new dW(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=j1.get(n);r&&(ne("ComponentProvider","Removing Datastore"),j1.delete(n),r.terminate())}(this),Promise.resolve()}}function G1(t,e,n,r={}){var i;const s=(t=nt(t,Sf))._getSettings(),o=`${e}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Qr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if("string"==typeof r.mockUserToken)a=r.mockUserToken,u=Yn.MOCK_USER;else{a=(0,Dt.Sg)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new J(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Yn(l)}t._authCredentials=new uW(new JN(a,u))}}class lr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lr(this.firestore,e,this._query)}}class Qt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qt(this.firestore,e,this._key)}}class Cs extends lr{constructor(e,n,r){super(e,n,ol(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qt(this.firestore,null,new ae(e))}withConverter(e){return new Cs(this.firestore,e,this._path)}}function Z1(t,e,...n){if(t=(0,Dt.m9)(t),uD("collection","path",e),t instanceof Sf){const r=lt.fromString(e,...n);return z1(r),new Cs(t,null,r)}{if(!(t instanceof Qt||t instanceof Cs))throw new J(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(lt.fromString(e,...n));return z1(r),new Cs(t.firestore,null,r)}}function v_(t,e,...n){if(t=(0,Dt.m9)(t),1===arguments.length&&(e=ex.newId()),uD("doc","path",e),t instanceof Sf){const r=lt.fromString(e,...n);return H1(r),new Qt(t,null,new ae(r))}{if(!(t instanceof Qt||t instanceof Cs))throw new J(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(lt.fromString(e,...n));return H1(r),new Qt(t.firestore,t instanceof Cs?t.converter:null,new ae(r))}}function K1(t,e){return t=(0,Dt.m9)(t),e=(0,Dt.m9)(e),(t instanceof Qt||t instanceof Cs)&&(e instanceof Qt||e instanceof Cs)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function cD(t,e){return t=(0,Dt.m9)(t),e=(0,Dt.m9)(e),t instanceof lr&&e instanceof lr&&t.firestore===e.firestore&&rf(t._query,e._query)&&t.converter===e.converter}class d3{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new nT(this,"async_queue_retry"),this.iu=()=>{const n=h_();n&&ne("AsyncQueue","Visibility state changed to "+n.visibilityState),this.zo.Qo()};const e=h_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const n=h_();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise(()=>{});const n=new Bn;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ya.push(e),this._u()))}_u(){var e=this;return(0,W.Z)(function*(){if(0!==e.Ya.length){try{yield e.Ya[0](),e.Ya.shift(),e.zo.reset()}catch(n){if(!Ko(n))throw n;ne("AsyncQueue","Operation failed with retryable error: "+n)}e.Ya.length>0&&e.zo.ko(()=>e._u())}})()}ou(e){const n=this.Ja.then(()=>(this.tu=!0,e().catch(r=>{throw this.eu=r,this.tu=!1,Dn("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.tu=!1,r))));return this.Ja=n,n}enqueueAfterDelay(e,n,r){this.su(),this.ru.indexOf(e)>-1&&(n=0);const i=ET.createAndSchedule(this,e,n,r,s=>this.au(s));return this.Xa.push(i),i}su(){this.eu&&ge()}verifyOperationInProgress(){}uu(){var e=this;return(0,W.Z)(function*(){let n;do{n=e.Ja,yield n}while(n!==e.Ja)})()}cu(e){for(const n of this.Xa)if(n.timerId===e)return!0;return!1}lu(e){return this.uu().then(()=>{this.Xa.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Xa)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.uu()})}hu(e){this.ru.push(e)}au(e){const n=this.Xa.indexOf(e);this.Xa.splice(n,1)}}function lD(t){return function(n,r){if("object"!=typeof n||null===n)return!1;const i=n;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(t)}class h3{constructor(){this._progressObserver={},this._taskCompletionResolver=new Bn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Ut extends Sf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new d3,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Q1(this),this._firestoreClient.terminate()}}function p3(t,e){const n="object"==typeof t?t:(0,Un.getApp)(),r="string"==typeof t?t:e||"(default)",i=(0,Un._getProvider)(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=(0,Dt.P0)("firestore");s&&G1(i,...s)}return i}function _n(t){return t._firestoreClient||Q1(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Q1(t){var e,n,r;const i=t._freezeSettings(),s=(u=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new jW(t._databaseId,u,t._persistenceKey,(h=i).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,B1(h.experimentalLongPollingOptions),h.useFetchStreams));var u,h;t._firestoreClient=new X6(t._authCredentials,t._appCheckCredentials,t._queue,s),null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Y1(t,e,n){const r=new Bn;return t.asyncQueue.enqueue((0,W.Z)(function*(){try{yield m_(t,n),yield tD(t,e),r.resolve()}catch(i){const s=i;if(!O1(s))throw s;Qr("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function J1(t){if(t._initialized||t._terminated)throw new J(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Ss{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ss(jn.fromBase64String(e))}catch(n){throw new J(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ss(jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class fo{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new J(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cu{constructor(e){this._methodName=e}}class I_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Fe(this._lat,e._lat)||Fe(this._long,e._long)}}const D3=/^__.*__$/;class A3{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return null!==this.fieldMask?new co(e,this.data,this.fieldMask,n,this.fieldTransforms):new dl(e,this.data,n,this.fieldTransforms)}}class X1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new co(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function eO(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ge()}}class E_{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.Pu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new E_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Au(e),i}Ru(e){var n;const r=null===(n=this.path)||void 0===n?void 0:n.child(e),i=this.Tu({path:r,du:!1});return i.Pu(),i}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return D_(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find(n=>e.isPrefixOf(n))||void 0!==this.fieldTransforms.find(n=>e.isPrefixOf(n.field))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(eO(this.Iu)&&D3.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class C3{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Tf(e)}pu(e,n,r,i=!1){return new E_({Iu:e,methodName:n,gu:r,path:Zt.emptyPath(),du:!1,fu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lu(t){const e=t._freezeSettings(),n=Tf(t._databaseId);return new C3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function w_(t,e,n,r,i,s={}){const o=t.pu(s.merge||s.mergeFields?2:0,e,n,i);pD("Data must be an object, but it was:",o,r);const a=rO(r,o);let u,l;if(s.merge)u=new Yr(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const g of s.mergeFields){const m=Pf(e,g,n);if(!o.contains(m))throw new J(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);sO(h,m)||h.push(m)}u=new Yr(h),l=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,l=o.fieldTransforms;return new A3(new cr(a),u,l)}class Rf extends cu{_toFieldTransform(e){if(2!==e.Iu)throw e.mu(1===e.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rf}}function tO(t,e,n){return new E_({Iu:3,gu:e.settings.gu,methodName:t._methodName,du:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class dD extends cu{_toFieldTransform(e){return new uf(e.path,new cl)}isEqual(e){return e instanceof dD}}class S3 extends cu{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=tO(this,e,!0),r=this.yu.map(s=>du(s,n)),i=new eu(r);return new uf(e.path,i)}isEqual(e){return this===e}}class b3 extends cu{constructor(e,n){super(e),this.yu=n}_toFieldTransform(e){const n=tO(this,e,!0),r=this.yu.map(s=>du(s,n)),i=new tu(r);return new uf(e.path,i)}isEqual(e){return this===e}}class R3 extends cu{constructor(e,n){super(e),this.wu=n}_toFieldTransform(e){const n=new ll(e.serializer,Gx(e.serializer,this.wu));return new uf(e.path,n)}isEqual(e){return this===e}}function hD(t,e,n,r){const i=t.pu(1,e,n);pD("Data must be an object, but it was:",i,r);const s=[],o=cr.empty();Qo(r,(u,l)=>{const h=T_(e,u,n);l=(0,Dt.m9)(l);const g=i.Ru(h);if(l instanceof Rf)s.push(h);else{const m=du(l,g);null!=m&&(s.push(h),o.set(h,m))}});const a=new Yr(s);return new X1(o,a,i.fieldTransforms)}function fD(t,e,n,r,i,s){const o=t.pu(1,e,n),a=[Pf(e,r,n)],u=[i];if(s.length%2!=0)throw new J(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(Pf(e,s[m])),u.push(s[m+1]);const l=[],h=cr.empty();for(let m=a.length-1;m>=0;--m)if(!sO(l,a[m])){const y=a[m];let D=u[m];D=(0,Dt.m9)(D);const C=o.Ru(y);if(D instanceof Rf)l.push(y);else{const b=du(D,C);null!=b&&(l.push(y),h.set(y,b))}}const g=new Yr(l);return new X1(h,g,o.fieldTransforms)}function nO(t,e,n,r=!1){return du(n,t.pu(r?4:3,e))}function du(t,e){if(iO(t=(0,Dt.m9)(t)))return pD("Unsupported field value:",e,t),rO(t,e);if(t instanceof cu)return function(r,i){if(!eO(i.Iu))throw i.mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.du&&4!==e.Iu)throw e.mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let u=du(a,i.Vu(o));null==u&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if(null===(r=(0,Dt.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return Gx(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Jt.fromDate(r);return{timestampValue:fl(i.serializer,s)}}if(r instanceof Jt){const s=new Jt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fl(i.serializer,s)}}if(r instanceof I_)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ss)return{bytesValue:pM(i.serializer,r._byteString)};if(r instanceof Qt){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Pw(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.mu(`Unsupported field value: ${y_(r)}`)}(t,e)}function rO(t,e){const n={};return gx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qo(t,(r,i)=>{const s=du(i,e.Eu(r));null!=s&&(n[r]=s)}),{mapValue:{fields:n}}}function iO(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Jt||t instanceof I_||t instanceof Ss||t instanceof Qt||t instanceof cu)}function pD(t,e,n){if(!iO(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=y_(n);throw e.mu("an object"===r?t+" a custom object":t+" "+r)}var i}function Pf(t,e,n){if((e=(0,Dt.m9)(e))instanceof fo)return e._internalPath;if("string"==typeof e)return T_(t,e);throw D_("Field path arguments must be of type string or ",t,!1,void 0,n)}const P3=new RegExp("[~\\*/\\[\\]]");function T_(t,e,n){if(e.search(P3)>=0)throw D_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fo(...e.split("."))._internalPath}catch{throw D_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function D_(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new J(B.INVALID_ARGUMENT,a+t+u)}function sO(t,e){return t.some(n=>n.isEqual(e))}class Nf{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Qt(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new N3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(A_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class N3 extends Nf{data(){return super.data()}}function A_(t,e){return"string"==typeof e?T_(t,e):e instanceof fo?e._internalPath:e._delegate._internalPath}function oO(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new J(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gD{}class xf extends gD{}function ca(t,e,...n){let r=[];e instanceof gD&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof Nl).length,a=s.filter(u=>u instanceof Mf).length;if(o>1||o>0&&a>0)throw new J(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Mf extends xf{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Mf(e,n,r)}_apply(e){const n=this._parse(e);return lO(e._query,n),new lr(e.firestore,e.converter,ww(e._query,n))}_parse(e){const n=lu(e.firestore);return function(s,o,a,u,l,h,g){let m;if(l.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new J(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){cO(g,h);const y=[];for(const D of g)y.push(uO(u,s,D));m={arrayValue:{values:y}}}else m=uO(u,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||cO(g,h),m=nO(a,"where",g,"in"===h||"not-in"===h);return at.create(l,h,m)}(e._query,0,n,e.firestore._databaseId,this._field,this._op,this._value)}}class Nl extends gD{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Nl(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===n.length?n[0]:Ct.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return 0===n.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const u of a)lO(o,u),o=ww(o,u)}(e._query,n),new lr(e.firestore,e.converter,ww(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class mD extends xf{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new mD(e,n)}_apply(e){const n=function(i,s,o){if(null!==i.startAt)throw new J(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new J(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tf(s,o)}(e._query,this._field,this._direction);return new lr(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new ao(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}class C_ extends xf{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new C_(e,n,r)}_apply(e){return new lr(e.firestore,e.converter,Wm(e._query,this._limit,this._limitType))}}class S_ extends xf{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new S_(e,n,r)}_apply(e){const n=aO(e,this.type,this._docOrFields,this._inclusive);return new lr(e.firestore,e.converter,(s=n,new ao((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class b_ extends xf{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new b_(e,n,r)}_apply(e){const n=aO(e,this.type,this._docOrFields,this._inclusive);return new lr(e.firestore,e.converter,(s=n,new ao((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function aO(t,e,n,r){if(n[0]=(0,Dt.m9)(n[0]),n[0]instanceof Nf)return function(s,o,a,u,l){if(!u)throw new J(B.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const g of al(s))if(g.field.isKeyField())h.push(Ja(o,u.key));else{const m=u.data.field(g.field);if(Um(m))throw new J(B.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===m){const y=g.field.canonicalString();throw new J(B.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(m)}return new na(h,l)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=lu(t.firestore);return function(o,a,u,l,h,g){const m=o.explicitOrderBy;if(h.length>m.length)throw new J(B.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const y=[];for(let D=0;D<h.length;D++){const C=h[D];if(m[D].field.isKeyField()){if("string"!=typeof C)throw new J(B.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof C}`);if(!Ew(o)&&-1!==C.indexOf("/"))throw new J(B.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${C}' contains a slash.`);const b=o.path.child(lt.fromString(C));if(!ae.isDocumentKey(b))throw new J(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${b}' is not because it contains an odd number of segments.`);const F=new ae(b);y.push(Ja(a,F))}else{const b=nO(u,l,C);y.push(b)}}return new na(y,g)}(t._query,t.firestore._databaseId,i,e,n,r)}}function uO(t,e,n){if("string"==typeof(n=(0,Dt.m9)(n))){if(""===n)throw new J(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ew(e)&&-1!==n.indexOf("/"))throw new J(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(lt.fromString(n));if(!ae.isDocumentKey(r))throw new J(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ja(t,new ae(r))}if(n instanceof Qt)return Ja(t,n._key);throw new J(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${y_(n)}.`)}function cO(t,e){if(!Array.isArray(t)||0===t.length)throw new J(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lO(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw new J(B.INVALID_ARGUMENT,n===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class _D{convertValue(e,n="none"){switch(ea(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(oo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw ge()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Qo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new I_(mn(e.latitude),mn(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Bm(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Yh(e));default:return null}}convertTimestamp(e){const n=Yo(e);return new Jt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=lt.fromString(e);we(DM(r));const i=new Jo(r.get(1),r.get(3)),s=new ae(r.popFirst(5));return i.isEqual(n)||Dn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}function R_(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class B3 extends _D{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ss(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,n)}}class hu{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class po extends Nf{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Of(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(A_("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Of extends po{data(e={}){return super.data(e)}}class la{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new hu(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Of(this._firestore,this._userDataWriter,r.key,r,new hu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new Of(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hu(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const u=new Of(i._firestore,i._userDataWriter,a.doc.key,a.doc,new hu(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,h=-1;return 0!==a.type&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:$3(a.type),doc:u,oldIndex:l,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function $3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ge()}}function hO(t,e){return t instanceof po&&e instanceof po?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof la&&e instanceof la&&t._firestore===e._firestore&&cD(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}class da extends _D{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ss(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qt(this.firestore,null,n)}}function fO(t,e,n){t=nt(t,Qt);const r=nt(t.firestore,Ut),i=R_(t.converter,e,n);return xl(r,[w_(lu(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Xt.none())])}function pO(t,e,n,...r){t=nt(t,Qt);const i=nt(t.firestore,Ut),s=lu(i);let o;return o="string"==typeof(e=(0,Dt.m9)(e))||e instanceof fo?fD(s,"updateDoc",t._key,e,n,r):hD(s,"updateDoc",t._key,e),xl(i,[o.toMutation(t._key,Xt.exists(!0))])}function gO(t,...e){var n,r,i;t=(0,Dt.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||lD(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(lD(e[o])){const g=e[o];e[o]=null===(n=g.next)||void 0===n?void 0:n.bind(g),e[o+1]=null===(r=g.error)||void 0===r?void 0:r.bind(g),e[o+2]=null===(i=g.complete)||void 0===i?void 0:i.bind(g)}let u,l,h;if(t instanceof Qt)l=nt(t.firestore,Ut),h=ol(t._key.path),u={next:g=>{e[o]&&e[o](yD(l,t,g))},error:e[o+1],complete:e[o+2]};else{const g=nt(t,lr);l=nt(g.firestore,Ut),h=g._query;const m=new da(l);u={next:y=>{e[o]&&e[o](new la(l,m,g,y))},error:e[o+1],complete:e[o+2]},oO(t._query)}return function(m,y,D,C){const b=new g_(C),F=new ST(y,b,D);return m.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return wT(yield Pl(m),F)})),()=>{b.Na(),m.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return DT(yield Pl(m),F)}))}}(_n(l),h,a,u)}function xl(t,e){return function(r,i){const s=new Bn;return r.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return function M6(t,e,n){return xT.apply(this,arguments)}(yield oD(r),i,s)})),s.promise}(_n(t),e)}function yD(t,e,n){const r=n.docs.get(e._key),i=new da(t);return new po(t,i,e._key,r,new hu(n.hasPendingWrites,n.fromCache),e.converter)}const oG={maxAttempts:5};class mO{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=lu(e)}set(e,n,r){this._verifyNotCommitted();const i=ha(e,this._firestore),s=R_(i.converter,n,r),o=w_(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Xt.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=ha(e,this._firestore);let o;return o="string"==typeof(n=(0,Dt.m9)(n))||n instanceof fo?fD(this._dataReader,"WriteBatch.update",s._key,n,r,i):hD(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,Xt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ha(e,this._firestore);return this._mutations=this._mutations.concat(new hl(n._key,Xt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new J(B.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ha(t,e){if((t=(0,Dt.m9)(t)).firestore!==e)throw new J(B.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}class aG extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=lu(n)}get(n){const r=ha(n,this._firestore),i=new B3(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return ge();const o=s[0];if(o.isFoundDocument())return new Nf(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Nf(this._firestore,i,r._key,null,r.converter);throw ge()})}set(n,r,i){const s=ha(n,this._firestore),o=R_(s.converter,r,i),a=w_(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){const o=ha(n,this._firestore);let a;return a="string"==typeof(r=(0,Dt.m9)(r))||r instanceof fo?fD(this._dataReader,"Transaction.update",o._key,r,i,s):hD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){const r=ha(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=ha(e,this._firestore),r=new da(this._firestore);return super.get(e).then(i=>new po(this._firestore,r,n._key,i._document,new hu(!1,!1),n.converter))}}!function(e,n=!0){Jc=Un.SDK_VERSION,(0,Un._registerComponent)(new yE.wA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Ut(new cW(r.getProvider("auth-internal")),new hW(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new J(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jo(l.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,Un.registerVersion)(YN,"4.3.2",e),(0,Un.registerVersion)(YN,"4.3.2","esm2017")}();class kf{constructor(e){return e}}const IO="firestore",ID=new ye("angularfire2.firestore-instances");function _G(t){return(e,n)=>{const r=e.runOutsideAngular(()=>t(n));return new kf(r)}}const yG={provide:class gG{constructor(){return am(IO)}},deps:[[new Wr,ID]]},vG={provide:kf,useFactory:function mG(t,e){const n=function gE(t,e,n){if(e){if(1===e.length)return e[0];const s=e.filter(o=>o.app===n);if(1===s.length)return s[0]}return n.container.getProvider(t).getImmediate({optional:!0})}(IO,t,e);return n&&new kf(n)},deps:[[new Wr,ID],zc]};let IG=(()=>{class t{constructor(){(0,Un.registerVersion)("angularfire",pE.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ui({type:t});static \u0275inj=Ms({providers:[vG,yG]})}return t})();const wG=NP(p3,!0),EO="firebasestorage.googleapis.com";class cn extends Dt.ZR{constructor(e,n,r=0){super(ED(e),`Firebase Storage: ${n} (${ED(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,cn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ED(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var en=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(en||{});function ED(t){return"storage/"+t}function TD(t){return new cn(en.INVALID_ARGUMENT,t)}function CO(){return new cn(en.APP_DELETED,"The Firebase app was deleted.")}class Ur{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Ur.makeFromUrl(e,n)}catch{return new Ur(e,"")}if(""===r.path)return r;throw function xG(t){return new cn(en.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)",a=new RegExp("^gs://"+i+"(/(.*))?$","i");function l(Z){Z.path_=decodeURIComponent(Z.path)}const g=n.replace(/[.]/g,"\\."),V=[{regex:a,indices:{bucket:1,path:3},postModify:function s(Z){"/"===Z.path.charAt(Z.path.length-1)&&(Z.path_=Z.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${g}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:l},{regex:new RegExp(`^https?://${n===EO?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:l}];for(let Z=0;Z<V.length;Z++){const se=V[Z],be=se.regex.exec(e);if(be){let ln=be[se.indices.path];ln||(ln=""),r=new Ur(be[se.indices.bucket],ln),se.postModify(r);break}}if(null==r)throw function NG(t){return new cn(en.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return r}}class VG{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function AD(t,e,n,r){if(r<e)throw TD(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw TD(`Invalid value for '${t}'. Expected ${n} or less.`)}var Ml=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Ml||{});class zG{constructor(e,n,r,i,s,o,a,u,l,h,g,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=u,this.timeout_=l,this.progressCallback_=h,this.connectionFactory_=g,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,D)=>{this.resolve_=y,this.reject_=D,this.start_()})}start_(){const n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const u=this.callback_(a,a.getResponse());!function jG(t){return void 0!==t}(u)?s():s(u)}catch(u){o(u)}else if(null!==a){const u=function wD(){return new cn(en.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}();u.serverResponse=a.getErrorText(),o(this.errorCallback_?this.errorCallback_(a,u):u)}else o(i.canceled?this.appDelete_?CO():function DO(){return new cn(en.CANCELED,"User canceled the upload/download.")}():function TO(){return new cn(en.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?n(0,new x_(!1,null,!0)):this.backoffId_=function UG(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function u(){return 2===a}let l=!1;function h(...b){l||(l=!0,e.apply(null,b))}function g(b){i=setTimeout(()=>{i=null,t(y,u())},b)}function m(){s&&clearTimeout(s)}function y(b,...F){if(l)return void m();if(b)return m(),void h.call(null,b,...F);if(u()||o)return m(),void h.call(null,b,...F);let V;r<64&&(r*=2),1===a?(a=2,V=0):V=1e3*(r+Math.random()),g(V)}let D=!1;function C(b){D||(D=!0,m(),!l&&(null!==i?(b||(a=2),clearTimeout(i),g(0)):b||(a=1)))}return g(0),s=setTimeout(()=>{o=!0,C(!0)},n),C}((r,i)=>{if(i)return void r(!1,new x_(!1,null,!0));const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{null!==this.progressCallback_&&this.progressCallback_(a.loaded,a.lengthComputable?a.total:-1)};null!==this.progressCallback_&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Ml.NO_ERROR,u=s.getStatus();if(!a||function RO(t,e){const n=t>=500&&t<600,i=-1!==[408,429].indexOf(t),s=-1!==e.indexOf(t);return n||i||s}(u,this.additionalRetryCodes_)&&this.retry){const h=s.getErrorCode()===Ml.ABORT;return void r(!1,new x_(!1,null,h))}const l=-1!==this.successCodes_.indexOf(u);r(!0,new x_(l,s))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function BG(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class x_{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}class fu{constructor(e,n){this._service=e,this._location=n instanceof Ur?n:Ur.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new fu(e,n)}get root(){const e=new Ur(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function OO(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}(this._location.path)}get storage(){return this._service}get parent(){const e=function i5(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;const n=new Ur(this._location.bucket,e);return new fu(this._service,n)}_throwIfRoot(e){if(""===this._location.path)throw function LG(t){return new cn(en.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function KO(t,e){const n=e?.storageBucket;return null==n?null:Ur.makeFromBucketSpec(n,t)}class xD{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=EO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?Ur.makeFromBucketSpec(i,this._host):KO(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Ur.makeFromBucketSpec(this._url,e):KO(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,W.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const n=e._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,W.Z)(function*(){const n=e._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fu(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new VG(CO());{const o=function KG(t,e,n,r,i,s,o=!0){const a=function bO(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}(t.urlParams),u=t.url+a,l=Object.assign({},t.headers);return function GG(t,e){e&&(t["X-Firebase-GMPID"]=e)}(l,e),function qG(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(l,n),function WG(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(l,s),function ZG(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(l,r),new zG(u,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){var r=this;return(0,W.Z)(function*(){const[i,s]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,n,i,s).getPromise()})()}}const QO="@firebase/storage";function z5(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new xD(n,r,i,e,Un.SDK_VERSION)}!function q5(){(0,Un._registerComponent)(new yE.wA("storage",z5,"PUBLIC").setMultipleInstances(!0)),(0,Un.registerVersion)(QO,"0.11.2",""),(0,Un.registerVersion)(QO,"0.11.2","esm2017")}();class F_{constructor(e){return e}}var L_=Se(106);L_.Z.registerVersion("firebase","10.6.0","app-compat");const J5=["ngOnDestroy"];class ek{constructor(e){return e}}const OD=new ye("angularfire2.app.options"),kD=new ye("angularfire2.app.name");function FD(t,e,n){const i="object"==typeof n&&n||{};i.name=i.name||"string"==typeof n&&n||"[DEFAULT]";const o=L_.Z.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>L_.Z.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){const a=!!module.hot;t8("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new ek(o)}const t8=(t,...e)=>{};function tk(t,e,n,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return function n8(t,e){try{return t.toString()===e.toString()}catch{return t===e}}(i,o)||(nk("error",`${e} was already initialized on the ${n} Firebase App with different settings.${r8?" You may need to reload as Firebase is not HMR aware.":""}`),nk("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}const r8=typeof module<"u"&&!!module.hot,nk=(t,...e)=>{};globalThis.\u0275AngularfireInstanceCache||=[],Se(365);class i8 extends q{constructor(e=1/0,n=1/0,r=fE){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=n.now();let a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}}function rk(t,e,n){let r,i=!1;return t&&"object"==typeof t?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t):r=t??1/0,H({connector:()=>new i8(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}const ik=z(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function V_(t,e){return Y((n,r)=>{let i=0;n.subscribe(de(r,s=>t.call(e,s,i++)&&r.next(s)))})}function a8(t=u8){return Y((e,n)=>{let r=!1;e.subscribe(de(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function u8(){return new ik}function sk(t,e){return T(e)?Ae(()=>t,e):Ae(()=>t)}const ok=new ye("angularfire2.auth.use-emulator"),ak=new ye("angularfire2.auth.settings"),uk=new ye("angularfire2.auth.tenant-id"),ck=new ye("angularfire2.auth.langugage-code"),lk=new ye("angularfire2.auth.use-device-language"),dk=new ye("angularfire.auth.persistence"),hk=(t,e,n,r,i,s,o,a)=>tk(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{const u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(const[l,h]of Object.entries(o))u.settings[l]=h;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]);let fk=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,l,h,g,m,y){const D=new q,C=M(void 0).pipe(hn(o.outsideAngular),Ae(()=>s.runOutsideAngular(()=>Promise.resolve().then(Se.bind(Se,365)))),Ve(()=>FD(n,s,r)),Ve(b=>hk(b,s,a,l,h,g,u,m)),rk({bufferSize:1,refCount:!1}));if(nm(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=M(null);else{C.pipe(function c8(t,e){const n=arguments.length>=2;return r=>r.pipe(t?V_((i,s)=>t(i,s,r)):Sn,function s8(t){return t<=0?()=>fr:Y((e,n)=>{let r=0;e.subscribe(de(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}(1),n?function o8(t){return Y((e,n)=>{let r=!1;e.subscribe(de(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}(e):a8(()=>new ik))}()).subscribe();const b=C.pipe(Ae(V=>V.getRedirectResult().then(Z=>Z,()=>null)),ci,rk({bufferSize:1,refCount:!1})),F=C.pipe(Ae(V=>new tt(Z=>({unsubscribe:s.runOutsideAngular(()=>V.onAuthStateChanged(se=>Z.next(se),se=>Z.error(se),()=>Z.complete()))})))),N=C.pipe(Ae(V=>new tt(Z=>({unsubscribe:s.runOutsideAngular(()=>V.onIdTokenChanged(se=>Z.next(se),se=>Z.error(se),()=>Z.complete()))}))));this.authState=b.pipe(sk(F),Hn(o.outsideAngular),hn(o.insideAngular)),this.user=b.pipe(sk(N),Hn(o.outsideAngular),hn(o.insideAngular)),this.idToken=this.user.pipe(Ae(V=>V?E(V.getIdToken()):M(null))),this.idTokenResult=this.user.pipe(Ae(V=>V?E(V.getIdTokenResult()):M(null))),this.credential=w(b,D,this.authState.pipe(V_(V=>!V))).pipe(Ve(V=>V?.user?V:null),Hn(o.outsideAngular),hn(o.insideAngular))}return((t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(J5.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const u=a?.[s];return"function"==typeof u?u.bind(a):u?.then?u.then(l=>n.run(()=>l)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,l)=>o.then(h=>{const g=h?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,g),g})})})}))(this,C,s,{spy:{apply:(b,F,N)=>{(b.startsWith("signIn")||b.startsWith("createUser"))&&N.then(V=>D.next(V))}}})}static \u0275fac=function(r){return new(r||t)(pe(OD),pe(kD,8),pe(Ks),pe(Rt),pe(um),pe(ok,8),pe(ak,8),pe(uk,8),pe(ck,8),pe(lk,8),pe(dk,8),pe(mE,8))};static \u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();function pk(...t){return function d8(){return Fi(1)}()(E(t,Ii(t)))}function LD(...t){const e=Ii(t);return Y((n,r)=>{(e?pk(t,n,e):pk(t,n)).subscribe(r)})}function VD(){return Y((t,e)=>{let n,r=!1;t.subscribe(de(e,i=>{const s=n;n=i,r&&e.next([s,i]),r=!0}))})}function UD(t,e){return Y(function h8(t,e,n,r,i){return(s,o)=>{let a=n,u=e,l=0;s.subscribe(de(o,h=>{const g=l++;u=a?t(u,h,g):(a=!0,h),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}(t,e,arguments.length>=2,!0))}function BD(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new J("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function gk(){if(typeof Uint8Array>"u")throw new J("unimplemented","Uint8Arrays are not available in this environment.")}function mk(){if(!function UW(){return typeof atob<"u"}())throw new J("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Bf{constructor(e){this._delegate=e}static fromBase64String(e){return mk(),new Bf(Ss.fromBase64String(e))}static fromUint8Array(e){return gk(),new Bf(Ss.fromUint8Array(e))}toBase64(){return mk(),this._delegate.toBase64()}toUint8Array(){return gk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function jD(t){return function g8(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class m8{enableIndexedDbPersistence(e,n){return function g3(t,e){J1(t=nt(t,Ut));const n=_n(t);if(n._uninitializedComponentsProvider)throw new J(B.FAILED_PRECONDITION,"SDK cache is already specified.");Qr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),i=new bl;return Y1(n,i,new XT(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return function m3(t){J1(t=nt(t,Ut));const e=_n(t);if(e._uninitializedComponentsProvider)throw new J(B.FAILED_PRECONDITION,"SDK cache is already specified.");Qr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new bl;return Y1(e,r,new x1(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function _3(t){if(t._initialized&&!t._terminated)throw new J(B.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Bn;return t._queue.enqueueAndForgetEvenWhileRestricted((0,W.Z)(function*(){try{yield(n=(0,W.Z)(function*(i){if(!Qi.D())return Promise.resolve();const s=i+"main";yield Qi.delete(s)}),function r(i){return n.apply(this,arguments)})(qw(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}var n})),e.promise}(e._delegate)}}class _k{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Jo||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Qr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)}useEmulator(e,n,r={}){G1(this._delegate,e,n,r)}enableNetwork(){return function v3(t){return function e3(t){return t.asyncQueue.enqueue((0,W.Z)(function*(){const e=yield k1(t),n=yield F1(t);return e.setNetworkEnabled(!0),function(i){const s=oe(i);return s.C_.delete(0),Df(s)}(n)}))}(_n(t=nt(t,Ut)))}(this._delegate)}disableNetwork(){return function I3(t){return function t3(t){return t.asyncQueue.enqueue((0,W.Z)(function*(){const e=yield k1(t),n=yield F1(t);return e.setNetworkEnabled(!1),(r=(0,W.Z)(function*(s){const o=oe(s);o.C_.add(0),yield El(o),o.M_.set("Offline")}),function i(s){return r.apply(this,arguments)})(n);var r}))}(_n(t=nt(t,Ut)))}(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,$1("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function y3(t){return function(n){const r=new Bn;return n.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return function L6(t,e){return LT.apply(this,arguments)}(yield oD(n),r)})),r.promise}(_n(t=nt(t,Ut)))}(this._delegate)}onSnapshotsInSync(e){return function Y3(t,e){return function i3(t,e){const n=new g_(e);return t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return i=yield Pl(t),s=n,oe(i).q_.add(s),void s.next();var i,s})),()=>{n.Na(),t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return i=yield Pl(t),s=n,void oe(i).q_.delete(s);var i,s}))}}(_n(t=nt(t,Ut)),lD(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new J("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Fl(this,Z1(this._delegate,e))}catch(n){throw jr(n,"collection()","Firestore.collection()")}}doc(e){try{return new ki(this,v_(this._delegate,e))}catch(n){throw jr(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new $r(this,function l3(t,e){if(t=nt(t,Sf),uD("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new J(B.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new lr(t,null,(r=e,new ao(lt.emptyPath(),r)));var r}(this._delegate,e))}catch(n){throw jr(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function uG(t,e,n){t=nt(t,Ut);const r=Object.assign(Object.assign({},oG),n);return function(s){if(s.maxAttempts<1)throw new J(B.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const u=new Bn;return s.asyncQueue.enqueueAndForget((0,W.Z)(function*(){const l=yield function L1(t){return __(t).then(e=>e.datastore)}(s);new J6(s.asyncQueue,l,a,o,u).run()})),u.promise}(_n(t),i=>e(new aG(t,i)),r)}(this._delegate,n=>e(new yk(this,n)))}batch(){return _n(this._delegate),new vk(new mO(this._delegate,e=>xl(this._delegate,e)))}loadBundle(e){return function E3(t,e){const n=_n(t=nt(t,Ut)),r=new h3;return function s3(t,e,n,r){const i=function(o,a){let u;return u="string"==typeof o?oM().encode(o):o,h=function(h,g){if(h instanceof Uint8Array)return M1(h,g);if(h instanceof ArrayBuffer)return M1(new Uint8Array(h),g);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new Q6(h,a);var h}(n,Tf(e));t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){!function Z6(t,e,n){const r=oe(t);var i;(i=(0,W.Z)(function*(o,a,u){try{const l=yield a.getMetadata();if(yield function(D,C){const b=oe(D),F=An(C.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",N=>b.Kr.getBundleMetadata(N,C.id)).then(N=>!!N&&N.createTime.compareTo(F)>=0)}(o.localStore,l))return yield a.close(),u._completeWith({taskState:"Success",documentsLoaded:(D=l).totalDocuments,bytesLoaded:D.totalBytes,totalDocuments:D.totalDocuments,totalBytes:D.totalBytes}),Promise.resolve(new Set);u._updateProgress(T1(l));const h=new S6(l,o.localStore,a.serializer);let g=yield a.Ma();for(;g;){const y=yield h.ea(g);y&&u._updateProgress(y),g=yield a.Ma()}const m=yield h.complete();return yield ho(o,m.ra,void 0),yield function(D,C){const b=oe(D);return b.persistence.runTransaction("Save bundle","readwrite",F=>b.Kr.saveBundleMetadata(F,C))}(o.localStore,l),u._completeWith(m.progress),Promise.resolve(m.na)}catch(l){return Qr("SyncEngine",`Loading bundle failed with ${l}`),u._failWith(l),Promise.resolve(new Set)}var D}),function s(o,a,u){return i.apply(this,arguments)})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield oD(t),i,r)}))}(n,t._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function w3(t,e){return function o3(t,e){return t.asyncQueue.enqueue((0,W.Z)(function*(){return function(r,i){const s=oe(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Kr.getNamedQuery(o,i))}(yield Rl(t),e)}))}(_n(t=nt(t,Ut)),e).then(n=>n?new lr(t,null,n.query):null)}(this._delegate,e).then(n=>n?new $r(this,n):null)}}class U_ extends _D{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bf(new Ss(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return ki.forKey(n,this.firestore,null)}}class yk{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new U_(e)}get(e){const n=gu(e);return this._delegate.get(n).then(r=>new jf(this._firestore,new po(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const i=gu(e);return r?(BD("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=gu(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=gu(e);return this._delegate.delete(n),this}}class vk{constructor(e){this._delegate=e}set(e,n,r){const i=gu(e);return r?(BD("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){const s=gu(e);return 2===arguments.length?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){const n=gu(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class pu{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new Of(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new $f(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=pu.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new pu(e,new U_(e),n),i.set(n,s)),s}}pu.INSTANCES=new WeakMap;class ki{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new U_(e)}static forPath(e,n,r){if(e.length%2!=0)throw new J("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new ki(n,new Qt(n._delegate,r,new ae(e)))}static forKey(e,n,r){return new ki(n,new Qt(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Fl(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Fl(this.firestore,Z1(this._delegate,e))}catch(n){throw jr(n,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,Dt.m9)(e))instanceof Qt&&K1(this._delegate,e)}set(e,n){n=BD("DocumentReference.set",n);try{return n?fO(this._delegate,e,n):fO(this._delegate,e)}catch(r){throw jr(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return 1===arguments.length?pO(this._delegate,e):pO(this._delegate,e,n,...r)}catch(i){throw jr(i,"updateDoc()","DocumentReference.update()")}}delete(){return function K3(t){return xl(nt(t.firestore,Ut),[new hl(t._key,Xt.none())])}(this._delegate)}onSnapshot(...e){const n=Ik(e),r=Ek(e,i=>new jf(this.firestore,new po(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return gO(this._delegate,n,r)}get(e){let n;return n="cache"===e?.source?function z3(t){t=nt(t,Qt);const e=nt(t.firestore,Ut),n=_n(e),r=new da(e);return function n3(t,e){const n=new Bn;return t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return(r=(0,W.Z)(function*(s,o,a){try{const u=yield function(h,g){const m=oe(h);return m.persistence.runTransaction("read document","readonly",y=>m.localDocuments.getDocument(y,g))}(s,o);u.isFoundDocument()?a.resolve(u):u.isNoDocument()?a.resolve(null):a.reject(new J(B.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){const l=Dl(u,`Failed to get document '${o} from cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Rl(t),e,n);var r})),n.promise}(n,t._key).then(i=>new po(e,r,t._key,i,new hu(null!==i&&i.hasLocalMutations,!0),t.converter))}(this._delegate):"server"===e?.source?function q3(t){t=nt(t,Qt);const e=nt(t.firestore,Ut);return V1(_n(e),t._key,{source:"server"}).then(n=>yD(e,t,n))}(this._delegate):function H3(t){t=nt(t,Qt);const e=nt(t.firestore,Ut);return V1(_n(e),t._key).then(n=>yD(e,t,n))}(this._delegate),n.then(r=>new jf(this.firestore,new po(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new ki(this.firestore,this._delegate.withConverter(e?pu.getInstance(this.firestore,e):null))}}function jr(t,e,n){return t.message=t.message.replace(e,n),t}function Ik(t){for(const e of t)if("object"==typeof e&&!jD(e))return e;return{}}function Ek(t,e){var n,r;let i;return i=jD(t[0])?t[0]:jD(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class jf{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new ki(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return hO(this._delegate,e._delegate)}}class $f extends jf{data(e){const n=this._delegate.data(e);return this._delegate._converter||function oW(t,e){t||ge()}(void 0!==n),n}}class $r{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new U_(e)}where(e,n,r){try{return new $r(this.firestore,ca(this._delegate,function x3(t,e,n){const r=e,i=A_("where",t);return Mf._create(i,r,n)}(e,n,r)))}catch(i){throw jr(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new $r(this.firestore,ca(this._delegate,function M3(t,e="asc"){const n=e,r=A_("orderBy",t);return mD._create(r,n)}(e,n)))}catch(r){throw jr(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new $r(this.firestore,ca(this._delegate,function O3(t){return q1("limit",t),C_._create("limit",t,"F")}(e)))}catch(n){throw jr(n,"limit()","Query.limit()")}}limitToLast(e){try{return new $r(this.firestore,ca(this._delegate,function k3(t){return q1("limitToLast",t),C_._create("limitToLast",t,"L")}(e)))}catch(n){throw jr(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new $r(this.firestore,ca(this._delegate,function F3(...t){return S_._create("startAt",t,!0)}(...e)))}catch(n){throw jr(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new $r(this.firestore,ca(this._delegate,function L3(...t){return S_._create("startAfter",t,!1)}(...e)))}catch(n){throw jr(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new $r(this.firestore,ca(this._delegate,function V3(...t){return b_._create("endBefore",t,!1)}(...e)))}catch(n){throw jr(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new $r(this.firestore,ca(this._delegate,function U3(...t){return b_._create("endAt",t,!0)}(...e)))}catch(n){throw jr(n,"endAt()","Query.endAt()")}}isEqual(e){return cD(this._delegate,e._delegate)}get(e){let n;return n="cache"===e?.source?function G3(t){t=nt(t,lr);const e=nt(t.firestore,Ut),n=_n(e),r=new da(e);return function r3(t,e){const n=new Bn;return t.asyncQueue.enqueueAndForget((0,W.Z)(function*(){return(r=(0,W.Z)(function*(s,o,a){try{const u=yield u_(s,o,!0),l=new C1(o,u.ls),h=l.ca(u.documents),g=l.applyChanges(h,!1);a.resolve(g.snapshot)}catch(u){const l=Dl(u,`Failed to execute query '${o} against cache`);a.reject(l)}}),function i(s,o,a){return r.apply(this,arguments)})(yield Rl(t),e,n);var r})),n.promise}(n,t._query).then(i=>new la(e,r,t,i))}(this._delegate):"server"===e?.source?function Z3(t){t=nt(t,lr);const e=nt(t.firestore,Ut),n=_n(e),r=new da(e);return U1(n,t._query,{source:"server"}).then(i=>new la(e,r,t,i))}(this._delegate):function W3(t){t=nt(t,lr);const e=nt(t.firestore,Ut),n=_n(e),r=new da(e);return oO(t._query),U1(n,t._query).then(i=>new la(e,r,t,i))}(this._delegate),n.then(r=>new $D(this.firestore,new la(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=Ik(e),r=Ek(e,i=>new $D(this.firestore,new la(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return gO(this._delegate,n,r)}withConverter(e){return new $r(this.firestore,this._delegate.withConverter(e?pu.getInstance(this.firestore,e):null))}}class y8{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new $f(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class $D{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new $r(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new $f(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new y8(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new $f(this._firestore,r))})}isEqual(e){return hO(this._delegate,e._delegate)}}class Fl extends $r{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new ki(this.firestore,e):null}doc(e){try{return new ki(this.firestore,void 0===e?v_(this._delegate):v_(this._delegate,e))}catch(n){throw jr(n,"doc()","CollectionReference.doc()")}}add(e){return function Q3(t,e){const n=nt(t.firestore,Ut),r=v_(t),i=R_(t.converter,e);return xl(n,[w_(lu(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Xt.exists(!1))]).then(()=>r)}(this._delegate,e).then(n=>new ki(this.firestore,n))}isEqual(e){return K1(this._delegate,e._delegate)}withConverter(e){return new Fl(this.firestore,this._delegate.withConverter(e?pu.getInstance(this.firestore,e):null))}}function gu(t){return nt(t,Qt)}class HD{constructor(...e){this._delegate=new fo(...e)}static documentId(){return new HD(Zt.keyField().canonicalString())}isEqual(e){return(e=(0,Dt.m9)(e))instanceof fo&&this._delegate._internalPath.isEqual(e._internalPath)}}class mu{constructor(e){this._delegate=e}static serverTimestamp(){const e=function lG(){return new dD("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new mu(e)}static delete(){const e=function cG(){return new Rf("deleteField")}();return e._methodName="FieldValue.delete",new mu(e)}static arrayUnion(...e){const n=function dG(...t){return new S3("arrayUnion",t)}(...e);return n._methodName="FieldValue.arrayUnion",new mu(n)}static arrayRemove(...e){const n=function hG(...t){return new b3("arrayRemove",t)}(...e);return n._methodName="FieldValue.arrayRemove",new mu(n)}static increment(e){const n=function fG(t){return new R3("increment",t)}(e);return n._methodName="FieldValue.increment",new mu(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const v8={Firestore:_k,GeoPoint:I_,Timestamp:Jt,Blob:Bf,Transaction:yk,WriteBatch:vk,DocumentReference:ki,DocumentSnapshot:jf,Query:$r,QueryDocumentSnapshot:$f,QuerySnapshot:$D,CollectionReference:Fl,FieldPath:HD,FieldValue:mu,setLogLevel:function _8(t){!function sW(t){Go.setLogLevel(t)}(t)},CACHE_SIZE_UNLIMITED:-1};function wk(t,e){return function w8(t,e=RP){return new tt(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}(t,e)}function zD(t,e){return wk(t,e).pipe(Ve(n=>({payload:n,type:"query"})))}!function E8(t){(function I8(t,e){t.INTERNAL.registerComponent(new yE.wA("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},v8)))})(t,(e,n)=>new _k(e,n,new m8)),t.registerVersion("@firebase/firestore-compat","0.3.22")}(L_.Z);class Tk{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){const r=this.ref.collection(e),{ref:i,query:s}=Sk(r,n);return new Ck(i,s,this.afs)}snapshotChanges(){return function T8(t,e){return wk(t,e).pipe(LD(void 0),VD(),Ve(n=>{const[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(ci)}valueChanges(e={}){return this.snapshotChanges().pipe(Ve(({payload:n})=>e.idField?{...n.data(),[e.idField]:n.id}:n.data()))}get(e){return E(this.ref.get(e)).pipe(ci)}}function B_(t,e){return zD(t,e).pipe(LD(void 0),VD(),Ve(n=>{const[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{const l=s.find(g=>g.doc.ref.isEqual(a.ref)),h=r?.payload.docs.find(g=>g.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function Dk(t,e,n){return B_(t,n).pipe(UD((r,i)=>function D8(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=function A8(t,e){switch(e.type){case"added":if(!t[e.newIndex]||!t[e.newIndex].doc.ref.isEqual(e.doc.ref))return qD(t,e.newIndex,0,e);break;case"modified":if(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}return qD(t,e.newIndex,1,e)}break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return qD(t,e.oldIndex,1)}return t}(t,r))}),t}(r,i.map(s=>s.payload),e),[]),Pe(),Ve(r=>r.map(i=>({type:i.type,payload:i}))))}function qD(t,e,n,...r){const i=t.slice();return i.splice(e,n,...r),i}function Ak(t){return(!t||0===t.length)&&(t=["added","removed","modified"]),t}class Ck{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=B_(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(Ve(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(LD(void 0),VD(),V_(([r,i])=>i.length>0||!r),Ve(([,r])=>r),ci)}auditTrail(e){return this.stateChanges(e).pipe(UD((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=Ak(e);return Dk(this.query,n,this.afs.schedulers.outsideAngular).pipe(ci)}valueChanges(e={}){return zD(this.query,this.afs.schedulers.outsideAngular).pipe(Ve(n=>n.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),ci)}get(e){return E(this.query.get(e)).pipe(ci)}add(e){return this.ref.add(e)}doc(e){return new Tk(this.ref.doc(e),this.afs)}}class C8{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return e&&0!==e.length?B_(this.query,this.afs.schedulers.outsideAngular).pipe(Ve(n=>n.filter(r=>e.indexOf(r.type)>-1)),V_(n=>n.length>0),ci):B_(this.query,this.afs.schedulers.outsideAngular).pipe(ci)}auditTrail(e){return this.stateChanges(e).pipe(UD((n,r)=>[...n,...r],[]))}snapshotChanges(e){const n=Ak(e);return Dk(this.query,n,this.afs.schedulers.outsideAngular).pipe(ci)}valueChanges(e={}){return zD(this.query,this.afs.schedulers.outsideAngular).pipe(Ve(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),ci)}get(e){return E(this.query.get(e)).pipe(ci)}}const S8=new ye("angularfire2.enableFirestorePersistence"),b8=new ye("angularfire2.firestore.persistenceSettings"),R8=new ye("angularfire2.firestore.settings"),P8=new ye("angularfire2.firestore.use-emulator");function Sk(t,e=(n=>n)){return{query:e(t),ref:t}}let N8=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,l,h,g,m,y,D,C,b,F,N){this.schedulers=u;const V=FD(n,a,r),Z=h;g&&hk(V,a,m,D,C,b,y,F),[this.firestore,this.persistenceEnabled$]=tk(`${V.name}.firestore`,"AngularFirestore",V.name,()=>{const se=a.runOutsideAngular(()=>V.firestore());if(s&&se.settings(s),Z&&se.useEmulator(...Z),i&&!nm(o)){const be=()=>{try{return E(se.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(ht){return typeof console<"u"&&console.warn(ht),M(!1)}};return[se,a.runOutsideAngular(be)]}return[se,M(!1)]},[s,Z,i])}collection(n,r){let i;i="string"==typeof n?this.firestore.collection(n):n;const{ref:s,query:o}=Sk(i,r),a=this.schedulers.ngZone.run(()=>s);return new Ck(a,o,this)}collectionGroup(n,r){const i=r||(o=>o),s=this.firestore.collectionGroup(n);return new C8(i(s),this)}doc(n){let r;r="string"==typeof n?this.firestore.doc(n):n;const i=this.schedulers.ngZone.run(()=>r);return new Tk(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(pe(OD),pe(kD,8),pe(S8,8),pe(R8,8),pe(Ks),pe(Rt),pe(um),pe(b8,8),pe(P8,8),pe(fk,8),pe(ok,8),pe(ak,8),pe(uk,8),pe(ck,8),pe(lk,8),pe(dk,8),pe(mE,8))};static \u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),x8=(()=>{class t{constructor(n){this.firestore=_t(kf),this.storage=_t(F_),this.roomRef=n.collection("rooms")}static#e=this.\u0275fac=function(r){return new(r||t)(pe(N8))};static#t=this.\u0275prov=ft({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const M8=["roomDialog"];let O8=(()=>{class t{constructor(){this.roomDialog=null,this.roomId=null,this.fireStore=_t(kf),this.fireStoreService=_t(x8),this.configuration={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10}}ngAfterViewInit(){}ngOnInit(){var n=this;return(0,W.Z)(function*(){document.querySelector("#cameraBtn")?.addEventListener("click",n.openUserMedia.bind(n)),document.querySelector("#createBtn")?.addEventListener("click",n.createRoom.bind(n)),mdc.ripple.MDCRipple.attachTo(document.querySelector(".mdc-button")),n.roomDialog=new mdc.dialog.MDCDialog(n.roomDialogElement.nativeElement)})()}createRoom(){var n=this;return(0,W.Z)(function*(){document.querySelector("#createBtn")?.setAttribute("disabled","true"),document.querySelector("#joinBtn")?.setAttribute("disabled","true"),n.fireStoreService.roomRef.doc(),console.log("Create PeerConnection with configuration: ",n.configuration),n.peerConnection=new RTCPeerConnection(n.configuration),n.registerPeerConnectionListeners(),n.localStream.getTracks().forEach(o=>{n.peerConnection.addTrack(o,n.localStream)});const r=n.fireStoreService.roomRef.doc().collection("calleeCandidates");n.peerConnection.addEventListener("icecandidate",o=>{o.candidate?(console.log("Got candidate: ",o.candidate),r.add(o.candidate.toJSON())):console.log("Got final candidate!")});const i=yield n.peerConnection.createOffer();yield n.peerConnection.setLocalDescription(i),console.log("Created offer:",i);const s={offer:{type:i.type,sdp:i.sdp}};yield n.fireStoreService.roomRef.doc().set(s)})()}openUserMedia(){return(0,W.Z)(function*(){const n=yield navigator.mediaDevices.getUserMedia({video:!0,audio:!0});document.querySelector("#localVideo").srcObject=n;const r=new MediaStream;document.querySelector("#remoteVideo").srcObject=r,console.log("localStream:",document.querySelector("#localVideo").srcObject),document.querySelector("#cameraBtn")?.setAttribute("disabled","true"),document.querySelector("#joinBtn")?.setAttribute("disabled","false"),document.querySelector("#createBtn")?.setAttribute("disabled","false"),document.querySelector("#hangupBtn")?.setAttribute("disabled","false")})()}registerPeerConnectionListeners(){this.peerConnection.addEventListener("icegatheringstatechange",()=>{console.log(`ICE gathering state changed: ${this.peerConnection.iceGatheringState}`)}),this.peerConnection.addEventListener("connectionstatechange",()=>{console.log(`Connection state change: ${this.peerConnection.connectionState}`)}),this.peerConnection.addEventListener("signalingstatechange",()=>{console.log(`Signaling state change: ${this.peerConnection.signalingState}`)}),this.peerConnection.addEventListener("iceconnectionstatechange ",()=>{console.log(`ICE connection state change: ${this.peerConnection.iceConnectionState}`)})}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=ad({type:t,selectors:[["his-fireVideo"]],viewQuery:function(r,i){if(1&r&&Wb(M8,5),2&r){let s;qb(s=function Gb(){return function Rj(t,e){return t[zr].queries[e].queryList}(Q(),Np())}())&&(i.roomDialogElement=s.first)}},standalone:!0,features:[gI],decls:59,vars:0,consts:[["charset","utf-8"],["name","viewport","content","width=device-width, initial-scale=1"],["href","https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css","rel","stylesheet"],["rel","stylesheet","href","https://fonts.googleapis.com/icon?family=Material+Icons"],["id","buttons"],["id","cameraBtn",1,"mdc-button","mdc-button--raised"],["aria-hidden","true",1,"material-icons","mdc-button__icon"],[1,"mdc-button__label"],["disabled","","id","createBtn",1,"mdc-button","mdc-button--raised"],["disabled","","id","joinBtn",1,"mdc-button","mdc-button--raised"],["disabled","","id","hangupBtn",1,"mdc-button","mdc-button--raised"],["id","currentRoom"],["id","videos"],["id","remoteVideo","autoplay","","playsinline",""],["id","room-dialog","role","alertdialog","aria-modal","true","aria-labelledby","my-dialog-title","aria-describedby","my-dialog-content",1,"mdc-dialog"],[1,"mdc-dialog__container"],[1,"mdc-dialog__surface"],["id","my-dialog-title",1,"mdc-dialog__title"],["id","my-dialog-content",1,"mdc-dialog__content"],[1,"mdc-text-field"],["type","text","id","room-id",1,"mdc-text-field__input"],["for","my-text-field",1,"mdc-floating-label"],[1,"mdc-line-ripple"],[1,"mdc-dialog__actions"],["type","button","data-mdc-dialog-action","no",1,"mdc-button","mdc-dialog__button"],["id","confirmJoinBtn","type","button","data-mdc-dialog-action","yes",1,"mdc-button","mdc-dialog__button"],[1,"mdc-dialog__scrim"],["id","shoot"]],template:function(r,i){1&r&&(an(0,"html")(1,"head"),ps(2,"meta",0)(3,"meta",1),an(4,"title"),sr(5,"Welcome to FirebaseRTC"),un(),ps(6,"link",2)(7,"link",3),un(),an(8,"body")(9,"h1"),sr(10,"Welcome to FirebaseRTC!"),un(),an(11,"div",4)(12,"button",5)(13,"i",6),sr(14,"perm_camera_mic"),un(),an(15,"span",7),sr(16,"Open camera & microphone"),un()(),an(17,"button",8)(18,"i",6),sr(19,"group_add"),un(),an(20,"span",7),sr(21,"Create room"),un()(),an(22,"button",9)(23,"i",6),sr(24,"group"),un(),an(25,"span",7),sr(26,"Join room"),un()(),an(27,"button",10)(28,"i",6),sr(29,"close"),un(),an(30,"span",7),sr(31,"Hangup"),un()()(),an(32,"div"),ps(33,"span",11),un(),an(34,"div",12),ps(35,"video",13),un(),an(36,"div",14)(37,"div",15)(38,"div",16)(39,"h2",17),sr(40,"Join room"),un(),an(41,"div",18),sr(42," Enter ID for room to join: "),an(43,"div",19),ps(44,"input",20),an(45,"label",21),sr(46,"Room ID"),un(),ps(47,"div",22),un()(),an(48,"footer",23)(49,"button",24)(50,"span",7),sr(51,"Cancel"),un()(),an(52,"button",25)(53,"span",7),sr(54,"Join"),un()()()()(),ps(55,"div",26),un(),an(56,"div")(57,"button",27),sr(58,"\u62cd\u7167"),un()()()())},dependencies:[uP],encapsulation:2})}return t})(),k8=(()=>{class t{constructor(){this.title="app-showcase"}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=ad({type:t,selectors:[["app-root"]],standalone:!0,features:[gI],decls:1,vars:0,template:function(r,i){1&r&&ps(0,"his-fireVideo")},dependencies:[uP,O8]})}return t})();const F8_firebase={apiKey:"AIzaSyCjxvMAYfcpGhNYCTLi38MxStkVYRP4Q3c",authDomain:"fir-rtc-a6445.firebaseapp.com",databaseURL:"https://fir-rtc-a6445-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"fir-rtc-a6445",storageBucket:"fir-rtc-a6445.appspot.com",messagingSenderId:"36255377340",appId:"1:36255377340:web:5531c5d2e67b7db1522db9",measurementId:"G-CZ1V93MJHB"};(function _4(t,e){return N$({rootComponent:t,...TP(e)})})(k8,{providers:[uv(function G4(t,...e){return{ngModule:W4,providers:[{provide:_E,useFactory:q4(t),multi:!0,deps:[Rt,Pi,um,...e]}]}}(()=>Z4(F8_firebase))),uv(function EG(t,...e){return{ngModule:IG,providers:[{provide:ID,useFactory:_G(t),multi:!0,deps:[Rt,Pi,um,xP,[new Wr,OP],[new Wr,mE],...e]}]}}(()=>wG()))]}).catch(t=>console.error(t))},106:(fi,yn,Se)=>{Se.d(yn,{Z:()=>vn});var T=Se(58),z=Se(537),x=Se(534),ve=Se(879);class gt{constructor(xe,Me){this._delegate=xe,this.firebase=Me,(0,x._addComponent)(xe,new z.wA("app-compat",()=>this,"PUBLIC")),this.container=xe.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(xe){this._delegate.automaticDataCollectionEnabled=xe}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(xe=>{this._delegate.checkDestroyed(),xe()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,x.deleteApp)(this._delegate)))}_getService(xe,Me=x._DEFAULT_ENTRY_NAME){var Cn;this._delegate.checkDestroyed();const jt=this._delegate.container.getProvider(xe);return!jt.isInitialized()&&"EXPLICIT"===(null===(Cn=jt.getComponent())||void 0===Cn?void 0:Cn.instantiationMode)&&jt.initialize(),jt.getImmediate({identifier:Me})}_removeServiceInstance(xe,Me=x._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(xe).clearInstance(Me)}_addComponent(xe){(0,x._addComponent)(this._delegate,xe)}_addOrOverwriteComponent(xe){(0,x._addOrOverwriteComponent)(this._delegate,xe)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const tn=new T.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),G=function rt(){const Ye=function St(Ye){const xe={},Me={__esModule:!0,initializeApp:function Ge(je,te={}){const et=x.initializeApp(je,te);if((0,T.r3)(xe,et.name))return xe[et.name];const Nt=new Ye(et,Me);return xe[et.name]=Nt,Nt},app:jt,registerVersion:x.registerVersion,setLogLevel:x.setLogLevel,onLog:x.onLog,apps:null,SDK_VERSION:x.SDK_VERSION,INTERNAL:{registerComponent:function wr(je){const te=je.name,et=te.replace("-compat","");if(x._registerComponent(je)&&"PUBLIC"===je.type){const Nt=(Yt=jt())=>{if("function"!=typeof Yt[et])throw tn.create("invalid-app-argument",{appName:te});return Yt[et]()};void 0!==je.serviceProps&&(0,T.ZB)(Nt,je.serviceProps),Me[et]=Nt,Ye.prototype[et]=function(...Yt){return this._getService.bind(this,te).apply(this,je.multipleInstances?Yt:[])}}return"PUBLIC"===je.type?Me[et]:null},removeApp:function Cn(je){delete xe[je]},useAsService:function dn(je,te){return"serverAuth"===te?null:te},modularAPIs:x}};function jt(je){if(!(0,T.r3)(xe,je=je||x._DEFAULT_ENTRY_NAME))throw tn.create("no-app",{appName:je});return xe[je]}return Me.default=Me,Object.defineProperty(Me,"apps",{get:function yt(){return Object.keys(xe).map(je=>xe[je])}}),jt.App=Ye,Me}(gt);return Ye.INTERNAL=Object.assign(Object.assign({},Ye.INTERNAL),{createFirebaseNamespace:rt,extendNamespace:function xe(Me){(0,T.ZB)(Ye,Me)},createSubscribe:T.ne,ErrorFactory:T.LL,deepExtend:T.ZB}),Ye}(),re=new ve.Yd("@firebase/app-compat");if((0,T.jU)()&&void 0!==self.firebase){re.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ye=self.firebase.SDK_VERSION;Ye&&Ye.indexOf("LITE")>=0&&re.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const vn=G;!function ut(Ye){(0,x.registerVersion)("@firebase/app-compat","0.2.23",Ye)}()},534:(fi,yn,Se)=>{Se.r(yn),Se.d(yn,{FirebaseError:()=>ve.ZR,SDK_VERSION:()=>vi,_DEFAULT_ENTRY_NAME:()=>ni,_addComponent:()=>Ar,_addOrOverwriteComponent:()=>Hr,_apps:()=>$n,_clearComponents:()=>fr,_components:()=>Dr,_getProvider:()=>hr,_registerComponent:()=>xn,_removeServiceInstance:()=>Fi,deleteApp:()=>hn,getApp:()=>Ii,getApps:()=>wn,initializeApp:()=>Xi,onLog:()=>yo,registerVersion:()=>Cr,setLogLevel:()=>es});var T=Se(861),z=Se(537),x=Se(879),ve=Se(58);const gt=($,P)=>P.some(ee=>$ instanceof ee);let Bt,tn;const G=new WeakMap,re=new WeakMap,Ie=new WeakMap,Le=new WeakMap,ut=new WeakMap;let xe={get($,P,ee){if($ instanceof IDBTransaction){if("done"===P)return re.get($);if("objectStoreNames"===P)return $.objectStoreNames||Ie.get($);if("store"===P)return ee.objectStoreNames[1]?void 0:ee.objectStore(ee.objectStoreNames[0])}return Ge($[P])},set:($,P,ee)=>($[P]=ee,!0),has:($,P)=>$ instanceof IDBTransaction&&("done"===P||"store"===P)||P in $};function jt($){return"function"==typeof $?function Cn($){return $!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function rt(){return tn||(tn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes($)?function(...P){return $.apply(yt(this),P),Ge(G.get(this))}:function(...P){return Ge($.apply(yt(this),P))}:function(P,...ee){const _e=$.call(yt(this),P,...ee);return Ie.set(_e,P.sort?P.sort():[P]),Ge(_e)}}($):($ instanceof IDBTransaction&&function Ye($){if(re.has($))return;const P=new Promise((ee,_e)=>{const $e=()=>{$.removeEventListener("complete",ze),$.removeEventListener("error",ie),$.removeEventListener("abort",ie)},ze=()=>{ee(),$e()},ie=()=>{_e($.error||new DOMException("AbortError","AbortError")),$e()};$.addEventListener("complete",ze),$.addEventListener("error",ie),$.addEventListener("abort",ie)});re.set($,P)}($),gt($,function St(){return Bt||(Bt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy($,xe):$)}function Ge($){if($ instanceof IDBRequest)return function vn($){const P=new Promise((ee,_e)=>{const $e=()=>{$.removeEventListener("success",ze),$.removeEventListener("error",ie)},ze=()=>{ee(Ge($.result)),$e()},ie=()=>{_e($.error),$e()};$.addEventListener("success",ze),$.addEventListener("error",ie)});return P.then(ee=>{ee instanceof IDBCursor&&G.set(ee,$)}).catch(()=>{}),ut.set(P,$),P}($);if(Le.has($))return Le.get($);const P=jt($);return P!==$&&(Le.set($,P),ut.set(P,$)),P}const yt=$=>ut.get($),je=["get","getKey","getAll","getAllKeys","count"],te=["put","add","delete","clear"],et=new Map;function Nt($,P){if(!($ instanceof IDBDatabase)||P in $||"string"!=typeof P)return;if(et.get(P))return et.get(P);const ee=P.replace(/FromIndex$/,""),_e=P!==ee,$e=te.includes(ee);if(!(ee in(_e?IDBIndex:IDBObjectStore).prototype)||!$e&&!je.includes(ee))return;const ze=function(){var ie=(0,T.Z)(function*(rn,...me){const We=this.transaction(rn,$e?"readwrite":"readonly");let pa=We.store;return _e&&(pa=pa.index(me.shift())),(yield Promise.all([pa[ee](...me),$e&&We.done]))[0]});return function(me){return ie.apply(this,arguments)}}();return et.set(P,ze),ze}!function Me($){xe=$(xe)}($=>({...$,get:(P,ee,_e)=>Nt(P,ee)||$.get(P,ee,_e),has:(P,ee)=>!!Nt(P,ee)||$.has(P,ee)}));class Yt{constructor(P){this.container=P}getPlatformInfoString(){return this.container.getProviders().map(ee=>{if(function Sn($){const P=$.getComponent();return"VERSION"===P?.type}(ee)){const _e=ee.getImmediate();return`${_e.library}/${_e.version}`}return null}).filter(ee=>ee).join(" ")}}const pi="@firebase/app",tt=new x.Yd("@firebase/app"),ni="[DEFAULT]",ri={[pi]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},$n=new Map,Dr=new Map;function Ar($,P){try{$.container.addComponent(P)}catch(ee){tt.debug(`Component ${P.name} failed to register with FirebaseApp ${$.name}`,ee)}}function Hr($,P){$.container.addOrOverwriteComponent(P)}function xn($){const P=$.name;if(Dr.has(P))return tt.debug(`There were multiple attempts to register component ${P}.`),!1;Dr.set(P,$);for(const ee of $n.values())Ar(ee,$);return!0}function hr($,P){const ee=$.container.getProvider("heartbeat").getImmediate({optional:!0});return ee&&ee.triggerHeartbeat(),$.container.getProvider(P)}function Fi($,P,ee=ni){hr($,P).clearInstance(ee)}function fr(){Dr.clear()}const Ht=new ve.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class nn{constructor(P,ee,_e){this._isDeleted=!1,this._options=Object.assign({},P),this._config=Object.assign({},ee),this._name=ee.name,this._automaticDataCollectionEnabled=ee.automaticDataCollectionEnabled,this._container=_e,this.container.addComponent(new z.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(P){this.checkDestroyed(),this._automaticDataCollectionEnabled=P}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(P){this._isDeleted=P}checkDestroyed(){if(this.isDeleted)throw Ht.create("app-deleted",{appName:this._name})}}const vi="10.6.0";function Xi($,P={}){let ee=$;"object"!=typeof P&&(P={name:P});const _e=Object.assign({name:ni,automaticDataCollectionEnabled:!1},P),$e=_e.name;if("string"!=typeof $e||!$e)throw Ht.create("bad-app-name",{appName:String($e)});if(ee||(ee=(0,ve.aH)()),!ee)throw Ht.create("no-options");const ze=$n.get($e);if(ze){if((0,ve.vZ)(ee,ze.options)&&(0,ve.vZ)(_e,ze.config))return ze;throw Ht.create("duplicate-app",{appName:$e})}const ie=new z.H0($e);for(const me of Dr.values())ie.addComponent(me);const rn=new nn(ee,_e,ie);return $n.set($e,rn),rn}function Ii($=ni){const P=$n.get($);if(!P&&$===ni&&(0,ve.aH)())return Xi();if(!P)throw Ht.create("no-app",{appName:$});return P}function wn(){return Array.from($n.values())}function hn($){return Hn.apply(this,arguments)}function Hn(){return(Hn=(0,T.Z)(function*($){const P=$.name;$n.has(P)&&($n.delete(P),yield Promise.all($.container.getProviders().map(ee=>ee.delete())),$.isDeleted=!0)})).apply(this,arguments)}function Cr($,P,ee){var _e;let $e=null!==(_e=ri[$])&&void 0!==_e?_e:$;ee&&($e+=`-${ee}`);const ze=$e.match(/\s|\//),ie=P.match(/\s|\//);if(ze||ie){const rn=[`Unable to register library "${$e}" with version "${P}":`];return ze&&rn.push(`library name "${$e}" contains illegal characters (whitespace or "/")`),ze&&ie&&rn.push("and"),ie&&rn.push(`version name "${P}" contains illegal characters (whitespace or "/")`),void tt.warn(rn.join(" "))}xn(new z.wA(`${$e}-version`,()=>({library:$e,version:P}),"VERSION"))}function yo($,P){if(null!==$&&"function"!=typeof $)throw Ht.create("invalid-log-argument");(0,x.Am)($,P)}function es($){(0,x.Ub)($)}const Ps="firebase-heartbeat-database",Ei=1,S="firebase-heartbeat-store";let A=null;function E(){return A||(A=function wr($,P,{blocked:ee,upgrade:_e,blocking:$e,terminated:ze}={}){const ie=indexedDB.open($,P),rn=Ge(ie);return _e&&ie.addEventListener("upgradeneeded",me=>{_e(Ge(ie.result),me.oldVersion,me.newVersion,Ge(ie.transaction),me)}),ee&&ie.addEventListener("blocked",me=>ee(me.oldVersion,me.newVersion,me)),rn.then(me=>{ze&&me.addEventListener("close",()=>ze()),$e&&me.addEventListener("versionchange",We=>$e(We.oldVersion,We.newVersion,We))}).catch(()=>{}),rn}(Ps,Ei,{upgrade:($,P)=>{0===P&&$.createObjectStore(S)}}).catch($=>{throw Ht.create("idb-open",{originalErrorMessage:$.message})})),A}function v(){return(v=(0,T.Z)(function*($){try{return yield(yield E()).transaction(S).objectStore(S).get(fe($))}catch(P){if(P instanceof ve.ZR)tt.warn(P.message);else{const ee=Ht.create("idb-get",{originalErrorMessage:P?.message});tt.warn(ee.message)}}})).apply(this,arguments)}function M($,P){return H.apply(this,arguments)}function H(){return(H=(0,T.Z)(function*($,P){try{const _e=(yield E()).transaction(S,"readwrite");yield _e.objectStore(S).put(P,fe($)),yield _e.done}catch(ee){if(ee instanceof ve.ZR)tt.warn(ee.message);else{const _e=Ht.create("idb-set",{originalErrorMessage:ee?.message});tt.warn(_e.message)}}})).apply(this,arguments)}function fe($){return`${$.name}!${$.options.appId}`}class st{constructor(P){this.container=P,this._heartbeatsCache=null;const ee=this.container.getProvider("app").getImmediate();this._storage=new Ee(ee),this._heartbeatsCachePromise=this._storage.read().then(_e=>(this._heartbeatsCache=_e,_e))}triggerHeartbeat(){var P=this;return(0,T.Z)(function*(){var ee;const $e=P.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),ze=ue();if(null==(null===(ee=P._heartbeatsCache)||void 0===ee?void 0:ee.heartbeats)&&(P._heartbeatsCache=yield P._heartbeatsCachePromise),P._heartbeatsCache.lastSentHeartbeatDate!==ze&&!P._heartbeatsCache.heartbeats.some(ie=>ie.date===ze))return P._heartbeatsCache.heartbeats.push({date:ze,agent:$e}),P._heartbeatsCache.heartbeats=P._heartbeatsCache.heartbeats.filter(ie=>{const rn=new Date(ie.date).valueOf();return Date.now()-rn<=2592e6}),P._storage.overwrite(P._heartbeatsCache)})()}getHeartbeatsHeader(){var P=this;return(0,T.Z)(function*(){var ee;if(null===P._heartbeatsCache&&(yield P._heartbeatsCachePromise),null==(null===(ee=P._heartbeatsCache)||void 0===ee?void 0:ee.heartbeats)||0===P._heartbeatsCache.heartbeats.length)return"";const _e=ue(),{heartbeatsToSend:$e,unsentEntries:ze}=function Et($,P=1024){const ee=[];let _e=$.slice();for(const $e of $){const ze=ee.find(ie=>ie.agent===$e.agent);if(ze){if(ze.dates.push($e.date),bn(ee)>P){ze.dates.pop();break}}else if(ee.push({agent:$e.agent,dates:[$e.date]}),bn(ee)>P){ee.pop();break}_e=_e.slice(1)}return{heartbeatsToSend:ee,unsentEntries:_e}}(P._heartbeatsCache.heartbeats),ie=(0,ve.L)(JSON.stringify({version:2,heartbeats:$e}));return P._heartbeatsCache.lastSentHeartbeatDate=_e,ze.length>0?(P._heartbeatsCache.heartbeats=ze,yield P._storage.overwrite(P._heartbeatsCache)):(P._heartbeatsCache.heartbeats=[],P._storage.overwrite(P._heartbeatsCache)),ie})()}}function ue(){return(new Date).toISOString().substring(0,10)}class Ee{constructor(P){this.app=P,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,T.Z)(function*(){return!!(0,ve.hl)()&&(0,ve.eu)().then(()=>!0).catch(()=>!1)})()}read(){var P=this;return(0,T.Z)(function*(){return(yield P._canUseIndexedDBPromise)&&(yield function w($){return v.apply(this,arguments)}(P.app))||{heartbeats:[]}})()}overwrite(P){var ee=this;return(0,T.Z)(function*(){var _e;if(yield ee._canUseIndexedDBPromise){const ze=yield ee.read();return M(ee.app,{lastSentHeartbeatDate:null!==(_e=P.lastSentHeartbeatDate)&&void 0!==_e?_e:ze.lastSentHeartbeatDate,heartbeats:P.heartbeats})}})()}add(P){var ee=this;return(0,T.Z)(function*(){var _e;if(yield ee._canUseIndexedDBPromise){const ze=yield ee.read();return M(ee.app,{lastSentHeartbeatDate:null!==(_e=P.lastSentHeartbeatDate)&&void 0!==_e?_e:ze.lastSentHeartbeatDate,heartbeats:[...ze.heartbeats,...P.heartbeats]})}})()}}function bn($){return(0,ve.L)(JSON.stringify({version:2,heartbeats:$})).length}!function Ns($){xn(new z.wA("platform-logger",P=>new Yt(P),"PRIVATE")),xn(new z.wA("heartbeat",P=>new st(P),"PRIVATE")),Cr(pi,"0.9.23",$),Cr(pi,"0.9.23","esm2017"),Cr("fire-js","")}("")},537:(fi,yn,Se)=>{Se.d(yn,{H0:()=>St,wA:()=>x});var T=Se(861),z=Se(58);class x{constructor(G,re,Ie){this.name=G,this.instanceFactory=re,this.type=Ie,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(G){return this.instantiationMode=G,this}setMultipleInstances(G){return this.multipleInstances=G,this}setServiceProps(G){return this.serviceProps=G,this}setInstanceCreatedCallback(G){return this.onInstanceCreated=G,this}}const ve="[DEFAULT]";class gt{constructor(G,re){this.name=G,this.container=re,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(G){const re=this.normalizeInstanceIdentifier(G);if(!this.instancesDeferred.has(re)){const Ie=new z.BH;if(this.instancesDeferred.set(re,Ie),this.isInitialized(re)||this.shouldAutoInitialize())try{const Le=this.getOrInitializeService({instanceIdentifier:re});Le&&Ie.resolve(Le)}catch{}}return this.instancesDeferred.get(re).promise}getImmediate(G){var re;const Ie=this.normalizeInstanceIdentifier(G?.identifier),Le=null!==(re=G?.optional)&&void 0!==re&&re;if(!this.isInitialized(Ie)&&!this.shouldAutoInitialize()){if(Le)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ie})}catch(ut){if(Le)return null;throw ut}}getComponent(){return this.component}setComponent(G){if(G.name!==this.name)throw Error(`Mismatching Component ${G.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=G,this.shouldAutoInitialize()){if(function tn(rt){return"EAGER"===rt.instantiationMode}(G))try{this.getOrInitializeService({instanceIdentifier:ve})}catch{}for(const[re,Ie]of this.instancesDeferred.entries()){const Le=this.normalizeInstanceIdentifier(re);try{const ut=this.getOrInitializeService({instanceIdentifier:Le});Ie.resolve(ut)}catch{}}}}clearInstance(G=ve){this.instancesDeferred.delete(G),this.instancesOptions.delete(G),this.instances.delete(G)}delete(){var G=this;return(0,T.Z)(function*(){const re=Array.from(G.instances.values());yield Promise.all([...re.filter(Ie=>"INTERNAL"in Ie).map(Ie=>Ie.INTERNAL.delete()),...re.filter(Ie=>"_delete"in Ie).map(Ie=>Ie._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(G=ve){return this.instances.has(G)}getOptions(G=ve){return this.instancesOptions.get(G)||{}}initialize(G={}){const{options:re={}}=G,Ie=this.normalizeInstanceIdentifier(G.instanceIdentifier);if(this.isInitialized(Ie))throw Error(`${this.name}(${Ie}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Le=this.getOrInitializeService({instanceIdentifier:Ie,options:re});for(const[ut,vn]of this.instancesDeferred.entries())Ie===this.normalizeInstanceIdentifier(ut)&&vn.resolve(Le);return Le}onInit(G,re){var Ie;const Le=this.normalizeInstanceIdentifier(re),ut=null!==(Ie=this.onInitCallbacks.get(Le))&&void 0!==Ie?Ie:new Set;ut.add(G),this.onInitCallbacks.set(Le,ut);const vn=this.instances.get(Le);return vn&&G(vn,Le),()=>{ut.delete(G)}}invokeOnInitCallbacks(G,re){const Ie=this.onInitCallbacks.get(re);if(Ie)for(const Le of Ie)try{Le(G,re)}catch{}}getOrInitializeService({instanceIdentifier:G,options:re={}}){let Ie=this.instances.get(G);if(!Ie&&this.component&&(Ie=this.component.instanceFactory(this.container,{instanceIdentifier:(rt=G,rt===ve?void 0:rt),options:re}),this.instances.set(G,Ie),this.instancesOptions.set(G,re),this.invokeOnInitCallbacks(Ie,G),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,G,Ie)}catch{}var rt;return Ie||null}normalizeInstanceIdentifier(G=ve){return this.component?this.component.multipleInstances?G:ve:G}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class St{constructor(G){this.name=G,this.providers=new Map}addComponent(G){const re=this.getProvider(G.name);if(re.isComponentSet())throw new Error(`Component ${G.name} has already been registered with ${this.name}`);re.setComponent(G)}addOrOverwriteComponent(G){this.getProvider(G.name).isComponentSet()&&this.providers.delete(G.name),this.addComponent(G)}getProvider(G){if(this.providers.has(G))return this.providers.get(G);const re=new gt(G,this);return this.providers.set(G,re),re}getProviders(){return Array.from(this.providers.values())}}},879:(fi,yn,Se)=>{Se.d(yn,{Am:()=>rt,Ub:()=>St,Yd:()=>tn,in:()=>z});const T=[];var z=function(G){return G[G.DEBUG=0]="DEBUG",G[G.VERBOSE=1]="VERBOSE",G[G.INFO=2]="INFO",G[G.WARN=3]="WARN",G[G.ERROR=4]="ERROR",G[G.SILENT=5]="SILENT",G}(z||{});const x={debug:z.DEBUG,verbose:z.VERBOSE,info:z.INFO,warn:z.WARN,error:z.ERROR,silent:z.SILENT},ve=z.INFO,gt={[z.DEBUG]:"log",[z.VERBOSE]:"log",[z.INFO]:"info",[z.WARN]:"warn",[z.ERROR]:"error"},Bt=(G,re,...Ie)=>{if(re<G.logLevel)return;const Le=(new Date).toISOString(),ut=gt[re];if(!ut)throw new Error(`Attempted to log a message with an invalid logType (value: ${re})`);console[ut](`[${Le}]  ${G.name}:`,...Ie)};class tn{constructor(re){this.name=re,this._logLevel=ve,this._logHandler=Bt,this._userLogHandler=null,T.push(this)}get logLevel(){return this._logLevel}set logLevel(re){if(!(re in z))throw new TypeError(`Invalid value "${re}" assigned to \`logLevel\``);this._logLevel=re}setLogLevel(re){this._logLevel="string"==typeof re?x[re]:re}get logHandler(){return this._logHandler}set logHandler(re){if("function"!=typeof re)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=re}get userLogHandler(){return this._userLogHandler}set userLogHandler(re){this._userLogHandler=re}debug(...re){this._userLogHandler&&this._userLogHandler(this,z.DEBUG,...re),this._logHandler(this,z.DEBUG,...re)}log(...re){this._userLogHandler&&this._userLogHandler(this,z.VERBOSE,...re),this._logHandler(this,z.VERBOSE,...re)}info(...re){this._userLogHandler&&this._userLogHandler(this,z.INFO,...re),this._logHandler(this,z.INFO,...re)}warn(...re){this._userLogHandler&&this._userLogHandler(this,z.WARN,...re),this._logHandler(this,z.WARN,...re)}error(...re){this._userLogHandler&&this._userLogHandler(this,z.ERROR,...re),this._logHandler(this,z.ERROR,...re)}}function St(G){T.forEach(re=>{re.setLogLevel(G)})}function rt(G,re){for(const Ie of T){let Le=null;re&&re.level&&(Le=x[re.level]),Ie.userLogHandler=null===G?null:(ut,vn,...Ye)=>{const xe=Ye.map(Me=>{if(null==Me)return null;if("string"==typeof Me)return Me;if("number"==typeof Me||"boolean"==typeof Me)return Me.toString();if(Me instanceof Error)return Me.message;try{return JSON.stringify(Me)}catch{return null}}).filter(Me=>Me).join(" ");vn>=(Le??ut.logLevel)&&G({level:z[vn].toLowerCase(),message:xe,args:Ye,type:ut.name})}}}},365:(fi,yn,Se)=>{Se.r(yn);var T=Se(861),z=Se(106),x=Se(562),ve=Se(58),tn=(Se(534),Se(879),Se(537));function St(){return window}function re(){return re=(0,T.Z)(function*(E,w,v){var M;const{BuildInfo:H}=St();(0,x.au)(w.sessionId,"AuthEvent did not contain a session ID");const fe=yield function Me(E){return Cn.apply(this,arguments)}(w.sessionId),Ae={};return(0,x.av)()?Ae.ibi=H.packageName:(0,x.aw)()?Ae.apn=H.packageName:(0,x.ax)(E,"operation-not-supported-in-this-environment"),H.displayName&&(Ae.appDisplayName=H.displayName),Ae.sessionId=fe,(0,x.ay)(E,v,w.type,void 0,null!==(M=w.eventId)&&void 0!==M?M:void 0,Ae)}),re.apply(this,arguments)}function Le(){return(Le=(0,T.Z)(function*(E){const{BuildInfo:w}=St(),v={};(0,x.av)()?v.iosBundleId=w.packageName:(0,x.aw)()?v.androidPackageName=w.packageName:(0,x.ax)(E,"operation-not-supported-in-this-environment"),yield(0,x.az)(E,v)})).apply(this,arguments)}function Ye(){return(Ye=(0,T.Z)(function*(E,w,v){const{cordova:M}=St();let H=()=>{};try{yield new Promise((fe,Ae)=>{let Pe=null;function st(){var Ee;fe();const bn=null===(Ee=M.plugins.browsertab)||void 0===Ee?void 0:Ee.close;"function"==typeof bn&&bn(),"function"==typeof v?.close&&v.close()}function ue(){Pe||(Pe=window.setTimeout(()=>{Ae((0,x.aB)(E,"redirect-cancelled-by-user"))},2e3))}function Et(){"visible"===document?.visibilityState&&ue()}w.addPassiveListener(st),document.addEventListener("resume",ue,!1),(0,x.aw)()&&document.addEventListener("visibilitychange",Et,!1),H=()=>{w.removePassiveListener(st),document.removeEventListener("resume",ue,!1),document.removeEventListener("visibilitychange",Et,!1),Pe&&window.clearTimeout(Pe)}})}finally{H()}})).apply(this,arguments)}function Cn(){return(Cn=(0,T.Z)(function*(E){const w=function jt(E){if((0,x.au)(/[0-9a-zA-Z]+/.test(E),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(E);const w=new ArrayBuffer(E.length),v=new Uint8Array(w);for(let M=0;M<E.length;M++)v[M]=E.charCodeAt(M);return v}(E),v=yield crypto.subtle.digest("SHA-256",w);return Array.from(new Uint8Array(v)).map(H=>H.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class yt extends x.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(w=>{this.resolveInialized=w})}addPassiveListener(w){this.passiveListeners.add(w)}removePassiveListener(w){this.passiveListeners.delete(w)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(w){return this.resolveInialized(),this.passiveListeners.forEach(v=>v(w)),super.onEvent(w)}initialized(){var w=this;return(0,T.Z)(function*(){yield w.initPromise})()}}function je(E){return te.apply(this,arguments)}function te(){return(te=(0,T.Z)(function*(E){const w=yield Yt()._get(Sn(E));return w&&(yield Yt()._remove(Sn(E))),w})).apply(this,arguments)}function Nt(){const E=[];for(let v=0;v<20;v++){const M=Math.floor(62*Math.random());E.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(M))}return E.join("")}function Yt(){return(0,x.aE)(x.b)}function Sn(E){return(0,x.aF)("authEvent",E.config.apiKey,E.name)}function tt(E){if(!E?.includes("?"))return{};const[w,...v]=E.split("?");return(0,ve.zd)(v.join("?"))}const U=class gi{constructor(){this._redirectPersistence=x.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=x.aG,this._overrideRedirectResult=x.aH}_initialize(w){var v=this;return(0,T.Z)(function*(){const M=w._key();let H=v.eventManagers.get(M);return H||(H=new yt(w),v.eventManagers.set(M,H),v.attachCallbackListeners(w,H)),H})()}_openPopup(w){(0,x.ax)(w,"operation-not-supported-in-this-environment")}_openRedirect(w,v,M,H){var fe=this;return(0,T.Z)(function*(){!function xe(E){var w,v,M,H,fe,Ae,Pe,st,ue,Et;const Ee=St();(0,x.aC)("function"==typeof(null===(w=Ee?.universalLinks)||void 0===w?void 0:w.subscribe),E,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,x.aC)(typeof(null===(v=Ee?.BuildInfo)||void 0===v?void 0:v.packageName)<"u",E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,x.aC)("function"==typeof(null===(fe=null===(H=null===(M=Ee?.cordova)||void 0===M?void 0:M.plugins)||void 0===H?void 0:H.browsertab)||void 0===fe?void 0:fe.openUrl),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,x.aC)("function"==typeof(null===(st=null===(Pe=null===(Ae=Ee?.cordova)||void 0===Ae?void 0:Ae.plugins)||void 0===Pe?void 0:Pe.browsertab)||void 0===st?void 0:st.isAvailable),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,x.aC)("function"==typeof(null===(Et=null===(ue=Ee?.cordova)||void 0===ue?void 0:ue.InAppBrowser)||void 0===Et?void 0:Et.open),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(w);const Ae=yield fe._initialize(w);yield Ae.initialized(),Ae.resetRedirect(),(0,x.aI)(),yield fe._originValidation(w);const Pe=function wr(E,w,v=null){return{type:w,eventId:v,urlResponse:null,sessionId:Nt(),postBody:null,tenantId:E.tenantId,error:(0,x.aB)(E,"no-auth-event")}}(w,M,H);yield function dn(E,w){return Yt()._set(Sn(E),w)}(w,Pe);const st=yield function G(E,w,v){return re.apply(this,arguments)}(w,Pe,v),ue=yield function ut(E){const{cordova:w}=St();return new Promise(v=>{w.plugins.browsertab.isAvailable(M=>{let H=null;M?w.plugins.browsertab.openUrl(E):H=w.InAppBrowser.open(E,(0,x.aA)()?"_blank":"_system","location=yes"),v(H)})})}(st);return function vn(E,w,v){return Ye.apply(this,arguments)}(w,Ae,ue)})()}_isIframeWebStorageSupported(w,v){throw new Error("Method not implemented.")}_originValidation(w){const v=w._key();return this.originValidationPromises[v]||(this.originValidationPromises[v]=function Ie(E){return Le.apply(this,arguments)}(w)),this.originValidationPromises[v]}attachCallbackListeners(w,v){const{universalLinks:M,handleOpenURL:H,BuildInfo:fe}=St(),Ae=setTimeout((0,T.Z)(function*(){yield je(w),v.onEvent(j())}),500),Pe=function(){var Et=(0,T.Z)(function*(Ee){clearTimeout(Ae);const bn=yield je(w);let Ns=null;bn&&Ee?.url&&(Ns=function et(E,w){var v,M;const H=function ei(E){const w=tt(E),v=w.link?decodeURIComponent(w.link):void 0,M=tt(v).link,H=w.deep_link_id?decodeURIComponent(w.deep_link_id):void 0;return tt(H).link||H||M||v||E}(w);if(H.includes("/__/auth/callback")){const fe=tt(H),Ae=fe.firebaseError?function pi(E){try{return JSON.parse(E)}catch{return null}}(decodeURIComponent(fe.firebaseError)):null,Pe=null===(M=null===(v=Ae?.code)||void 0===v?void 0:v.split("auth/"))||void 0===M?void 0:M[1],st=Pe?(0,x.aB)(Pe):null;return st?{type:E.type,eventId:E.eventId,tenantId:E.tenantId,error:st,urlResponse:null,sessionId:null,postBody:null}:{type:E.type,eventId:E.eventId,tenantId:E.tenantId,sessionId:E.sessionId,urlResponse:H,postBody:null}}return null}(bn,Ee.url)),v.onEvent(Ns||j())});return function(bn){return Et.apply(this,arguments)}}();typeof M<"u"&&"function"==typeof M.subscribe&&M.subscribe(null,Pe);const st=H,ue=`${fe.packageName.toLowerCase()}://`;St().handleOpenURL=function(){var Et=(0,T.Z)(function*(Ee){if(Ee.toLowerCase().startsWith(ue)&&Pe({url:Ee}),"function"==typeof st)try{st(Ee)}catch(bn){console.error(bn)}});return function(Ee){return Et.apply(this,arguments)}}()}};function j(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,x.aB)("no-auth-event")}}function de(){var E;return(null===(E=self?.location)||void 0===E?void 0:E.protocol)||null}function Ve(E=(0,ve.z$)()){return!("file:"!==de()&&"ionic:"!==de()&&"capacitor:"!==de()||!E.toLowerCase().match(/iphone|ipad|ipod|android/))}function $t(){try{const E=self.localStorage,w=x.aN();if(E)return E.setItem(w,"1"),E.removeItem(w),!function Tt(E=(0,ve.z$)()){return function it(){return(0,ve.w1)()&&11===document?.documentMode}()||function Mt(E=(0,ve.z$)()){return/Edge\/\d+/.test(E)}(E)}()||(0,ve.hl)()}catch{return In()&&(0,ve.hl)()}return!1}function In(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function En(){return(function qe(){return"http:"===de()||"https:"===de()}()||(0,ve.ru)()||Ve())&&!function De(){return(0,ve.b$)()||(0,ve.UG)()}()&&$t()&&!In()}function Nn(){return Ve()&&typeof document<"u"}function ti(){return(ti=(0,T.Z)(function*(){return!!Nn()&&new Promise(E=>{const w=setTimeout(()=>{E(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(w),E(!0)})})})).apply(this,arguments)}const mt={LOCAL:"local",NONE:"none",SESSION:"session"},_i=x.aC,yi="persistence";function ri(E){return $n.apply(this,arguments)}function $n(){return($n=(0,T.Z)(function*(E){yield E._initializationPromise;const w=Ar(),v=x.aF(yi,E.config.apiKey,E.name);w&&w.setItem(v,E._getPersistence())})).apply(this,arguments)}function Ar(){var E;try{return(null===(E=function mi(){return typeof window<"u"?window:null}())||void 0===E?void 0:E.sessionStorage)||null}catch{return null}}const Hr=x.aC;class xn{constructor(){this.browserResolver=x.aE(x.k),this.cordovaResolver=x.aE(U),this.underlyingResolver=null,this._redirectPersistence=x.a,this._completeRedirectFn=x.aG,this._overrideRedirectResult=x.aH}_initialize(w){var v=this;return(0,T.Z)(function*(){return yield v.selectUnderlyingResolver(),v.assertedUnderlyingResolver._initialize(w)})()}_openPopup(w,v,M,H){var fe=this;return(0,T.Z)(function*(){return yield fe.selectUnderlyingResolver(),fe.assertedUnderlyingResolver._openPopup(w,v,M,H)})()}_openRedirect(w,v,M,H){var fe=this;return(0,T.Z)(function*(){return yield fe.selectUnderlyingResolver(),fe.assertedUnderlyingResolver._openRedirect(w,v,M,H)})()}_isIframeWebStorageSupported(w,v){this.assertedUnderlyingResolver._isIframeWebStorageSupported(w,v)}_originValidation(w){return this.assertedUnderlyingResolver._originValidation(w)}get _shouldInitProactively(){return Nn()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Hr(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var w=this;return(0,T.Z)(function*(){if(w.underlyingResolver)return;const v=yield function dr(){return ti.apply(this,arguments)}();w.underlyingResolver=v?w.cordovaResolver:w.browserResolver})()}}function hr(E){return E.unwrap()}function fr(E){return Ht(E)}function Ht(E){const{_tokenResponse:w}=E instanceof ve.ZR?E.customData:E;if(!w)return null;if(!(E instanceof ve.ZR)&&"temporaryProof"in w&&"phoneNumber"in w)return x.P.credentialFromResult(E);const v=w.providerId;if(!v||v===x.p.PASSWORD)return null;let M;switch(v){case x.p.GOOGLE:M=x.X;break;case x.p.FACEBOOK:M=x.W;break;case x.p.GITHUB:M=x.Y;break;case x.p.TWITTER:M=x.$;break;default:const{oauthIdToken:H,oauthAccessToken:fe,oauthTokenSecret:Ae,pendingToken:Pe,nonce:st}=w;return fe||Ae||H||Pe?Pe?v.startsWith("saml.")?x.aQ._create(v,Pe):x.N._fromParams({providerId:v,signInMethod:v,pendingToken:Pe,idToken:H,accessToken:fe}):new x.Z(v).credential({idToken:H,accessToken:fe,rawNonce:st}):null}return E instanceof ve.ZR?M.credentialFromError(E):M.credentialFromResult(E)}function nn(E,w){return w.catch(v=>{throw v instanceof ve.ZR&&function fa(E,w){var v;const M=null===(v=w.customData)||void 0===v?void 0:v._tokenResponse;if("auth/multi-factor-auth-required"===w?.code)w.resolver=new Ii(E,x.as(E,w));else if(M){const H=Ht(w),fe=w;H&&(fe.credential=H,fe.tenantId=M.tenantId||void 0,fe.email=M.email||void 0,fe.phoneNumber=M.phoneNumber||void 0)}}(E,v),v}).then(v=>{const H=v.user;return{operationType:v.operationType,credential:fr(v),additionalUserInfo:x.aq(v),user:wn.getOrCreate(H)}})}function vi(E,w){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,T.Z)(function*(E,w){const v=yield w;return{verificationId:v.verificationId,confirm:M=>nn(E,v.confirm(M))}})).apply(this,arguments)}class Ii{constructor(w,v){this.resolver=v,this.auth=function Fi(E){return E.wrapped()}(w)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(w){return nn(hr(this.auth),this.resolver.resolveSignIn(w))}}class wn{constructor(w){this._delegate=w,this.multiFactor=x.at(w)}static getOrCreate(w){return wn.USER_MAP.has(w)||wn.USER_MAP.set(w,new wn(w)),wn.USER_MAP.get(w)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(w){return this._delegate.getIdTokenResult(w)}getIdToken(w){return this._delegate.getIdToken(w)}linkAndRetrieveDataWithCredential(w){return this.linkWithCredential(w)}linkWithCredential(w){var v=this;return(0,T.Z)(function*(){return nn(v.auth,x.a2(v._delegate,w))})()}linkWithPhoneNumber(w,v){var M=this;return(0,T.Z)(function*(){return vi(M.auth,x.l(M._delegate,w,v))})()}linkWithPopup(w){var v=this;return(0,T.Z)(function*(){return nn(v.auth,x.d(v._delegate,w,xn))})()}linkWithRedirect(w){var v=this;return(0,T.Z)(function*(){return yield ri(x.aJ(v.auth)),x.g(v._delegate,w,xn)})()}reauthenticateAndRetrieveDataWithCredential(w){return this.reauthenticateWithCredential(w)}reauthenticateWithCredential(w){var v=this;return(0,T.Z)(function*(){return nn(v.auth,x.a3(v._delegate,w))})()}reauthenticateWithPhoneNumber(w,v){return vi(this.auth,x.r(this._delegate,w,v))}reauthenticateWithPopup(w){return nn(this.auth,x.e(this._delegate,w,xn))}reauthenticateWithRedirect(w){var v=this;return(0,T.Z)(function*(){return yield ri(x.aJ(v.auth)),x.h(v._delegate,w,xn)})()}sendEmailVerification(w){return x.ag(this._delegate,w)}unlink(w){var v=this;return(0,T.Z)(function*(){return yield x.ap(v._delegate,w),v})()}updateEmail(w){return x.al(this._delegate,w)}updatePassword(w){return x.am(this._delegate,w)}updatePhoneNumber(w){return x.u(this._delegate,w)}updateProfile(w){return x.ak(this._delegate,w)}verifyBeforeUpdateEmail(w,v){return x.ah(this._delegate,w,v)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}wn.USER_MAP=new WeakMap;const hn=x.aC;let Hn=(()=>{class E{constructor(v,M){if(this.app=v,M.isInitialized())return this._delegate=M.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:H}=v.options;hn(H,"invalid-api-key",{appName:v.name}),hn(H,"invalid-api-key",{appName:v.name});const fe=typeof window<"u"?xn:void 0;this._delegate=M.initialize({options:{persistence:yo(H,v.name),popupRedirectResolver:fe}}),this._delegate._updateErrorMap(x.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?wn.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(v){this._delegate.languageCode=v}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(v){this._delegate.tenantId=v}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(v,M){x.K(this._delegate,v,M)}applyActionCode(v){return x.a7(this._delegate,v)}checkActionCode(v){return x.a8(this._delegate,v)}confirmPasswordReset(v,M){return x.a6(this._delegate,v,M)}createUserWithEmailAndPassword(v,M){var H=this;return(0,T.Z)(function*(){return nn(H._delegate,x.aa(H._delegate,v,M))})()}fetchProvidersForEmail(v){return this.fetchSignInMethodsForEmail(v)}fetchSignInMethodsForEmail(v){return x.af(this._delegate,v)}isSignInWithEmailLink(v){return x.ad(this._delegate,v)}getRedirectResult(){var v=this;return(0,T.Z)(function*(){hn(En(),v._delegate,"operation-not-supported-in-this-environment");const M=yield x.j(v._delegate,xn);return M?nn(v._delegate,Promise.resolve(M)):{credential:null,user:null}})()}addFrameworkForLogging(v){!function q(E,w){(0,x.aJ)(E)._logFramework(w)}(this._delegate,v)}onAuthStateChanged(v,M,H){const{next:fe,error:Ae,complete:Pe}=Cr(v,M,H);return this._delegate.onAuthStateChanged(fe,Ae,Pe)}onIdTokenChanged(v,M,H){const{next:fe,error:Ae,complete:Pe}=Cr(v,M,H);return this._delegate.onIdTokenChanged(fe,Ae,Pe)}sendSignInLinkToEmail(v,M){return x.ac(this._delegate,v,M)}sendPasswordResetEmail(v,M){return x.a5(this._delegate,v,M||void 0)}setPersistence(v){var M=this;return(0,T.Z)(function*(){let H;switch(function ni(E,w){_i(Object.values(mt).includes(w),E,"invalid-persistence-type"),(0,ve.b$)()?_i(w!==mt.SESSION,E,"unsupported-persistence-type"):(0,ve.UG)()?_i(w===mt.NONE,E,"unsupported-persistence-type"):In()?_i(w===mt.NONE||w===mt.LOCAL&&(0,ve.hl)(),E,"unsupported-persistence-type"):_i(w===mt.NONE||$t(),E,"unsupported-persistence-type")}(M._delegate,v),v){case mt.SESSION:H=x.a;break;case mt.LOCAL:H=(yield x.aE(x.i)._isAvailable())?x.i:x.b;break;case mt.NONE:H=x.U;break;default:return x.ax("argument-error",{appName:M._delegate.name})}return M._delegate.setPersistence(H)})()}signInAndRetrieveDataWithCredential(v){return this.signInWithCredential(v)}signInAnonymously(){return nn(this._delegate,x.a0(this._delegate))}signInWithCredential(v){return nn(this._delegate,x.a1(this._delegate,v))}signInWithCustomToken(v){return nn(this._delegate,x.a4(this._delegate,v))}signInWithEmailAndPassword(v,M){return nn(this._delegate,x.ab(this._delegate,v,M))}signInWithEmailLink(v,M){return nn(this._delegate,x.ae(this._delegate,v,M))}signInWithPhoneNumber(v,M){return vi(this._delegate,x.s(this._delegate,v,M))}signInWithPopup(v){var M=this;return(0,T.Z)(function*(){return hn(En(),M._delegate,"operation-not-supported-in-this-environment"),nn(M._delegate,x.c(M._delegate,v,xn))})()}signInWithRedirect(v){var M=this;return(0,T.Z)(function*(){return hn(En(),M._delegate,"operation-not-supported-in-this-environment"),yield ri(M._delegate),x.f(M._delegate,v,xn)})()}updateCurrentUser(v){return this._delegate.updateCurrentUser(v)}verifyPasswordResetCode(v){return x.a9(this._delegate,v)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return E.Persistence=mt,E})();function Cr(E,w,v){let M=E;"function"!=typeof E&&({next:M,error:w,complete:v}=E);const H=M;return{next:Ae=>H(Ae&&wn.getOrCreate(Ae)),error:w,complete:v}}function yo(E,w){const v=function Dr(E,w){const v=Ar();if(!v)return[];const M=x.aF(yi,E,w);switch(v.getItem(M)){case mt.NONE:return[x.U];case mt.LOCAL:return[x.i,x.a];case mt.SESSION:return[x.a];default:return[]}}(E,w);if(typeof self<"u"&&!v.includes(x.i)&&v.push(x.i),typeof window<"u")for(const M of[x.b,x.a])v.includes(M)||v.push(M);return v.includes(x.U)||v.push(x.U),v}class es{constructor(){this.providerId="phone",this._delegate=new x.P(hr(z.Z.auth()))}static credential(w,v){return x.P.credential(w,v)}verifyPhoneNumber(w,v){return this._delegate.verifyPhoneNumber(w,v)}unwrap(){return this._delegate}}es.PHONE_SIGN_IN_METHOD=x.P.PHONE_SIGN_IN_METHOD,es.PROVIDER_ID=x.P.PROVIDER_ID;const Ps=x.aC;class Ei{constructor(w,v,M=z.Z.app()){var H;Ps(null===(H=M.options)||void 0===H?void 0:H.apiKey,"invalid-api-key",{appName:M.name}),this._delegate=new x.R(M.auth(),w,v),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function A(E){E.INTERNAL.registerComponent(new tn.wA("auth-compat",w=>{const v=w.getProvider("app-compat").getImmediate(),M=w.getProvider("auth");return new Hn(v,M)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:x.A.EMAIL_SIGNIN,PASSWORD_RESET:x.A.PASSWORD_RESET,RECOVER_EMAIL:x.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:x.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:x.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:x.A.VERIFY_EMAIL}},EmailAuthProvider:x.V,FacebookAuthProvider:x.W,GithubAuthProvider:x.Y,GoogleAuthProvider:x.X,OAuthProvider:x.Z,SAMLAuthProvider:x._,PhoneAuthProvider:es,PhoneMultiFactorGenerator:x.m,RecaptchaVerifier:Ei,TwitterAuthProvider:x.$,Auth:Hn,AuthCredential:x.L,Error:ve.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),E.registerVersion("@firebase/auth-compat","0.4.9")}(z.Z)},861:(fi,yn,Se)=>{function T(x,ve,gt,Bt,tn,St,rt){try{var G=x[St](rt),re=G.value}catch(Ie){return void gt(Ie)}G.done?ve(re):Promise.resolve(re).then(Bt,tn)}function z(x){return function(){var ve=this,gt=arguments;return new Promise(function(Bt,tn){var St=x.apply(ve,gt);function rt(re){T(St,Bt,tn,rt,G,"next",re)}function G(re){T(St,Bt,tn,rt,G,"throw",re)}rt(void 0)})}}Se.d(yn,{Z:()=>z})},582:(fi,yn,Se)=>{function ve(U,j){var q={};for(var k in U)Object.prototype.hasOwnProperty.call(U,k)&&j.indexOf(k)<0&&(q[k]=U[k]);if(null!=U&&"function"==typeof Object.getOwnPropertySymbols){var K=0;for(k=Object.getOwnPropertySymbols(U);K<k.length;K++)j.indexOf(k[K])<0&&Object.prototype.propertyIsEnumerable.call(U,k[K])&&(q[k[K]]=U[k[K]])}return q}function Ie(U,j,q,k){return new(q||(q=Promise))(function(Y,de){function qe(it){try{De(k.next(it))}catch(Mt){de(Mt)}}function Ve(it){try{De(k.throw(it))}catch(Mt){de(Mt)}}function De(it){it.done?Y(it.value):function K(Y){return Y instanceof q?Y:new q(function(de){de(Y)})}(it.value).then(qe,Ve)}De((k=k.apply(U,j||[])).next())})}function Ge(U){return this instanceof Ge?(this.v=U,this):new Ge(U)}function yt(U,j,q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var K,k=q.apply(U,j||[]),Y=[];return K={},de("next"),de("throw"),de("return"),K[Symbol.asyncIterator]=function(){return this},K;function de(Tt){k[Tt]&&(K[Tt]=function($t){return new Promise(function(In,En){Y.push([Tt,$t,In,En])>1||qe(Tt,$t)})})}function qe(Tt,$t){try{!function Ve(Tt){Tt.value instanceof Ge?Promise.resolve(Tt.value.v).then(De,it):Mt(Y[0][2],Tt)}(k[Tt]($t))}catch(In){Mt(Y[0][3],In)}}function De(Tt){qe("next",Tt)}function it(Tt){qe("throw",Tt)}function Mt(Tt,$t){Tt($t),Y.shift(),Y.length&&qe(Y[0][0],Y[0][1])}}function dn(U){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var q,j=U[Symbol.asyncIterator];return j?j.call(U):(U=function Ye(U){var j="function"==typeof Symbol&&Symbol.iterator,q=j&&U[j],k=0;if(q)return q.call(U);if(U&&"number"==typeof U.length)return{next:function(){return U&&k>=U.length&&(U=void 0),{value:U&&U[k++],done:!U}}};throw new TypeError(j?"Object is not iterable.":"Symbol.iterator is not defined.")}(U),q={},k("next"),k("throw"),k("return"),q[Symbol.asyncIterator]=function(){return this},q);function k(Y){q[Y]=U[Y]&&function(de){return new Promise(function(qe,Ve){!function K(Y,de,qe,Ve){Promise.resolve(Ve).then(function(De){Y({value:De,done:qe})},de)}(qe,Ve,(de=U[Y](de)).done,de.value)})}}}Se.d(yn,{FC:()=>yt,KL:()=>dn,_T:()=>ve,mG:()=>Ie,qq:()=>Ge}),"function"==typeof SuppressedError&&SuppressedError}},fi=>{fi(fi.s=673)}]);