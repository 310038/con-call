/* eslint-disable @typescript-eslint/no-explicit-any */
import { MessagesModule } from 'primeng/messages';
import { Show } from './show';
import { Component, ViewChild, inject, Input, } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ButtonModule } from 'primeng/button';
import { DialogModule } from 'primeng/dialog';
import { FormsModule } from '@angular/forms';
import { ToastModule } from 'primeng/toast';
import { ScreenshotService } from './screenshot.service';
import { IceCandidateService } from './ice-candidate.service';
import { ConnectionService } from './connection.service';
import { FirebaseService } from './firebase.service';
import { MediaService } from './media.service';
import { MessageService } from 'primeng/api';
import { TranslateModule } from '@ngx-translate/core';
import { GalleriaModule } from 'primeng/galleria';
import { DividerModule } from 'primeng/divider';
import { ProgressSpinnerModule } from 'primeng/progressspinner';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "primeng/api";
import * as i3 from "primeng/button";
import * as i4 from "primeng/galleria";
const primeModule = [DividerModule, ButtonModule, DialogModule, ToastModule, MessagesModule, GalleriaModule, ProgressSpinnerModule];
export class FireVideoComponent {
    constructor() {
        this.videoIcon = 'videoCam';
        this.micIcon = "Mic";
        this.contactsIcon = "Contacts";
        // 定義在不同螢幕大小或設備上顯示圖片輪播時的配置選項
        this.galleriaResponsiveOptions = [
            {
                breakpoint: '1024px',
                numVisible: 5
            },
            {
                breakpoint: '960px',
                numVisible: 4
            },
            {
                breakpoint: '768px',
                numVisible: 3
            },
            {
                breakpoint: '560px',
                numVisible: 1
            }
        ];
        this.show = new Show();
        this.fireBaseService = inject(FirebaseService);
        this.iceCandidateService = inject(IceCandidateService);
        this.screenshotService = inject(ScreenshotService);
        this.peerConnectionService = inject(ConnectionService);
        this.mediaService = inject(MediaService);
    }
    ngOnInit() {
        this.openUserMedia();
    }
    /** 監聽截圖按鈕，當此按鈕被點擊時，呼叫 screenshot()，將對方視訊畫面截圖，並上傳至 CDN
     */
    onShootClick() {
        this.screenshotService.screenshot(this.roomId, this.remoteVideo);
    }
    /** 切換「鏡頭」開關
     */
    disableCamera() {
        // 依照isCameraDisabled 的 true/false ， 來切換icon 的 on/off 狀態
        this.show.isCameraDisabled = !this.show.isCameraDisabled;
        this.videoIcon = this.show.isCameraDisabled ? 'videocam_off' : 'videocam';
        this.show.isCameraDisabled ? this.mediaService.disableVideo(this.localStream) : this.mediaService.enableVideo(this.localStream);
    }
    /** 切換「麥克風」開關
     */
    disableMic() {
        // 依照isMicDisabled 的 true/false ， 來切換icon 的 on/off 狀態
        this.show.isMicDisabled = !this.show.isMicDisabled;
        this.micIcon = this.show.isMicDisabled ? 'mic_off' : 'Mic';
        this.show.isMicDisabled ? this.mediaService.disableMic(this.localStream) : this.mediaService.enableMic(this.localStream);
    }
    /** 創建房間
     * 在firebase中創建一個房間，此房間以房間號碼作識別，房間號碼(roomId)預其為病人身分證字號
     * 0.檢查使用者是否已經開啟視訊及麥克風，若否，則跳出警告視窗
     * 當此按鈕被按下後，會執行以下動作：
     * 1.創建一個名為rooms的collection，這個collection裡會有很多房間，不同房間以不同房間號碼(roomId)區分
     * 2.創建一個CallerPeerConnection
     * 3.收集local(caller)的 ice candidates，同時監聽remote(callee) 的 ice candidates ， 並寫入firestore中指定的subCollection(caller或callee)中以利進行交換。
     * 4.將localStream加入CallerPeerConnection，以利後續傳送給callee，callee接收到後就可以顯示在remoteVideo上(display the local media data.)
     * 5.設置Caller端的SDP，Caller端建立offer，並監聽answer。
     */
    async createRoom() {
        // 0.檢查使用者是否已經開啟視訊及麥克風，若否，則跳出警告視窗
        if (!this.localStream) {
            // this.toastMessageService.warning('請先開啟視訊及麥克風');
            return;
        }
        // 1.創建一個名為rooms的collection，這個collection裡會有很多房間，不同房間以不同房間號碼(roomId)區分
        this.fireBaseService.addCollection('rooms');
        // 2.創建一個CallerPeerConnection
        this.CallerPeerConnection = this.peerConnectionService.genConnection();
        // 3.收集local(caller)，並監聽remote(callee) 的 ice candidates ， 並寫入firestore中指定的subCollection(caller或callee)中以利進行交換。
        this.iceCandidateService.collectIceCandidates(this.roomId, this.CallerPeerConnection, 'callerCandidates', 'calleeCandidates');
        console.log(this.roomId);
        // 4.在建立RTCPeerConnection物件後，將localStream加入CallerPeerConnection，以利後續傳送給callee，callee接收到後就可以顯示在remoteVideo上(display the local media data.)
        this.addLocalMediaTracks(this.CallerPeerConnection);
        // 5.設置Caller端的SDP，Caller端建立offer，並監聽answer。
        this.peerConnectionService.setLocalPeer(this.CallerPeerConnection, this.roomId, this.remoteStream);
    }
    /** 按下「加入視訊」按鈕後，會執行以下動作：
     * 0.檢查使用者是否已經開啟視訊及麥克風，若否，則跳出警告視窗
     * 當此按鈕被按下後，會執行以下動作：
     * 1.彈出「加入視訊」對話框(讓user可以輸入指定的房間號碼，按下「確認」按鈕，就可以加入指定的房間。)
     * @todo showDialog() 顯示「加入視訊」對話框，讓user可以輸入指定的房間號碼，按下「確認」按鈕，就可以加入指定的房間。
     */
    joinRoom() {
        // 0.檢查使用者是否已經開啟視訊及麥克風，若否，則跳出警告視窗
        if (!this.localStream) {
            // this.toastMessageService.warning('請先開啟視訊及麥克風');
            return;
        }
        // 1. 彈出「加入視訊」對話框(讓user可以輸入指定的房間號碼，按下「確認」按鈕，就可以加入指定的房間。)
        this.showDialog();
    }
    /** 彈出「加入視訊」對話框後，user可以輸入房間號碼(病人身分證字號)，按下「確認」按鈕，就可以加入指定的房間。
     * 透過房間號碼(病人身分證字號)加入房間
     * 使用者可以透過輸入指定的房間號碼(病人身分證字號)來加入房間
     * @param roomId 房間號碼(病人身分證字號)
     * @todo joinRoomById()透過房間號碼(病人身分證字號)加入房間
     */
    async confirmJoinRoom() {
        this.inputRoomId = this.roomId; //記得刪掉
        this.joinRoomById(this.inputRoomId);
        this.hideDialog();
    }
    /** 根據user所輸入的roomId來加入指定視訊房間
     * 1. 取得user輸入的房間號碼(roomId)的房間的DocumentReference
     * 2. 獲取 roomDocRef 的 snapshot，並判斷使用者所輸入的房間(號碼)是否存在，如果不存在，則跳出警告視窗
     * 如果存在，則執行以下動作：
     * 1. 創建一個CalleePeerConnection
     * 2. 收集local(callee)，並監聽remote(caller) 的 ice candidates ， 並寫入firestore中指定的 subCollection(caller或callee)中以利進行交換。
     * 3. 將localStream加入CalleePeerConnection，以利後續傳送給caller，caller接收到後就可以顯示在remoteVideo上(display the local media data.)
     * 4. 設置Callee端的SDP，Callee端 取得offer並設置RemoteDescription ，然後建立answer， 將answer設置成LocalDescription，並將此 answer 寫到指定的roomDoc以利 Caller 端取得
     * @param inputRoomId 房間號碼(病人身分證字號)
     */
    async joinRoomById(inputRoomId) {
        // 1.取得user輸入的房間號碼(roomId)的房間的DocumentReference
        const roomDocRef = this.fireBaseService.getDocRef('rooms', `${inputRoomId}`);
        // 2. 獲取 roomDocRef 的 snapshot，並判斷使用者所輸入的房間(號碼)是否存在，如果不存在，則跳出警告視窗
        const roomSnapshot = await this.fireBaseService.getSnapshot(roomDocRef);
        if (!roomSnapshot.exists) {
            // this.toastMessageService.error('房間不存在');
            return;
        }
        // 如果存在，則執行以下動作：
        else {
            // 1. 創建一個CalleePeerConnection
            this.CalleePeerConnection = this.peerConnectionService.genConnection();
            // 2. 收集local(callee)，並監聽remote(caller) 的 ice candidates ， 並寫入firestore中指定的subCollection(caller或callee)中以利進行交換。
            this.iceCandidateService.collectIceCandidates(inputRoomId, this.CalleePeerConnection, 'calleeCandidates', 'callerCandidates');
            // 3.在建立RTCPeerConnection物件後並將localStream加入CalleePeerConnection，以利後續傳送給caller，caller接收到後就可以顯示在remoteVideo上(display the local media data.)
            this.addLocalMediaTracks(this.CalleePeerConnection);
            // 4. 設置Callee端的SDP，Callee端 到fireStore中拿取 offer(由caller所建立的)後，建立answer，並將此 answer 寫到指定的roomDoc以利 Caller 端取得
            this.peerConnectionService.setRemotePeer(this.CalleePeerConnection, inputRoomId, this.remoteStream);
        }
    }
    /** 開啟視訊
     */
    async openUserMedia() {
        const stream = await this.mediaService.getUserMedia();
        this.localStream = stream;
        this.remoteStream = new MediaStream();
        this.createRoom();
    }
    /** 掛斷視訊通話
     * 關閉視訊和音訊，並關閉連線雙方的peerConnection。
     * 關閉視訊通話後，將會刪除fireStore中的房間文件
     */
    async hangUp() {
        // 停止本地流和遠端流中的所有媒體軌道
        await this.stopMediaTracks();
        // 關閉 RTCPeerConnection
        this.removePeerConnections();
        // this.toastMessageService.info('通話已結束');
        // 刪除 calleeCandidates 集合中的文件
        await this.executeFirebaseCleanup();
        // 重置畫面元件
        this.initElements();
        // 刷新頁面
        this.reloadPage();
    }
    /** 顯示「加入視訊」對話框
     */
    showDialog() {
        this.show.isDialog = true;
    }
    /** 關閉「加入視訊」對話框
     */
    hideDialog() {
        this.show.isDialog = false;
    }
    /** 停止 localStream 和 remoteStream 中的所有媒體軌道
     */
    async stopMediaTracks() {
        this.localStream.getTracks().forEach((track) => {
            track.stop();
        });
        if (this.remoteStream) {
            this.remoteStream.getTracks().forEach((track) => track.stop());
        }
    }
    /** 關閉連線雙方(caller 跟 callee)的peerConnection
     */
    removePeerConnections() {
        if (this.CallerPeerConnection) {
            this.CallerPeerConnection.close();
        }
        if (this.CalleePeerConnection) {
            this.CalleePeerConnection.close();
        }
    }
    /** 清除firestore中的房間文件
     */
    async executeFirebaseCleanup() {
        if (this.roomId) {
            const roomDocRef = this.fireBaseService.getDocRef('rooms', this.roomId);
            const calleeCandidatesRef = this.fireBaseService.getSubCollectionRef(roomDocRef, 'calleeCandidates');
            calleeCandidatesRef.onSnapshot((snapshot) => {
                console.log(snapshot);
                snapshot.ref.delete();
            });
            const callerCandidatesRef = this.fireBaseService.getSubCollectionRef(roomDocRef, 'callerCandidates');
            callerCandidatesRef.onSnapshot((snapshot) => {
                snapshot.ref.delete();
            });
            await roomDocRef.delete();
        }
    }
    /** 重新載入頁面
     */
    reloadPage() {
        document.location.reload();
    }
    /** 初始化頁面元件，包含localStream、remoteStream、roomName
     * 將頁面初始化，包含localStream、remoteStream、roomName
     */
    initElements() {
        this.localStream = new MediaStream();
        this.remoteStream = new MediaStream();
    }
    /** 在建立RTCPeerConnection物件後，將localStream加入PeerConnection，以利後續傳送給另一端，另一端接收到後就可以顯示在remoteVideo上(display the local media data.)
     * 在localStream建立完後(也就是openUserMedia()執行完後)，才能執行下面這行。使用 getTracks() 方法獲取所有mediaTrack軌道，並將這些mediaTrack軌道添加到 RTCPeerConnection 中。
     * getTracks 獲取媒體流所有軌道並返回 array
     * addTracks 將新的音訊或視訊軌道添加到現有的媒體流中
     * @param PeerConnection：RTCPeerConnection
     */
    addLocalMediaTracks(PeerConnection) {
        this.localStream.getTracks().forEach((track) => {
            PeerConnection.addTrack(track, this.localStream);
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.1.0", ngImport: i0, type: FireVideoComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.1.0", type: FireVideoComponent, isStandalone: true, selector: "his-fire-video", inputs: { roomId: "roomId" }, providers: [MessageService], viewQueries: [{ propertyName: "remoteVideo", first: true, predicate: ["remoteVideo"], descendants: true }], ngImport: i0, template: "<!-- eslint-disable @angular-eslint/template/alt-text -->\n<div class=\"container\">\n  <div class=\"top\">\n    <div class=\"leftSide\">\n      <div *ngIf=\"!remoteStream\" class=\"material-symbols-outlined contactsIcon\">\n        {{contactsIcon}}\n      </div>\n      <div *ngIf=\"!remoteStream\" class=\"loading\">\n        <span>\u9023\u7DDA\u4E2D</span>\n        <span class=\"dot-1\">.</span>\n        <span class=\"dot-2\">.</span>\n        <span class=\"dot-3\">.</span>\n      </div>\n      <video *ngIf=\"remoteStream\" class=\"remoteVideo\" #remoteVideo id=\"remoteVideo\" [srcObject]=\"remoteStream\" autoplay\n        playsinline></video>\n    </div>\n\n    <div class=\"rightSide\">\n\n      <div class=\"localVideo\">\n        <video #localVideo id=\"localVideo\" [srcObject]=\"localStream\" muted autoplay playsinline></video>\n      </div>\n\n      <div class=\"galleria\">\n        <p-galleria [value]=\"this.screenshotService.imageUrlSubject.value\"\n          [responsiveOptions]=\"galleriaResponsiveOptions\" [containerStyle]=\"{ 'margin':'auto'}\" [numVisible]=\"3\"\n          [circular]=\"true\">\n\n          <ng-template pTemplate=\"item\" let-imagePath>\n            <ng-container *ngIf=\"imagePath !== ''; else emptyItem\">\n              <img class=\"item\" *ngIf=\"imagePath !== ''\" [src]=\"imagePath\" style=\"display: block;\" />\n            </ng-container>\n\n            <ng-template #emptyItem>\n              <div class=\"empty-galleria-item\">\n                <i class=\"pi pi-image\"></i>\n              </div>\n            </ng-template>\n          </ng-template>\n\n          <ng-template pTemplate=\"thumbnail\" let-imagePath>\n            <div class=\"grid justify-center\">\n              <ng-container *ngIf=\"imagePath !== ''; else emptyThumbnail\">\n                <img class=\"thumbnail\" *ngIf=\"imagePath !== ''\" [src]=\"imagePath\" style=\"display: block;\" />\n              </ng-container>\n              <ng-template #emptyThumbnail>\n                <div class=\"empty-galleria-thumbnail\">\n                  <i class=\"pi pi-image\"></i>\n                </div>\n              </ng-template>\n            </div>\n          </ng-template>\n\n        </p-galleria>\n\n      </div>\n    </div>\n\n  </div>\n  <div class=\"buttons\">\n    <button pButton pRipple class=\"cameraBtn\" id=\"cameraBtn\" (click)=\" disableCamera()\">\n      <span class=\"material-symbols-outlined\">\n        {{videoIcon}}\n      </span>\n    </button>\n\n    <button pButton pRipple class=\"micBtn\" id=\"micBtn\" (click)=\" disableMic()\">\n      <span class=\"material-symbols-outlined\">\n        {{micIcon}}\n      </span>\n    </button>\n\n    <button pButton pRipple class=\"joinBtn\" id=\"joinBtn\" (click)=\"onShootClick()\">\n      <span class=\"material-symbols-outlined\">\n        photo_camera\n      </span>\n    </button>\n\n  </div>\n\n  <div class=\"bottom\">\n    <div class=\"hangupBtn\">\n\n      <!-- \u63A5\u6536\u7AEF\u7528 -->\n      <!-- <button class=\"joinBtn\" id=\"joinBtn\" [disabled]=\"show.isJoinDisabled\" (click)=\"joinRoom()\">\n        <i class=\"pi pi-user-plus\" aria-hidden=\"true\"></i>\n      </button> -->\n\n\n      <button pButton pRipple id=\"hangupBtn\" class=\"p-button-raised p-button-warning\" label=\"\u7D50\u675F\u901A\u8A71\"\n        [disabled]=\"show.isHangupDisabled\" (click)=\"hangUp()\">\n      </button>\n\n    </div>\n\n    <!-- \u63A5\u6536\u7AEF\u7528 -->\n    <!-- <p-dialog header=\"Join room\" [(visible)]=\"show.isDialog\" [modal]=\"true\" [responsive]=\"true\">\n      <div class=\"p-fluid\">\n        <div class=\"p-field\">\n          <label for=\"room-id\">Room ID</label>\n          <input id=\"room-id\" type=\"text\" pInputText [(ngModel)]=\"inputRoomId\">\n        </div>\n      </div>\n      <div class=\"p-dialog-footer\">\n        <pbutton type=\"button\" pButton [label]=\"'\u53D6\u6D88' | translate\" (click)=\"hideDialog()\"></pbutton>\n        <pbutton type=\"button\" pButton [label]=\"'\u52A0\u5165' | translate\" (click)=\"confirmJoinRoom()\" class=\"p-button-primary\">\n        </pbutton>\n      </div>\n    </p-dialog> -->\n\n  </div>\n</div>\n", styles: [":host{width:100%;height:100%;display:block}.container{width:100%;max-width:100vw;padding:.1875rem;height:auto;display:flex;flex-direction:column}.container .top{display:flex;width:100%;height:100%;max-height:700px;justify-content:center}.container .top .leftSide{width:70%;margin:.1rem .5rem;border:3px solid var(--outline-variant, #B5BFBB);display:flex;flex-direction:column;justify-content:center;align-items:center}.container .top .leftSide .loading{display:flex;align-items:center;color:var(--surface-on-surface, #1C1D1C);font-family:Noto Sans TC;font-size:28px;font-style:normal;font-weight:700;line-height:40px;letter-spacing:1.12px}.container .top .leftSide .loading span{animation:loadingDots 1s infinite;opacity:0;animation-delay:0s,.25s,.5s}.container .top .leftSide .loading .dot-1{animation-delay:0s}.container .top .leftSide .loading .dot-2{animation-delay:.25s}.container .top .leftSide .loading .dot-3{animation-delay:.5s}@keyframes loadingDots{0%{opacity:0}20%{opacity:1}to{opacity:0}}.container .top .leftSide .contactsIcon{color:var(--primary-main, #006D50);font-size:3rem}.container .top .leftSide video{width:100%;height:100%;max-height:648.75px;object-fit:cover}.container .top .rightSide{width:30%;height:100%;display:flex;flex-direction:column}.container .top .rightSide video{width:100%;border-radius:var(--border-radius-none, 0px);border:3px solid var(--outline-variant, #B5BFBB);object-fit:cover}.container .top .rightSide .localVideo{width:100%;height:50%}.container .buttons{display:flex;padding:var(--spacing-xs, 0px);justify-content:center;align-items:flex-start;gap:var(--spacing-xxl, 2rem);border-radius:var(--border-radius-none, 0px);align-self:stretch}.container .buttons ::ng-deep .p-divider.p-divider-vertical{width:1px;border-radius:var(--border-radius-none, 0px);background:var(--outline-variant, #B5BFBB)}.container .buttons ::ng-deep .p-button:enabled:hover{color:var(--primary-container);border-color:transparent}.container .buttons ::ng-deep .p-button{color:var(--surface-on-surface, #1C1D1C);background:var(--primary-main);border:0 none;font-size:1rem;transition:background-color .2s,border-color .2s,color .2s,box-shadow .2s,background-size .2s cubic-bezier(.64,.09,.08,1);border-radius:6px;min-width:unset;padding:unset}.container .buttons button{width:3rem;height:3rem;padding:var(--spacing-xs, 4px);background:none;border-style:none}.bottom{display:flex;justify-content:flex-end;height:30%;padding:var(--spacing-xs, 4px) var(--spacing-md, 12px);border-radius:var(--border-radius-none, 0px) var(--border-radius-none, 0px) var(--border-radius-button, 6px) var(--border-radius-button, 6px);border-top:1px solid var(--outline-variant, #B5BFBB)}::ng-deep .grid{display:flex;flex-wrap:wrap;margin-right:unset;margin-left:unset;margin-top:unset}::ng-deep .galleria{width:100%;height:50%;display:flex;flex-direction:column}::ng-deep .galleria .p-galleria-item-wrapper{position:relative;border-radius:var(--border-radius-none, 0px);background:var(--surface-ground, #F6F6F6);height:50%}::ng-deep .galleria .p-galleria-item-wrapper .p-galleria-item{height:100%;width:100%;border-radius:var(--border-radius-none, 0px);background:var(--surface-ground, #F6F6F6);display:flex;padding:var(--spacing-none, 0px);flex-direction:column;justify-content:center;align-items:center;gap:10px;align-self:stretch;aspect-ratio:456/266}::ng-deep .galleria .p-galleria-item-wrapper .p-galleria-item .pi{font-size:2rem}::ng-deep .galleria .p-galleria-item-wrapper .p-galleria-item .item{width:100%;max-width:456px;max-height:266px;height:auto;margin-left:auto;margin-right:auto;aspect-ratio:456/266}::ng-deep .galleria .p-galleria-thumbnail-wrapper{height:50%;border-radius:var(--border-radius-none, 0px);background:var(--surface-section, #ECEDED)}::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container{border-radius:var(--border-radius-none, 0px);background:var(--surface-section, #ECEDED);display:flex;padding:var(--spacing-none, 0px);justify-content:space-between;align-items:center;align-content:center;row-gap:.25rem;align-self:stretch;aspect-ratio:456/80}::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container .p-galleria-thumbnail-prev,::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container .p-galleria-thumbnail-next{margin:0 .5rem;background-color:transparent;color:#ffffffde;width:2rem;height:2rem;transition:background-color .2s,color .2s,box-shadow .2s;border-radius:50%}::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container .thumbnail{width:100%;max-width:80px;height:auto;margin-left:auto;margin-right:auto;aspect-ratio:1/1}::ng-deep .galleria .p-icon-wrapper{color:var(--surface-on-surface)}\n"], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "ngmodule", type: DialogModule }, { kind: "directive", type: i2.PrimeTemplate, selector: "[pTemplate]", inputs: ["type", "pTemplate"] }, { kind: "ngmodule", type: FormsModule }, { kind: "ngmodule", type: TranslateModule }, { kind: "ngmodule", type: DividerModule }, { kind: "ngmodule", type: ButtonModule }, { kind: "directive", type: i3.ButtonDirective, selector: "[pButton]", inputs: ["iconPos", "loadingIcon", "label", "icon", "loading"] }, { kind: "ngmodule", type: ToastModule }, { kind: "ngmodule", type: MessagesModule }, { kind: "ngmodule", type: GalleriaModule }, { kind: "component", type: i4.Galleria, selector: "p-galleria", inputs: ["activeIndex", "fullScreen", "id", "value", "numVisible", "responsiveOptions", "showItemNavigators", "showThumbnailNavigators", "showItemNavigatorsOnHover", "changeItemOnIndicatorHover", "circular", "autoPlay", "shouldStopAutoplayByClick", "transitionInterval", "showThumbnails", "thumbnailsPosition", "verticalThumbnailViewPortHeight", "showIndicators", "showIndicatorsOnItem", "indicatorsPosition", "baseZIndex", "maskClass", "containerClass", "containerStyle", "showTransitionOptions", "hideTransitionOptions", "visible"], outputs: ["activeIndexChange", "visibleChange"] }, { kind: "ngmodule", type: ProgressSpinnerModule }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.1.0", ngImport: i0, type: FireVideoComponent, decorators: [{
            type: Component,
            args: [{ selector: 'his-fire-video', standalone: true, imports: [CommonModule, DialogModule, FormsModule, TranslateModule, primeModule], providers: [MessageService], template: "<!-- eslint-disable @angular-eslint/template/alt-text -->\n<div class=\"container\">\n  <div class=\"top\">\n    <div class=\"leftSide\">\n      <div *ngIf=\"!remoteStream\" class=\"material-symbols-outlined contactsIcon\">\n        {{contactsIcon}}\n      </div>\n      <div *ngIf=\"!remoteStream\" class=\"loading\">\n        <span>\u9023\u7DDA\u4E2D</span>\n        <span class=\"dot-1\">.</span>\n        <span class=\"dot-2\">.</span>\n        <span class=\"dot-3\">.</span>\n      </div>\n      <video *ngIf=\"remoteStream\" class=\"remoteVideo\" #remoteVideo id=\"remoteVideo\" [srcObject]=\"remoteStream\" autoplay\n        playsinline></video>\n    </div>\n\n    <div class=\"rightSide\">\n\n      <div class=\"localVideo\">\n        <video #localVideo id=\"localVideo\" [srcObject]=\"localStream\" muted autoplay playsinline></video>\n      </div>\n\n      <div class=\"galleria\">\n        <p-galleria [value]=\"this.screenshotService.imageUrlSubject.value\"\n          [responsiveOptions]=\"galleriaResponsiveOptions\" [containerStyle]=\"{ 'margin':'auto'}\" [numVisible]=\"3\"\n          [circular]=\"true\">\n\n          <ng-template pTemplate=\"item\" let-imagePath>\n            <ng-container *ngIf=\"imagePath !== ''; else emptyItem\">\n              <img class=\"item\" *ngIf=\"imagePath !== ''\" [src]=\"imagePath\" style=\"display: block;\" />\n            </ng-container>\n\n            <ng-template #emptyItem>\n              <div class=\"empty-galleria-item\">\n                <i class=\"pi pi-image\"></i>\n              </div>\n            </ng-template>\n          </ng-template>\n\n          <ng-template pTemplate=\"thumbnail\" let-imagePath>\n            <div class=\"grid justify-center\">\n              <ng-container *ngIf=\"imagePath !== ''; else emptyThumbnail\">\n                <img class=\"thumbnail\" *ngIf=\"imagePath !== ''\" [src]=\"imagePath\" style=\"display: block;\" />\n              </ng-container>\n              <ng-template #emptyThumbnail>\n                <div class=\"empty-galleria-thumbnail\">\n                  <i class=\"pi pi-image\"></i>\n                </div>\n              </ng-template>\n            </div>\n          </ng-template>\n\n        </p-galleria>\n\n      </div>\n    </div>\n\n  </div>\n  <div class=\"buttons\">\n    <button pButton pRipple class=\"cameraBtn\" id=\"cameraBtn\" (click)=\" disableCamera()\">\n      <span class=\"material-symbols-outlined\">\n        {{videoIcon}}\n      </span>\n    </button>\n\n    <button pButton pRipple class=\"micBtn\" id=\"micBtn\" (click)=\" disableMic()\">\n      <span class=\"material-symbols-outlined\">\n        {{micIcon}}\n      </span>\n    </button>\n\n    <button pButton pRipple class=\"joinBtn\" id=\"joinBtn\" (click)=\"onShootClick()\">\n      <span class=\"material-symbols-outlined\">\n        photo_camera\n      </span>\n    </button>\n\n  </div>\n\n  <div class=\"bottom\">\n    <div class=\"hangupBtn\">\n\n      <!-- \u63A5\u6536\u7AEF\u7528 -->\n      <!-- <button class=\"joinBtn\" id=\"joinBtn\" [disabled]=\"show.isJoinDisabled\" (click)=\"joinRoom()\">\n        <i class=\"pi pi-user-plus\" aria-hidden=\"true\"></i>\n      </button> -->\n\n\n      <button pButton pRipple id=\"hangupBtn\" class=\"p-button-raised p-button-warning\" label=\"\u7D50\u675F\u901A\u8A71\"\n        [disabled]=\"show.isHangupDisabled\" (click)=\"hangUp()\">\n      </button>\n\n    </div>\n\n    <!-- \u63A5\u6536\u7AEF\u7528 -->\n    <!-- <p-dialog header=\"Join room\" [(visible)]=\"show.isDialog\" [modal]=\"true\" [responsive]=\"true\">\n      <div class=\"p-fluid\">\n        <div class=\"p-field\">\n          <label for=\"room-id\">Room ID</label>\n          <input id=\"room-id\" type=\"text\" pInputText [(ngModel)]=\"inputRoomId\">\n        </div>\n      </div>\n      <div class=\"p-dialog-footer\">\n        <pbutton type=\"button\" pButton [label]=\"'\u53D6\u6D88' | translate\" (click)=\"hideDialog()\"></pbutton>\n        <pbutton type=\"button\" pButton [label]=\"'\u52A0\u5165' | translate\" (click)=\"confirmJoinRoom()\" class=\"p-button-primary\">\n        </pbutton>\n      </div>\n    </p-dialog> -->\n\n  </div>\n</div>\n", styles: [":host{width:100%;height:100%;display:block}.container{width:100%;max-width:100vw;padding:.1875rem;height:auto;display:flex;flex-direction:column}.container .top{display:flex;width:100%;height:100%;max-height:700px;justify-content:center}.container .top .leftSide{width:70%;margin:.1rem .5rem;border:3px solid var(--outline-variant, #B5BFBB);display:flex;flex-direction:column;justify-content:center;align-items:center}.container .top .leftSide .loading{display:flex;align-items:center;color:var(--surface-on-surface, #1C1D1C);font-family:Noto Sans TC;font-size:28px;font-style:normal;font-weight:700;line-height:40px;letter-spacing:1.12px}.container .top .leftSide .loading span{animation:loadingDots 1s infinite;opacity:0;animation-delay:0s,.25s,.5s}.container .top .leftSide .loading .dot-1{animation-delay:0s}.container .top .leftSide .loading .dot-2{animation-delay:.25s}.container .top .leftSide .loading .dot-3{animation-delay:.5s}@keyframes loadingDots{0%{opacity:0}20%{opacity:1}to{opacity:0}}.container .top .leftSide .contactsIcon{color:var(--primary-main, #006D50);font-size:3rem}.container .top .leftSide video{width:100%;height:100%;max-height:648.75px;object-fit:cover}.container .top .rightSide{width:30%;height:100%;display:flex;flex-direction:column}.container .top .rightSide video{width:100%;border-radius:var(--border-radius-none, 0px);border:3px solid var(--outline-variant, #B5BFBB);object-fit:cover}.container .top .rightSide .localVideo{width:100%;height:50%}.container .buttons{display:flex;padding:var(--spacing-xs, 0px);justify-content:center;align-items:flex-start;gap:var(--spacing-xxl, 2rem);border-radius:var(--border-radius-none, 0px);align-self:stretch}.container .buttons ::ng-deep .p-divider.p-divider-vertical{width:1px;border-radius:var(--border-radius-none, 0px);background:var(--outline-variant, #B5BFBB)}.container .buttons ::ng-deep .p-button:enabled:hover{color:var(--primary-container);border-color:transparent}.container .buttons ::ng-deep .p-button{color:var(--surface-on-surface, #1C1D1C);background:var(--primary-main);border:0 none;font-size:1rem;transition:background-color .2s,border-color .2s,color .2s,box-shadow .2s,background-size .2s cubic-bezier(.64,.09,.08,1);border-radius:6px;min-width:unset;padding:unset}.container .buttons button{width:3rem;height:3rem;padding:var(--spacing-xs, 4px);background:none;border-style:none}.bottom{display:flex;justify-content:flex-end;height:30%;padding:var(--spacing-xs, 4px) var(--spacing-md, 12px);border-radius:var(--border-radius-none, 0px) var(--border-radius-none, 0px) var(--border-radius-button, 6px) var(--border-radius-button, 6px);border-top:1px solid var(--outline-variant, #B5BFBB)}::ng-deep .grid{display:flex;flex-wrap:wrap;margin-right:unset;margin-left:unset;margin-top:unset}::ng-deep .galleria{width:100%;height:50%;display:flex;flex-direction:column}::ng-deep .galleria .p-galleria-item-wrapper{position:relative;border-radius:var(--border-radius-none, 0px);background:var(--surface-ground, #F6F6F6);height:50%}::ng-deep .galleria .p-galleria-item-wrapper .p-galleria-item{height:100%;width:100%;border-radius:var(--border-radius-none, 0px);background:var(--surface-ground, #F6F6F6);display:flex;padding:var(--spacing-none, 0px);flex-direction:column;justify-content:center;align-items:center;gap:10px;align-self:stretch;aspect-ratio:456/266}::ng-deep .galleria .p-galleria-item-wrapper .p-galleria-item .pi{font-size:2rem}::ng-deep .galleria .p-galleria-item-wrapper .p-galleria-item .item{width:100%;max-width:456px;max-height:266px;height:auto;margin-left:auto;margin-right:auto;aspect-ratio:456/266}::ng-deep .galleria .p-galleria-thumbnail-wrapper{height:50%;border-radius:var(--border-radius-none, 0px);background:var(--surface-section, #ECEDED)}::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container{border-radius:var(--border-radius-none, 0px);background:var(--surface-section, #ECEDED);display:flex;padding:var(--spacing-none, 0px);justify-content:space-between;align-items:center;align-content:center;row-gap:.25rem;align-self:stretch;aspect-ratio:456/80}::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container .p-galleria-thumbnail-prev,::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container .p-galleria-thumbnail-next{margin:0 .5rem;background-color:transparent;color:#ffffffde;width:2rem;height:2rem;transition:background-color .2s,color .2s,box-shadow .2s;border-radius:50%}::ng-deep .galleria .p-galleria-thumbnail-wrapper .p-galleria-thumbnail-container .thumbnail{width:100%;max-width:80px;height:auto;margin-left:auto;margin-right:auto;aspect-ratio:1/1}::ng-deep .galleria .p-icon-wrapper{color:var(--surface-on-surface)}\n"] }]
        }], propDecorators: { roomId: [{
                type: Input
            }], remoteVideo: [{
                type: ViewChild,
                args: ['remoteVideo']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlyZS12aWRlby5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9maXJlLXZpZGVvL3NyYy9saWIvZmlyZS12aWRlby5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9maXJlLXZpZGVvL3NyYy9saWIvZmlyZS12aWRlby5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx1REFBdUQ7QUFDdkQsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDOUIsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFjLEtBQUssR0FBVyxNQUFNLGVBQWUsQ0FBQztBQUN6RixPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDL0MsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzlDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM5QyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDN0MsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1QyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN6RCxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUN6RCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDckQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRS9DLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxhQUFhLENBQUM7QUFDN0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUVsRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDaEQsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0seUJBQXlCLENBQUM7Ozs7OztBQUNoRSxNQUFNLFdBQVcsR0FBRyxDQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFLHFCQUFxQixDQUFDLENBQUM7QUFTcEksTUFBTSxPQUFPLGtCQUFrQjtJQVIvQjtRQXNCRSxjQUFTLEdBQUcsVUFBVSxDQUFDO1FBQ3ZCLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFDaEIsaUJBQVksR0FBRyxVQUFVLENBQUE7UUFPekIsNEJBQTRCO1FBQzVCLDhCQUF5QixHQUFVO1lBQ2pDO2dCQUNFLFVBQVUsRUFBRSxRQUFRO2dCQUNwQixVQUFVLEVBQUUsQ0FBQzthQUNkO1lBQ0Q7Z0JBQ0UsVUFBVSxFQUFFLE9BQU87Z0JBQ25CLFVBQVUsRUFBRSxDQUFDO2FBQ2Q7WUFDRDtnQkFDRSxVQUFVLEVBQUUsT0FBTztnQkFDbkIsVUFBVSxFQUFFLENBQUM7YUFDZDtZQUNEO2dCQUNFLFVBQVUsRUFBRSxPQUFPO2dCQUNuQixVQUFVLEVBQUUsQ0FBQzthQUNkO1NBQ0YsQ0FBQztRQUVGLFNBQUksR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBRWxCLG9CQUFlLEdBQW9CLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUMzRCx3QkFBbUIsR0FBd0IsTUFBTSxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFDdkUsc0JBQWlCLEdBQXNCLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQ2pFLDBCQUFxQixHQUFzQixNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUNyRSxpQkFBWSxHQUFpQixNQUFNLENBQUMsWUFBWSxDQUFDLENBQUM7S0ErUG5EO0lBN1JDLFFBQVE7UUFDTixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQThCRDtPQUNHO0lBQ0gsWUFBWTtRQUNWLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDbkUsQ0FBQztJQUVEO09BQ0c7SUFDSCxhQUFhO1FBQ1gsd0RBQXdEO1FBQ3hELElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDO1FBQ3pELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUM7UUFFMUUsSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDbEksQ0FBQztJQUVEO09BQ0c7SUFDSCxVQUFVO1FBQ1IscURBQXFEO1FBQ3JELElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUM7UUFDbkQsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7UUFFM0QsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzNILENBQUM7SUFFRDs7Ozs7Ozs7O09BU0c7SUFDSCxLQUFLLENBQUMsVUFBVTtRQUNkLGlDQUFpQztRQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3RCLGtEQUFrRDtZQUNsRCxPQUFPO1FBQ1QsQ0FBQztRQUVELHFFQUFxRTtRQUNyRSxJQUFJLENBQUMsZUFBZSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUU1Qyw2QkFBNkI7UUFDN0IsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUV2RSw4R0FBOEc7UUFDOUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLG9CQUFvQixFQUFFLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFFOUgsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFekIseUlBQXlJO1FBQ3pJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUVwRCw0Q0FBNEM7UUFDNUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7SUFFckcsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsUUFBUTtRQUNOLGlDQUFpQztRQUNqQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3RCLGtEQUFrRDtZQUNsRCxPQUFPO1FBQ1QsQ0FBQztRQUVELHdEQUF3RDtRQUN4RCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsS0FBSyxDQUFDLGVBQWU7UUFFbkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTTtRQUV0QyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUVEOzs7Ozs7Ozs7T0FTRztJQUNILEtBQUssQ0FBQyxZQUFZLENBQUMsV0FBbUI7UUFDcEMsK0NBQStDO1FBQy9DLE1BQU0sVUFBVSxHQUNkLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxHQUFHLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFFNUQsaUVBQWlFO1FBQ2pFLE1BQU0sWUFBWSxHQUFRLE1BQU0sSUFBSSxDQUFDLGVBQWUsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFN0UsSUFBSSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUN6QiwyQ0FBMkM7WUFDM0MsT0FBTztRQUNULENBQUM7UUFFRCxnQkFBZ0I7YUFDWCxDQUFDO1lBQ0osOEJBQThCO1lBQzlCLElBQUksQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsYUFBYSxFQUFFLENBQUM7WUFFdkUsK0dBQStHO1lBQy9HLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxvQkFBb0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLG9CQUFvQixFQUFFLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLENBQUM7WUFFOUgseUlBQXlJO1lBQ3pJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUVwRCwyR0FBMkc7WUFDM0csSUFBSSxDQUFDLHFCQUFxQixDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUV0RyxDQUFDO0lBQ0gsQ0FBQztJQUVEO09BQ0c7SUFDSCxLQUFLLENBQUMsYUFBYTtRQUNqQixNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLENBQUM7UUFFdEQsSUFBSSxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUM7UUFDMUIsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO1FBRXRDLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUNwQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLE1BQU07UUFDVixvQkFBb0I7UUFDcEIsTUFBTSxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7UUFFN0IsdUJBQXVCO1FBQ3ZCLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1FBRTdCLDBDQUEwQztRQUUxQyw2QkFBNkI7UUFDN0IsTUFBTSxJQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUVwQyxTQUFTO1FBQ1QsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBRXBCLE9BQU87UUFDUCxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUVEO09BQ0c7SUFDSCxVQUFVO1FBQ1IsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO0lBQzVCLENBQUM7SUFFRDtPQUNHO0lBQ0gsVUFBVTtRQUNSLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztJQUM3QixDQUFDO0lBRUQ7T0FDRztJQUNILEtBQUssQ0FBQyxlQUFlO1FBQ25CLElBQUksQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDN0MsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ2YsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztZQUN0QixJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFDakUsQ0FBQztJQUNILENBQUM7SUFFRDtPQUNHO0lBQ0gscUJBQXFCO1FBQ25CLElBQUksSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7WUFDOUIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3BDLENBQUM7UUFFRCxJQUFJLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO1lBQzlCLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNwQyxDQUFDO0lBQ0gsQ0FBQztJQUVEO09BQ0c7SUFDSCxLQUFLLENBQUMsc0JBQXNCO1FBQzFCLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ2hCLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFFeEUsTUFBTSxtQkFBbUIsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLFVBQVUsRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3JHLG1CQUFtQixDQUFDLFVBQVUsQ0FBQyxDQUFDLFFBQWEsRUFBRSxFQUFFO2dCQUMvQyxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUV0QixRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ3hCLENBQUMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxtQkFBbUIsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLFVBQVUsRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3JHLG1CQUFtQixDQUFDLFVBQVUsQ0FBQyxDQUFDLFFBQWEsRUFBRSxFQUFFO2dCQUMvQyxRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDO1lBQ3hCLENBQUMsQ0FBQyxDQUFDO1lBRUgsTUFBTSxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDNUIsQ0FBQztJQUNILENBQUM7SUFDRDtPQUNHO0lBQ0gsVUFBVTtRQUNSLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDN0IsQ0FBQztJQUVEOztPQUVHO0lBQ0gsWUFBWTtRQUNWLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxXQUFXLEVBQUUsQ0FBQztRQUVyQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksV0FBVyxFQUFFLENBQUM7SUFDeEMsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0gsbUJBQW1CLENBQUMsY0FBaUM7UUFDbkQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUU3QyxjQUFjLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFbkQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDOzhHQTlTVSxrQkFBa0I7a0dBQWxCLGtCQUFrQiwyRkFGbEIsQ0FBQyxjQUFjLENBQUMsc0lDNUI3Qiwya0lBZ0hBLHNySkR2RlksWUFBWSxrSUFBRSxZQUFZLHFJQUFFLFdBQVcsOEJBQUUsZUFBZSw4QkFKL0MsYUFBYSw4QkFBRSxZQUFZLHNLQUFnQixXQUFXLDhCQUFFLGNBQWMsOEJBQUUsY0FBYyx3cUJBQUUscUJBQXFCOzsyRkFTckgsa0JBQWtCO2tCQVI5QixTQUFTOytCQUNFLGdCQUFnQixjQUNkLElBQUksV0FDUCxDQUFDLFlBQVksRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLGVBQWUsRUFBRSxXQUFXLENBQUMsYUFHckUsQ0FBQyxjQUFjLENBQUM7OEJBT2xCLE1BQU07c0JBQWQsS0FBSztnQkFFb0IsV0FBVztzQkFBcEMsU0FBUzt1QkFBQyxhQUFhIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSAqL1xuaW1wb3J0IHsgTWVzc2FnZXNNb2R1bGUgfSBmcm9tICdwcmltZW5nL21lc3NhZ2VzJztcbmltcG9ydCB7IFNob3cgfSBmcm9tICcuL3Nob3cnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBWaWV3Q2hpbGQsIGluamVjdCwgRWxlbWVudFJlZiwgSW5wdXQsIE9uSW5pdCwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBCdXR0b25Nb2R1bGUgfSBmcm9tICdwcmltZW5nL2J1dHRvbic7XG5pbXBvcnQgeyBEaWFsb2dNb2R1bGUgfSBmcm9tICdwcmltZW5nL2RpYWxvZyc7XG5pbXBvcnQgeyBGb3Jtc01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IFRvYXN0TW9kdWxlIH0gZnJvbSAncHJpbWVuZy90b2FzdCc7XG5pbXBvcnQgeyBTY3JlZW5zaG90U2VydmljZSB9IGZyb20gJy4vc2NyZWVuc2hvdC5zZXJ2aWNlJztcbmltcG9ydCB7IEljZUNhbmRpZGF0ZVNlcnZpY2UgfSBmcm9tICcuL2ljZS1jYW5kaWRhdGUuc2VydmljZSc7XG5pbXBvcnQgeyBDb25uZWN0aW9uU2VydmljZSB9IGZyb20gJy4vY29ubmVjdGlvbi5zZXJ2aWNlJztcbmltcG9ydCB7IEZpcmViYXNlU2VydmljZSB9IGZyb20gJy4vZmlyZWJhc2Uuc2VydmljZSc7XG5pbXBvcnQgeyBNZWRpYVNlcnZpY2UgfSBmcm9tICcuL21lZGlhLnNlcnZpY2UnO1xuaW1wb3J0IHsgRG9jdW1lbnRSZWZlcmVuY2UgfSBmcm9tICdAYW5ndWxhci9maXJlL2NvbXBhdC9maXJlc3RvcmUnO1xuaW1wb3J0IHsgTWVzc2FnZVNlcnZpY2UgfSBmcm9tICdwcmltZW5nL2FwaSc7XG5pbXBvcnQgeyBUcmFuc2xhdGVNb2R1bGUgfSBmcm9tICdAbmd4LXRyYW5zbGF0ZS9jb3JlJztcbmltcG9ydCB7IEdhbGxlcmlhTW9kdWxlIH0gZnJvbSAncHJpbWVuZy9nYWxsZXJpYSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBEaXZpZGVyTW9kdWxlIH0gZnJvbSAncHJpbWVuZy9kaXZpZGVyJztcbmltcG9ydCB7IFByb2dyZXNzU3Bpbm5lck1vZHVsZSB9IGZyb20gJ3ByaW1lbmcvcHJvZ3Jlc3NzcGlubmVyJztcbmNvbnN0IHByaW1lTW9kdWxlID0gW0RpdmlkZXJNb2R1bGUsIEJ1dHRvbk1vZHVsZSwgRGlhbG9nTW9kdWxlLCBUb2FzdE1vZHVsZSwgTWVzc2FnZXNNb2R1bGUsIEdhbGxlcmlhTW9kdWxlLCBQcm9ncmVzc1NwaW5uZXJNb2R1bGVdO1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnaGlzLWZpcmUtdmlkZW8nLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBEaWFsb2dNb2R1bGUsIEZvcm1zTW9kdWxlLCBUcmFuc2xhdGVNb2R1bGUsIHByaW1lTW9kdWxlXSxcbiAgdGVtcGxhdGVVcmw6ICcuL2ZpcmUtdmlkZW8uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9maXJlLXZpZGVvLmNvbXBvbmVudC5zY3NzJ10sXG4gIHByb3ZpZGVyczogW01lc3NhZ2VTZXJ2aWNlXVxufSlcbmV4cG9ydCBjbGFzcyBGaXJlVmlkZW9Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuXG4gIC8qKiDlj5blvpfmrLLlibXlu7rmiL/plpPnmoTomZ/norzvvIjpoJDoqK3mh4noqbLopoHmmK/nl4XkurrouqvliIborYnlrZfomZ/vvIlcbiAgICog5L2/55So5q2k5bCI5qGI55qE56iL5byP6ZyA5YKz6YCB5qyy5Ym15bu65oi/6ZaT55qE6Jmf56K86Iez5q2k77yM5Lul5L6/5L2/55So6Kmy6Jmf56K85bu656uL5oi/6ZaTXG4gICAqL1xuICBASW5wdXQoKSByb29tSWQhOiBzdHJpbmc7XG5cbiAgQFZpZXdDaGlsZCgncmVtb3RlVmlkZW8nKSByZW1vdGVWaWRlbyE6IEVsZW1lbnRSZWY8SFRNTFZpZGVvRWxlbWVudD47XG5cbiAgbG9jYWxTdHJlYW0hOiBNZWRpYVN0cmVhbTtcbiAgcmVtb3RlU3RyZWFtITogTWVkaWFTdHJlYW07XG4gIENhbGxlclBlZXJDb25uZWN0aW9uITogUlRDUGVlckNvbm5lY3Rpb247XG4gIENhbGxlZVBlZXJDb25uZWN0aW9uITogUlRDUGVlckNvbm5lY3Rpb247XG4gIGlucHV0Um9vbUlkITogc3RyaW5nO1xuICB2aWRlb0ljb24gPSAndmlkZW9DYW0nO1xuICBtaWNJY29uID0gXCJNaWNcIjtcbiAgY29udGFjdHNJY29uID0gXCJDb250YWN0c1wiXG4gIGltYWdlVVJJcyE6IE9ic2VydmFibGU8c3RyaW5nW10gfCBhbnk+O1xuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMub3BlblVzZXJNZWRpYSgpO1xuICB9XG5cbiAgLy8g5a6a576p5Zyo5LiN5ZCM6J6i5bmV5aSn5bCP5oiW6Kit5YKZ5LiK6aGv56S65ZyW54mH6Lyq5pKt5pmC55qE6YWN572u6YG46aCFXG4gIGdhbGxlcmlhUmVzcG9uc2l2ZU9wdGlvbnM6IGFueVtdID0gW1xuICAgIHtcbiAgICAgIGJyZWFrcG9pbnQ6ICcxMDI0cHgnLFxuICAgICAgbnVtVmlzaWJsZTogNVxuICAgIH0sXG4gICAge1xuICAgICAgYnJlYWtwb2ludDogJzk2MHB4JyxcbiAgICAgIG51bVZpc2libGU6IDRcbiAgICB9LFxuICAgIHtcbiAgICAgIGJyZWFrcG9pbnQ6ICc3NjhweCcsXG4gICAgICBudW1WaXNpYmxlOiAzXG4gICAgfSxcbiAgICB7XG4gICAgICBicmVha3BvaW50OiAnNTYwcHgnLFxuICAgICAgbnVtVmlzaWJsZTogMVxuICAgIH1cbiAgXTtcblxuICBzaG93ID0gbmV3IFNob3coKTtcblxuICBmaXJlQmFzZVNlcnZpY2U6IEZpcmViYXNlU2VydmljZSA9IGluamVjdChGaXJlYmFzZVNlcnZpY2UpO1xuICBpY2VDYW5kaWRhdGVTZXJ2aWNlOiBJY2VDYW5kaWRhdGVTZXJ2aWNlID0gaW5qZWN0KEljZUNhbmRpZGF0ZVNlcnZpY2UpO1xuICBzY3JlZW5zaG90U2VydmljZTogU2NyZWVuc2hvdFNlcnZpY2UgPSBpbmplY3QoU2NyZWVuc2hvdFNlcnZpY2UpO1xuICBwZWVyQ29ubmVjdGlvblNlcnZpY2U6IENvbm5lY3Rpb25TZXJ2aWNlID0gaW5qZWN0KENvbm5lY3Rpb25TZXJ2aWNlKTtcbiAgbWVkaWFTZXJ2aWNlOiBNZWRpYVNlcnZpY2UgPSBpbmplY3QoTWVkaWFTZXJ2aWNlKTtcblxuICAvKiog55uj6IG95oiq5ZyW5oyJ6YiV77yM55W25q2k5oyJ6YiV6KKr6bue5pOK5pmC77yM5ZG85Y+rIHNjcmVlbnNob3QoKe+8jOWwh+WwjeaWueimluioiueVq+mdouaIquWclu+8jOS4puS4iuWCs+iHsyBDRE5cbiAgICovXG4gIG9uU2hvb3RDbGljaygpIHtcbiAgICB0aGlzLnNjcmVlbnNob3RTZXJ2aWNlLnNjcmVlbnNob3QodGhpcy5yb29tSWQsIHRoaXMucmVtb3RlVmlkZW8pO1xuICB9XG5cbiAgLyoqIOWIh+aPm+OAjOmPoemgreOAjemWi+mXnFxuICAgKi9cbiAgZGlzYWJsZUNhbWVyYSgpIHtcbiAgICAvLyDkvp3nhadpc0NhbWVyYURpc2FibGVkIOeahCB0cnVlL2ZhbHNlIO+8jCDkvobliIfmj5tpY29uIOeahCBvbi9vZmYg54uA5oWLXG4gICAgdGhpcy5zaG93LmlzQ2FtZXJhRGlzYWJsZWQgPSAhdGhpcy5zaG93LmlzQ2FtZXJhRGlzYWJsZWQ7XG4gICAgdGhpcy52aWRlb0ljb24gPSB0aGlzLnNob3cuaXNDYW1lcmFEaXNhYmxlZCA/ICd2aWRlb2NhbV9vZmYnIDogJ3ZpZGVvY2FtJztcblxuICAgIHRoaXMuc2hvdy5pc0NhbWVyYURpc2FibGVkID8gdGhpcy5tZWRpYVNlcnZpY2UuZGlzYWJsZVZpZGVvKHRoaXMubG9jYWxTdHJlYW0pIDogdGhpcy5tZWRpYVNlcnZpY2UuZW5hYmxlVmlkZW8odGhpcy5sb2NhbFN0cmVhbSk7XG4gIH1cblxuICAvKiog5YiH5o+b44CM6bql5YWL6aKo44CN6ZaL6ZecXG4gICAqL1xuICBkaXNhYmxlTWljKCkge1xuICAgIC8vIOS+neeFp2lzTWljRGlzYWJsZWQg55qEIHRydWUvZmFsc2Ug77yMIOS+huWIh+aPm2ljb24g55qEIG9uL29mZiDni4DmhYtcbiAgICB0aGlzLnNob3cuaXNNaWNEaXNhYmxlZCA9ICF0aGlzLnNob3cuaXNNaWNEaXNhYmxlZDtcbiAgICB0aGlzLm1pY0ljb24gPSB0aGlzLnNob3cuaXNNaWNEaXNhYmxlZCA/ICdtaWNfb2ZmJyA6ICdNaWMnO1xuXG4gICAgdGhpcy5zaG93LmlzTWljRGlzYWJsZWQgPyB0aGlzLm1lZGlhU2VydmljZS5kaXNhYmxlTWljKHRoaXMubG9jYWxTdHJlYW0pIDogdGhpcy5tZWRpYVNlcnZpY2UuZW5hYmxlTWljKHRoaXMubG9jYWxTdHJlYW0pO1xuICB9XG5cbiAgLyoqIOWJteW7uuaIv+mWk1xuICAgKiDlnKhmaXJlYmFzZeS4reWJteW7uuS4gOWAi+aIv+mWk++8jOatpOaIv+mWk+S7peaIv+mWk+iZn+eivOS9nOitmOWIpe+8jOaIv+mWk+iZn+eivChyb29tSWQp6aCQ5YW254K655eF5Lq66Lqr5YiG6K2J5a2X6JmfXG4gICAqIDAu5qqi5p+l5L2/55So6ICF5piv5ZCm5bey57aT6ZaL5ZWf6KaW6KiK5Y+K6bql5YWL6aKo77yM6Iul5ZCm77yM5YmH6Lez5Ye66K2m5ZGK6KaW56qXXG4gICAqIOeVtuatpOaMiemIleiiq+aMieS4i+W+jO+8jOacg+Wft+ihjOS7peS4i+WLleS9nO+8mlxuICAgKiAxLuWJteW7uuS4gOWAi+WQjeeCunJvb21z55qEY29sbGVjdGlvbu+8jOmAmeWAi2NvbGxlY3Rpb27oo6HmnIPmnInlvojlpJrmiL/plpPvvIzkuI3lkIzmiL/plpPku6XkuI3lkIzmiL/plpPomZ/norwocm9vbUlkKeWNgOWIhlxuICAgKiAyLuWJteW7uuS4gOWAi0NhbGxlclBlZXJDb25uZWN0aW9uXG4gICAqIDMu5pS26ZuGbG9jYWwoY2FsbGVyKeeahCBpY2UgY2FuZGlkYXRlc++8jOWQjOaZguebo+iBvXJlbW90ZShjYWxsZWUpIOeahCBpY2UgY2FuZGlkYXRlcyDvvIwg5Lim5a+r5YWlZmlyZXN0b3Jl5Lit5oyH5a6a55qEc3ViQ29sbGVjdGlvbihjYWxsZXLmiJZjYWxsZWUp5Lit5Lul5Yip6YCy6KGM5Lqk5o+b44CCXG4gICAqIDQu5bCHbG9jYWxTdHJlYW3liqDlhaVDYWxsZXJQZWVyQ29ubmVjdGlvbu+8jOS7peWIqeW+jOe6jOWCs+mAgee1pmNhbGxlZe+8jGNhbGxlZeaOpeaUtuWIsOW+jOWwseWPr+S7pemhr+ekuuWcqHJlbW90ZVZpZGVv5LiKKGRpc3BsYXkgdGhlIGxvY2FsIG1lZGlhIGRhdGEuKVxuICAgKiA1Luioree9rkNhbGxlcuerr+eahFNEUO+8jENhbGxlcuerr+W7uueri29mZmVy77yM5Lim55uj6IG9YW5zd2Vy44CCXG4gICAqL1xuICBhc3luYyBjcmVhdGVSb29tKCkge1xuICAgIC8vIDAu5qqi5p+l5L2/55So6ICF5piv5ZCm5bey57aT6ZaL5ZWf6KaW6KiK5Y+K6bql5YWL6aKo77yM6Iul5ZCm77yM5YmH6Lez5Ye66K2m5ZGK6KaW56qXXG4gICAgaWYgKCF0aGlzLmxvY2FsU3RyZWFtKSB7XG4gICAgICAvLyB0aGlzLnRvYXN0TWVzc2FnZVNlcnZpY2Uud2FybmluZygn6KuL5YWI6ZaL5ZWf6KaW6KiK5Y+K6bql5YWL6aKoJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gMS7libXlu7rkuIDlgIvlkI3ngrpyb29tc+eahGNvbGxlY3Rpb27vvIzpgJnlgItjb2xsZWN0aW9u6KOh5pyD5pyJ5b6I5aSa5oi/6ZaT77yM5LiN5ZCM5oi/6ZaT5Lul5LiN5ZCM5oi/6ZaT6Jmf56K8KHJvb21JZCnljYDliIZcbiAgICB0aGlzLmZpcmVCYXNlU2VydmljZS5hZGRDb2xsZWN0aW9uKCdyb29tcycpO1xuXG4gICAgLy8gMi7libXlu7rkuIDlgItDYWxsZXJQZWVyQ29ubmVjdGlvblxuICAgIHRoaXMuQ2FsbGVyUGVlckNvbm5lY3Rpb24gPSB0aGlzLnBlZXJDb25uZWN0aW9uU2VydmljZS5nZW5Db25uZWN0aW9uKCk7XG5cbiAgICAvLyAzLuaUtumbhmxvY2FsKGNhbGxlcinvvIzkuKbnm6Pogb1yZW1vdGUoY2FsbGVlKSDnmoQgaWNlIGNhbmRpZGF0ZXMg77yMIOS4puWvq+WFpWZpcmVzdG9yZeS4reaMh+WumueahHN1YkNvbGxlY3Rpb24oY2FsbGVy5oiWY2FsbGVlKeS4reS7peWIqemAsuihjOS6pOaPm+OAglxuICAgIHRoaXMuaWNlQ2FuZGlkYXRlU2VydmljZS5jb2xsZWN0SWNlQ2FuZGlkYXRlcyh0aGlzLnJvb21JZCwgdGhpcy5DYWxsZXJQZWVyQ29ubmVjdGlvbiwgJ2NhbGxlckNhbmRpZGF0ZXMnLCAnY2FsbGVlQ2FuZGlkYXRlcycpO1xuXG4gICAgY29uc29sZS5sb2codGhpcy5yb29tSWQpO1xuXG4gICAgLy8gNC7lnKjlu7rnq4tSVENQZWVyQ29ubmVjdGlvbueJqeS7tuW+jO+8jOWwh2xvY2FsU3RyZWFt5Yqg5YWlQ2FsbGVyUGVlckNvbm5lY3Rpb27vvIzku6XliKnlvoznuozlgrPpgIHntaZjYWxsZWXvvIxjYWxsZWXmjqXmlLbliLDlvozlsLHlj6/ku6Xpoa/npLrlnKhyZW1vdGVWaWRlb+S4iihkaXNwbGF5IHRoZSBsb2NhbCBtZWRpYSBkYXRhLilcbiAgICB0aGlzLmFkZExvY2FsTWVkaWFUcmFja3ModGhpcy5DYWxsZXJQZWVyQ29ubmVjdGlvbik7XG5cbiAgICAvLyA1Luioree9rkNhbGxlcuerr+eahFNEUO+8jENhbGxlcuerr+W7uueri29mZmVy77yM5Lim55uj6IG9YW5zd2Vy44CCXG4gICAgdGhpcy5wZWVyQ29ubmVjdGlvblNlcnZpY2Uuc2V0TG9jYWxQZWVyKHRoaXMuQ2FsbGVyUGVlckNvbm5lY3Rpb24sIHRoaXMucm9vbUlkLCB0aGlzLnJlbW90ZVN0cmVhbSk7XG5cbiAgfVxuXG4gIC8qKiDmjInkuIvjgIzliqDlhaXoppboqIrjgI3mjInpiJXlvozvvIzmnIPln7fooYzku6XkuIvli5XkvZzvvJpcbiAgICogMC7mqqLmn6Xkvb/nlKjogIXmmK/lkKblt7LntpPplovllZ/oppboqIrlj4rpuqXlhYvpoqjvvIzoi6XlkKbvvIzliYfot7Plh7rorablkYroppbnqpdcbiAgICog55W25q2k5oyJ6YiV6KKr5oyJ5LiL5b6M77yM5pyD5Z+36KGM5Lul5LiL5YuV5L2c77yaXG4gICAqIDEu5b2I5Ye644CM5Yqg5YWl6KaW6KiK44CN5bCN6Kmx5qGGKOiuk3VzZXLlj6/ku6XovLjlhaXmjIflrprnmoTmiL/plpPomZ/norzvvIzmjInkuIvjgIznorroqo3jgI3mjInpiJXvvIzlsLHlj6/ku6XliqDlhaXmjIflrprnmoTmiL/plpPjgIIpXG4gICAqIEB0b2RvIHNob3dEaWFsb2coKSDpoa/npLrjgIzliqDlhaXoppboqIrjgI3lsI3oqbHmoYbvvIzorpN1c2Vy5Y+v5Lul6Ly45YWl5oyH5a6a55qE5oi/6ZaT6Jmf56K877yM5oyJ5LiL44CM56K66KqN44CN5oyJ6YiV77yM5bCx5Y+v5Lul5Yqg5YWl5oyH5a6a55qE5oi/6ZaT44CCXG4gICAqL1xuICBqb2luUm9vbSgpIHtcbiAgICAvLyAwLuaqouafpeS9v+eUqOiAheaYr+WQpuW3sue2k+mWi+WVn+imluioiuWPium6peWFi+miqO+8jOiLpeWQpu+8jOWJh+i3s+WHuuitpuWRiuimlueql1xuICAgIGlmICghdGhpcy5sb2NhbFN0cmVhbSkge1xuICAgICAgLy8gdGhpcy50b2FzdE1lc3NhZ2VTZXJ2aWNlLndhcm5pbmcoJ+iri+WFiOmWi+WVn+imluioiuWPium6peWFi+miqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIDEuIOW9iOWHuuOAjOWKoOWFpeimluioiuOAjeWwjeipseahhijorpN1c2Vy5Y+v5Lul6Ly45YWl5oyH5a6a55qE5oi/6ZaT6Jmf56K877yM5oyJ5LiL44CM56K66KqN44CN5oyJ6YiV77yM5bCx5Y+v5Lul5Yqg5YWl5oyH5a6a55qE5oi/6ZaT44CCKVxuICAgIHRoaXMuc2hvd0RpYWxvZygpO1xuICB9XG5cbiAgLyoqIOW9iOWHuuOAjOWKoOWFpeimluioiuOAjeWwjeipseahhuW+jO+8jHVzZXLlj6/ku6XovLjlhaXmiL/plpPomZ/norwo55eF5Lq66Lqr5YiG6K2J5a2X6JmfKe+8jOaMieS4i+OAjOeiuuiqjeOAjeaMiemIle+8jOWwseWPr+S7peWKoOWFpeaMh+WumueahOaIv+mWk+OAglxuICAgKiDpgI/pgY7miL/plpPomZ/norwo55eF5Lq66Lqr5YiG6K2J5a2X6JmfKeWKoOWFpeaIv+mWk1xuICAgKiDkvb/nlKjogIXlj6/ku6XpgI/pgY7ovLjlhaXmjIflrprnmoTmiL/plpPomZ/norwo55eF5Lq66Lqr5YiG6K2J5a2X6JmfKeS+huWKoOWFpeaIv+mWk1xuICAgKiBAcGFyYW0gcm9vbUlkIOaIv+mWk+iZn+eivCjnl4XkurrouqvliIborYnlrZfomZ8pXG4gICAqIEB0b2RvIGpvaW5Sb29tQnlJZCgp6YCP6YGO5oi/6ZaT6Jmf56K8KOeXheS6uui6q+WIhuitieWtl+iZnynliqDlhaXmiL/plpNcbiAgICovXG4gIGFzeW5jIGNvbmZpcm1Kb2luUm9vbSgpIHtcblxuICAgIHRoaXMuaW5wdXRSb29tSWQgPSB0aGlzLnJvb21JZDsgLy/oqJjlvpfliKrmjolcblxuICAgIHRoaXMuam9pblJvb21CeUlkKHRoaXMuaW5wdXRSb29tSWQpO1xuICAgIHRoaXMuaGlkZURpYWxvZygpO1xuICB9XG5cbiAgLyoqIOagueaTmnVzZXLmiYDovLjlhaXnmoRyb29tSWTkvobliqDlhaXmjIflrproppboqIrmiL/plpNcbiAgICogMS4g5Y+W5b6XdXNlcui8uOWFpeeahOaIv+mWk+iZn+eivChyb29tSWQp55qE5oi/6ZaT55qERG9jdW1lbnRSZWZlcmVuY2VcbiAgICogMi4g542y5Y+WIHJvb21Eb2NSZWYg55qEIHNuYXBzaG9077yM5Lim5Yik5pa35L2/55So6ICF5omA6Ly45YWl55qE5oi/6ZaTKOiZn+eivCnmmK/lkKblrZjlnKjvvIzlpoLmnpzkuI3lrZjlnKjvvIzliYfot7Plh7rorablkYroppbnqpdcbiAgICog5aaC5p6c5a2Y5Zyo77yM5YmH5Z+36KGM5Lul5LiL5YuV5L2c77yaXG4gICAqIDEuIOWJteW7uuS4gOWAi0NhbGxlZVBlZXJDb25uZWN0aW9uXG4gICAqIDIuIOaUtumbhmxvY2FsKGNhbGxlZSnvvIzkuKbnm6Pogb1yZW1vdGUoY2FsbGVyKSDnmoQgaWNlIGNhbmRpZGF0ZXMg77yMIOS4puWvq+WFpWZpcmVzdG9yZeS4reaMh+WumueahCBzdWJDb2xsZWN0aW9uKGNhbGxlcuaIlmNhbGxlZSnkuK3ku6XliKnpgLLooYzkuqTmj5vjgIJcbiAgICogMy4g5bCHbG9jYWxTdHJlYW3liqDlhaVDYWxsZWVQZWVyQ29ubmVjdGlvbu+8jOS7peWIqeW+jOe6jOWCs+mAgee1pmNhbGxlcu+8jGNhbGxlcuaOpeaUtuWIsOW+jOWwseWPr+S7pemhr+ekuuWcqHJlbW90ZVZpZGVv5LiKKGRpc3BsYXkgdGhlIGxvY2FsIG1lZGlhIGRhdGEuKVxuICAgKiA0LiDoqK3nva5DYWxsZWXnq6/nmoRTRFDvvIxDYWxsZWXnq68g5Y+W5b6Xb2ZmZXLkuKboqK3nva5SZW1vdGVEZXNjcmlwdGlvbiDvvIznhLblvozlu7rnq4thbnN3ZXLvvIwg5bCHYW5zd2Vy6Kit572u5oiQTG9jYWxEZXNjcmlwdGlvbu+8jOS4puWwh+atpCBhbnN3ZXIg5a+r5Yiw5oyH5a6a55qEcm9vbURvY+S7peWIqSBDYWxsZXIg56uv5Y+W5b6XXG4gICAqIEBwYXJhbSBpbnB1dFJvb21JZCDmiL/plpPomZ/norwo55eF5Lq66Lqr5YiG6K2J5a2X6JmfKVxuICAgKi9cbiAgYXN5bmMgam9pblJvb21CeUlkKGlucHV0Um9vbUlkOiBzdHJpbmcpIHtcbiAgICAvLyAxLuWPluW+l3VzZXLovLjlhaXnmoTmiL/plpPomZ/norwocm9vbUlkKeeahOaIv+mWk+eahERvY3VtZW50UmVmZXJlbmNlXG4gICAgY29uc3Qgcm9vbURvY1JlZjogRG9jdW1lbnRSZWZlcmVuY2U8dW5rbm93bj4gPVxuICAgICAgdGhpcy5maXJlQmFzZVNlcnZpY2UuZ2V0RG9jUmVmKCdyb29tcycsIGAke2lucHV0Um9vbUlkfWApO1xuXG4gICAgLy8gMi4g542y5Y+WIHJvb21Eb2NSZWYg55qEIHNuYXBzaG9077yM5Lim5Yik5pa35L2/55So6ICF5omA6Ly45YWl55qE5oi/6ZaTKOiZn+eivCnmmK/lkKblrZjlnKjvvIzlpoLmnpzkuI3lrZjlnKjvvIzliYfot7Plh7rorablkYroppbnqpdcbiAgICBjb25zdCByb29tU25hcHNob3Q6IGFueSA9IGF3YWl0IHRoaXMuZmlyZUJhc2VTZXJ2aWNlLmdldFNuYXBzaG90KHJvb21Eb2NSZWYpO1xuXG4gICAgaWYgKCFyb29tU25hcHNob3QuZXhpc3RzKSB7XG4gICAgICAvLyB0aGlzLnRvYXN0TWVzc2FnZVNlcnZpY2UuZXJyb3IoJ+aIv+mWk+S4jeWtmOWcqCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIOWmguaenOWtmOWcqO+8jOWJh+Wft+ihjOS7peS4i+WLleS9nO+8mlxuICAgIGVsc2Uge1xuICAgICAgLy8gMS4g5Ym15bu65LiA5YCLQ2FsbGVlUGVlckNvbm5lY3Rpb25cbiAgICAgIHRoaXMuQ2FsbGVlUGVlckNvbm5lY3Rpb24gPSB0aGlzLnBlZXJDb25uZWN0aW9uU2VydmljZS5nZW5Db25uZWN0aW9uKCk7XG5cbiAgICAgIC8vIDIuIOaUtumbhmxvY2FsKGNhbGxlZSnvvIzkuKbnm6Pogb1yZW1vdGUoY2FsbGVyKSDnmoQgaWNlIGNhbmRpZGF0ZXMg77yMIOS4puWvq+WFpWZpcmVzdG9yZeS4reaMh+WumueahHN1YkNvbGxlY3Rpb24oY2FsbGVy5oiWY2FsbGVlKeS4reS7peWIqemAsuihjOS6pOaPm+OAglxuICAgICAgdGhpcy5pY2VDYW5kaWRhdGVTZXJ2aWNlLmNvbGxlY3RJY2VDYW5kaWRhdGVzKGlucHV0Um9vbUlkLCB0aGlzLkNhbGxlZVBlZXJDb25uZWN0aW9uLCAnY2FsbGVlQ2FuZGlkYXRlcycsICdjYWxsZXJDYW5kaWRhdGVzJyk7XG5cbiAgICAgIC8vIDMu5Zyo5bu656uLUlRDUGVlckNvbm5lY3Rpb27nianku7blvozkuKblsIdsb2NhbFN0cmVhbeWKoOWFpUNhbGxlZVBlZXJDb25uZWN0aW9u77yM5Lul5Yip5b6M57qM5YKz6YCB57WmY2FsbGVy77yMY2FsbGVy5o6l5pS25Yiw5b6M5bCx5Y+v5Lul6aGv56S65ZyocmVtb3RlVmlkZW/kuIooZGlzcGxheSB0aGUgbG9jYWwgbWVkaWEgZGF0YS4pXG4gICAgICB0aGlzLmFkZExvY2FsTWVkaWFUcmFja3ModGhpcy5DYWxsZWVQZWVyQ29ubmVjdGlvbik7XG5cbiAgICAgIC8vIDQuIOioree9rkNhbGxlZeerr+eahFNEUO+8jENhbGxlZeerryDliLBmaXJlU3RvcmXkuK3mi7/lj5Ygb2ZmZXIo55SxY2FsbGVy5omA5bu656uL55qEKeW+jO+8jOW7uueri2Fuc3dlcu+8jOS4puWwh+atpCBhbnN3ZXIg5a+r5Yiw5oyH5a6a55qEcm9vbURvY+S7peWIqSBDYWxsZXIg56uv5Y+W5b6XXG4gICAgICB0aGlzLnBlZXJDb25uZWN0aW9uU2VydmljZS5zZXRSZW1vdGVQZWVyKHRoaXMuQ2FsbGVlUGVlckNvbm5lY3Rpb24sIGlucHV0Um9vbUlkLCB0aGlzLnJlbW90ZVN0cmVhbSk7XG5cbiAgICB9XG4gIH1cblxuICAvKiog6ZaL5ZWf6KaW6KiKXG4gICAqL1xuICBhc3luYyBvcGVuVXNlck1lZGlhKCkge1xuICAgIGNvbnN0IHN0cmVhbSA9IGF3YWl0IHRoaXMubWVkaWFTZXJ2aWNlLmdldFVzZXJNZWRpYSgpO1xuXG4gICAgdGhpcy5sb2NhbFN0cmVhbSA9IHN0cmVhbTtcbiAgICB0aGlzLnJlbW90ZVN0cmVhbSA9IG5ldyBNZWRpYVN0cmVhbSgpO1xuXG4gICAgdGhpcy5jcmVhdGVSb29tKCk7XG4gIH1cblxuICAvKiog5o6b5pa36KaW6KiK6YCa6KmxXG4gICAqIOmXnOmWieimluioiuWSjOmfs+ioiu+8jOS4pumXnOmWiemAo+e3mumbmeaWueeahHBlZXJDb25uZWN0aW9u44CCXG4gICAqIOmXnOmWieimluioiumAmuipseW+jO+8jOWwh+acg+WIqumZpGZpcmVTdG9yZeS4reeahOaIv+mWk+aWh+S7tlxuICAgKi9cbiAgYXN5bmMgaGFuZ1VwKCkge1xuICAgIC8vIOWBnOatouacrOWcsOa1geWSjOmBoOerr+a1geS4reeahOaJgOacieWqkumrlOi7jOmBk1xuICAgIGF3YWl0IHRoaXMuc3RvcE1lZGlhVHJhY2tzKCk7XG5cbiAgICAvLyDpl5zplokgUlRDUGVlckNvbm5lY3Rpb25cbiAgICB0aGlzLnJlbW92ZVBlZXJDb25uZWN0aW9ucygpO1xuXG4gICAgLy8gdGhpcy50b2FzdE1lc3NhZ2VTZXJ2aWNlLmluZm8oJ+mAmuipseW3sue1kOadnycpO1xuXG4gICAgLy8g5Yiq6ZmkIGNhbGxlZUNhbmRpZGF0ZXMg6ZuG5ZCI5Lit55qE5paH5Lu2XG4gICAgYXdhaXQgdGhpcy5leGVjdXRlRmlyZWJhc2VDbGVhbnVwKCk7XG5cbiAgICAvLyDph43nva7nlavpnaLlhYPku7ZcbiAgICB0aGlzLmluaXRFbGVtZW50cygpO1xuXG4gICAgLy8g5Yi35paw6aCB6Z2iXG4gICAgdGhpcy5yZWxvYWRQYWdlKCk7XG4gIH1cblxuICAvKiog6aGv56S644CM5Yqg5YWl6KaW6KiK44CN5bCN6Kmx5qGGXG4gICAqL1xuICBzaG93RGlhbG9nKCk6IHZvaWQge1xuICAgIHRoaXMuc2hvdy5pc0RpYWxvZyA9IHRydWU7XG4gIH1cblxuICAvKiog6Zec6ZaJ44CM5Yqg5YWl6KaW6KiK44CN5bCN6Kmx5qGGXG4gICAqL1xuICBoaWRlRGlhbG9nKCk6IHZvaWQge1xuICAgIHRoaXMuc2hvdy5pc0RpYWxvZyA9IGZhbHNlO1xuICB9XG5cbiAgLyoqIOWBnOatoiBsb2NhbFN0cmVhbSDlkowgcmVtb3RlU3RyZWFtIOS4reeahOaJgOacieWqkumrlOi7jOmBk1xuICAgKi9cbiAgYXN5bmMgc3RvcE1lZGlhVHJhY2tzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMubG9jYWxTdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2spID0+IHtcbiAgICAgIHRyYWNrLnN0b3AoKTtcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLnJlbW90ZVN0cmVhbSkge1xuICAgICAgdGhpcy5yZW1vdGVTdHJlYW0uZ2V0VHJhY2tzKCkuZm9yRWFjaCgodHJhY2spID0+IHRyYWNrLnN0b3AoKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIOmXnOmWiemAo+e3mumbmeaWuShjYWxsZXIg6LefIGNhbGxlZSnnmoRwZWVyQ29ubmVjdGlvblxuICAgKi9cbiAgcmVtb3ZlUGVlckNvbm5lY3Rpb25zKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLkNhbGxlclBlZXJDb25uZWN0aW9uKSB7XG4gICAgICB0aGlzLkNhbGxlclBlZXJDb25uZWN0aW9uLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuQ2FsbGVlUGVlckNvbm5lY3Rpb24pIHtcbiAgICAgIHRoaXMuQ2FsbGVlUGVlckNvbm5lY3Rpb24uY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICAvKiog5riF6ZmkZmlyZXN0b3Jl5Lit55qE5oi/6ZaT5paH5Lu2XG4gICAqL1xuICBhc3luYyBleGVjdXRlRmlyZWJhc2VDbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLnJvb21JZCkge1xuICAgICAgY29uc3Qgcm9vbURvY1JlZiA9IHRoaXMuZmlyZUJhc2VTZXJ2aWNlLmdldERvY1JlZigncm9vbXMnLCB0aGlzLnJvb21JZCk7XG5cbiAgICAgIGNvbnN0IGNhbGxlZUNhbmRpZGF0ZXNSZWYgPSB0aGlzLmZpcmVCYXNlU2VydmljZS5nZXRTdWJDb2xsZWN0aW9uUmVmKHJvb21Eb2NSZWYsICdjYWxsZWVDYW5kaWRhdGVzJyk7XG4gICAgICBjYWxsZWVDYW5kaWRhdGVzUmVmLm9uU25hcHNob3QoKHNuYXBzaG90OiBhbnkpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coc25hcHNob3QpO1xuXG4gICAgICAgIHNuYXBzaG90LnJlZi5kZWxldGUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjYWxsZXJDYW5kaWRhdGVzUmVmID0gdGhpcy5maXJlQmFzZVNlcnZpY2UuZ2V0U3ViQ29sbGVjdGlvblJlZihyb29tRG9jUmVmLCAnY2FsbGVyQ2FuZGlkYXRlcycpO1xuICAgICAgY2FsbGVyQ2FuZGlkYXRlc1JlZi5vblNuYXBzaG90KChzbmFwc2hvdDogYW55KSA9PiB7XG4gICAgICAgIHNuYXBzaG90LnJlZi5kZWxldGUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCByb29tRG9jUmVmLmRlbGV0ZSgpO1xuICAgIH1cbiAgfVxuICAvKiog6YeN5paw6LyJ5YWl6aCB6Z2iXG4gICAqL1xuICByZWxvYWRQYWdlKCk6IHZvaWQge1xuICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpO1xuICB9XG5cbiAgLyoqIOWIneWni+WMlumggemdouWFg+S7tu+8jOWMheWQq2xvY2FsU3RyZWFt44CBcmVtb3RlU3RyZWFt44CBcm9vbU5hbWVcbiAgICog5bCH6aCB6Z2i5Yid5aeL5YyW77yM5YyF5ZCrbG9jYWxTdHJlYW3jgIFyZW1vdGVTdHJlYW3jgIFyb29tTmFtZVxuICAgKi9cbiAgaW5pdEVsZW1lbnRzKCkge1xuICAgIHRoaXMubG9jYWxTdHJlYW0gPSBuZXcgTWVkaWFTdHJlYW0oKTtcblxuICAgIHRoaXMucmVtb3RlU3RyZWFtID0gbmV3IE1lZGlhU3RyZWFtKCk7XG4gIH1cblxuICAvKiog5Zyo5bu656uLUlRDUGVlckNvbm5lY3Rpb27nianku7blvozvvIzlsIdsb2NhbFN0cmVhbeWKoOWFpVBlZXJDb25uZWN0aW9u77yM5Lul5Yip5b6M57qM5YKz6YCB57Wm5Y+m5LiA56uv77yM5Y+m5LiA56uv5o6l5pS25Yiw5b6M5bCx5Y+v5Lul6aGv56S65ZyocmVtb3RlVmlkZW/kuIooZGlzcGxheSB0aGUgbG9jYWwgbWVkaWEgZGF0YS4pXG4gICAqIOWcqGxvY2FsU3RyZWFt5bu656uL5a6M5b6MKOS5n+WwseaYr29wZW5Vc2VyTWVkaWEoKeWft+ihjOWujOW+jCnvvIzmiY3og73ln7fooYzkuIvpnaLpgJnooYzjgILkvb/nlKggZ2V0VHJhY2tzKCkg5pa55rOV542y5Y+W5omA5pyJbWVkaWFUcmFja+i7jOmBk++8jOS4puWwh+mAmeS6m21lZGlhVHJhY2vou4zpgZPmt7vliqDliLAgUlRDUGVlckNvbm5lY3Rpb24g5Lit44CCXG4gICAqIGdldFRyYWNrcyDnjbLlj5blqpLpq5TmtYHmiYDmnInou4zpgZPkuKbov5Tlm54gYXJyYXlcbiAgICogYWRkVHJhY2tzIOWwh+aWsOeahOmfs+ioiuaIluimluioiui7jOmBk+a3u+WKoOWIsOePvuacieeahOWqkumrlOa1geS4rVxuICAgKiBAcGFyYW0gUGVlckNvbm5lY3Rpb27vvJpSVENQZWVyQ29ubmVjdGlvblxuICAgKi9cbiAgYWRkTG9jYWxNZWRpYVRyYWNrcyhQZWVyQ29ubmVjdGlvbjogUlRDUGVlckNvbm5lY3Rpb24pOiB2b2lkIHtcbiAgICB0aGlzLmxvY2FsU3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2goKHRyYWNrKSA9PiB7XG5cbiAgICAgIFBlZXJDb25uZWN0aW9uLmFkZFRyYWNrKHRyYWNrLCB0aGlzLmxvY2FsU3RyZWFtKTtcblxuICAgIH0pO1xuICB9XG5cbn1cbiIsIjwhLS0gZXNsaW50LWRpc2FibGUgQGFuZ3VsYXItZXNsaW50L3RlbXBsYXRlL2FsdC10ZXh0IC0tPlxuPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICA8ZGl2IGNsYXNzPVwidG9wXCI+XG4gICAgPGRpdiBjbGFzcz1cImxlZnRTaWRlXCI+XG4gICAgICA8ZGl2ICpuZ0lmPVwiIXJlbW90ZVN0cmVhbVwiIGNsYXNzPVwibWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCBjb250YWN0c0ljb25cIj5cbiAgICAgICAge3tjb250YWN0c0ljb259fVxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2ICpuZ0lmPVwiIXJlbW90ZVN0cmVhbVwiIGNsYXNzPVwibG9hZGluZ1wiPlxuICAgICAgICA8c3Bhbj7pgKPnt5rkuK08L3NwYW4+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZG90LTFcIj4uPC9zcGFuPlxuICAgICAgICA8c3BhbiBjbGFzcz1cImRvdC0yXCI+Ljwvc3Bhbj5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJkb3QtM1wiPi48L3NwYW4+XG4gICAgICA8L2Rpdj5cbiAgICAgIDx2aWRlbyAqbmdJZj1cInJlbW90ZVN0cmVhbVwiIGNsYXNzPVwicmVtb3RlVmlkZW9cIiAjcmVtb3RlVmlkZW8gaWQ9XCJyZW1vdGVWaWRlb1wiIFtzcmNPYmplY3RdPVwicmVtb3RlU3RyZWFtXCIgYXV0b3BsYXlcbiAgICAgICAgcGxheXNpbmxpbmU+PC92aWRlbz5cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJyaWdodFNpZGVcIj5cblxuICAgICAgPGRpdiBjbGFzcz1cImxvY2FsVmlkZW9cIj5cbiAgICAgICAgPHZpZGVvICNsb2NhbFZpZGVvIGlkPVwibG9jYWxWaWRlb1wiIFtzcmNPYmplY3RdPVwibG9jYWxTdHJlYW1cIiBtdXRlZCBhdXRvcGxheSBwbGF5c2lubGluZT48L3ZpZGVvPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3M9XCJnYWxsZXJpYVwiPlxuICAgICAgICA8cC1nYWxsZXJpYSBbdmFsdWVdPVwidGhpcy5zY3JlZW5zaG90U2VydmljZS5pbWFnZVVybFN1YmplY3QudmFsdWVcIlxuICAgICAgICAgIFtyZXNwb25zaXZlT3B0aW9uc109XCJnYWxsZXJpYVJlc3BvbnNpdmVPcHRpb25zXCIgW2NvbnRhaW5lclN0eWxlXT1cInsgJ21hcmdpbic6J2F1dG8nfVwiIFtudW1WaXNpYmxlXT1cIjNcIlxuICAgICAgICAgIFtjaXJjdWxhcl09XCJ0cnVlXCI+XG5cbiAgICAgICAgICA8bmctdGVtcGxhdGUgcFRlbXBsYXRlPVwiaXRlbVwiIGxldC1pbWFnZVBhdGg+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaW1hZ2VQYXRoICE9PSAnJzsgZWxzZSBlbXB0eUl0ZW1cIj5cbiAgICAgICAgICAgICAgPGltZyBjbGFzcz1cIml0ZW1cIiAqbmdJZj1cImltYWdlUGF0aCAhPT0gJydcIiBbc3JjXT1cImltYWdlUGF0aFwiIHN0eWxlPVwiZGlzcGxheTogYmxvY2s7XCIgLz5cbiAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgICA8bmctdGVtcGxhdGUgI2VtcHR5SXRlbT5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImVtcHR5LWdhbGxlcmlhLWl0ZW1cIj5cbiAgICAgICAgICAgICAgICA8aSBjbGFzcz1cInBpIHBpLWltYWdlXCI+PC9pPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cblxuICAgICAgICAgIDxuZy10ZW1wbGF0ZSBwVGVtcGxhdGU9XCJ0aHVtYm5haWxcIiBsZXQtaW1hZ2VQYXRoPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImdyaWQganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImltYWdlUGF0aCAhPT0gJyc7IGVsc2UgZW1wdHlUaHVtYm5haWxcIj5cbiAgICAgICAgICAgICAgICA8aW1nIGNsYXNzPVwidGh1bWJuYWlsXCIgKm5nSWY9XCJpbWFnZVBhdGggIT09ICcnXCIgW3NyY109XCJpbWFnZVBhdGhcIiBzdHlsZT1cImRpc3BsYXk6IGJsb2NrO1wiIC8+XG4gICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgI2VtcHR5VGh1bWJuYWlsPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJlbXB0eS1nYWxsZXJpYS10aHVtYm5haWxcIj5cbiAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwicGkgcGktaW1hZ2VcIj48L2k+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuXG4gICAgICAgIDwvcC1nYWxsZXJpYT5cblxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG5cbiAgPC9kaXY+XG4gIDxkaXYgY2xhc3M9XCJidXR0b25zXCI+XG4gICAgPGJ1dHRvbiBwQnV0dG9uIHBSaXBwbGUgY2xhc3M9XCJjYW1lcmFCdG5cIiBpZD1cImNhbWVyYUJ0blwiIChjbGljayk9XCIgZGlzYWJsZUNhbWVyYSgpXCI+XG4gICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5cbiAgICAgICAge3t2aWRlb0ljb259fVxuICAgICAgPC9zcGFuPlxuICAgIDwvYnV0dG9uPlxuXG4gICAgPGJ1dHRvbiBwQnV0dG9uIHBSaXBwbGUgY2xhc3M9XCJtaWNCdG5cIiBpZD1cIm1pY0J0blwiIChjbGljayk9XCIgZGlzYWJsZU1pYygpXCI+XG4gICAgICA8c3BhbiBjbGFzcz1cIm1hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWRcIj5cbiAgICAgICAge3ttaWNJY29ufX1cbiAgICAgIDwvc3Bhbj5cbiAgICA8L2J1dHRvbj5cblxuICAgIDxidXR0b24gcEJ1dHRvbiBwUmlwcGxlIGNsYXNzPVwiam9pbkJ0blwiIGlkPVwiam9pbkJ0blwiIChjbGljayk9XCJvblNob290Q2xpY2soKVwiPlxuICAgICAgPHNwYW4gY2xhc3M9XCJtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkXCI+XG4gICAgICAgIHBob3RvX2NhbWVyYVxuICAgICAgPC9zcGFuPlxuICAgIDwvYnV0dG9uPlxuXG4gIDwvZGl2PlxuXG4gIDxkaXYgY2xhc3M9XCJib3R0b21cIj5cbiAgICA8ZGl2IGNsYXNzPVwiaGFuZ3VwQnRuXCI+XG5cbiAgICAgIDwhLS0g5o6l5pS256uv55SoIC0tPlxuICAgICAgPCEtLSA8YnV0dG9uIGNsYXNzPVwiam9pbkJ0blwiIGlkPVwiam9pbkJ0blwiIFtkaXNhYmxlZF09XCJzaG93LmlzSm9pbkRpc2FibGVkXCIgKGNsaWNrKT1cImpvaW5Sb29tKClcIj5cbiAgICAgICAgPGkgY2xhc3M9XCJwaSBwaS11c2VyLXBsdXNcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICA8L2J1dHRvbj4gLS0+XG5cblxuICAgICAgPGJ1dHRvbiBwQnV0dG9uIHBSaXBwbGUgaWQ9XCJoYW5ndXBCdG5cIiBjbGFzcz1cInAtYnV0dG9uLXJhaXNlZCBwLWJ1dHRvbi13YXJuaW5nXCIgbGFiZWw9XCLntZDmnZ/pgJroqbFcIlxuICAgICAgICBbZGlzYWJsZWRdPVwic2hvdy5pc0hhbmd1cERpc2FibGVkXCIgKGNsaWNrKT1cImhhbmdVcCgpXCI+XG4gICAgICA8L2J1dHRvbj5cblxuICAgIDwvZGl2PlxuXG4gICAgPCEtLSDmjqXmlLbnq6/nlKggLS0+XG4gICAgPCEtLSA8cC1kaWFsb2cgaGVhZGVyPVwiSm9pbiByb29tXCIgWyh2aXNpYmxlKV09XCJzaG93LmlzRGlhbG9nXCIgW21vZGFsXT1cInRydWVcIiBbcmVzcG9uc2l2ZV09XCJ0cnVlXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwicC1mbHVpZFwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwicC1maWVsZFwiPlxuICAgICAgICAgIDxsYWJlbCBmb3I9XCJyb29tLWlkXCI+Um9vbSBJRDwvbGFiZWw+XG4gICAgICAgICAgPGlucHV0IGlkPVwicm9vbS1pZFwiIHR5cGU9XCJ0ZXh0XCIgcElucHV0VGV4dCBbKG5nTW9kZWwpXT1cImlucHV0Um9vbUlkXCI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwicC1kaWFsb2ctZm9vdGVyXCI+XG4gICAgICAgIDxwYnV0dG9uIHR5cGU9XCJidXR0b25cIiBwQnV0dG9uIFtsYWJlbF09XCIn5Y+W5raIJyB8IHRyYW5zbGF0ZVwiIChjbGljayk9XCJoaWRlRGlhbG9nKClcIj48L3BidXR0b24+XG4gICAgICAgIDxwYnV0dG9uIHR5cGU9XCJidXR0b25cIiBwQnV0dG9uIFtsYWJlbF09XCIn5Yqg5YWlJyB8IHRyYW5zbGF0ZVwiIChjbGljayk9XCJjb25maXJtSm9pblJvb20oKVwiIGNsYXNzPVwicC1idXR0b24tcHJpbWFyeVwiPlxuICAgICAgICA8L3BidXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L3AtZGlhbG9nPiAtLT5cblxuICA8L2Rpdj5cbjwvZGl2PlxuIl19